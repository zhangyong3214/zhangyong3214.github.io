{"meta":{"title":"æè‹Ÿè›‹ã®å®¶","subtitle":"çƒ­çˆ±ç”Ÿæ´»ï¼Œå–œæ¬¢è½¯ä»¶","description":"æ¬¢è¿æ¥åˆ°è‹Ÿè›‹åšå®¢ã®å®¶","author":"æè‹Ÿè›‹","url":"https://zhangyong3214.github.io","root":"/"},"pages":[{"title":"ç•™è¨€æ¿","date":"2022-01-27T08:31:13.242Z","updated":"2022-01-27T08:31:13.242Z","comments":true,"path":"message/index.html","permalink":"https://zhangyong3214.github.io/message/index.html","excerpt":"","text":"æœ¬é¡µé¢è¿˜åœ¨å¼€å‘ä¸­â€¦â€¦"},{"title":"","date":"2022-01-27T08:31:13.242Z","updated":"2022-01-27T08:31:13.242Z","comments":true,"path":"js/chocolate.js","permalink":"https://zhangyong3214.github.io/js/chocolate.js","excerpt":"","text":"/* * @Author: tzy1997 * @Date: 2020-12-15 20:55:25 * @LastEditors: tzy1997 * @LastEditTime: 2021-01-12 19:02:25 */ // å‹æƒ…é“¾æ¥é¡µé¢ å¤´åƒæ‰¾ä¸åˆ°æ—¶ æ›¿æ¢å›¾ç‰‡ if (location.href.indexOf(\"link\") !== -1) { var imgObj = document.getElementsByTagName(\"img\"); for (i = 0; i < imgObj.length; i++) { imgObj[i].onerror = function() { this.src = \"https://cdn.jsdelivr.net/gh/tzy13755126023/BLOG_SOURCE/theme_f/friend_404.gif\" } } } $(function() { // æ°”æ³¡ function bubble() { $('#page-header').circleMagic({ radius: 10, density: .2, color: 'rgba(255,255,255,.4)', clearOffset: 0.99 }); }! function(p) { p.fn.circleMagic = function(t) { var o, a, n, r, e = !0, i = [], d = p.extend({ color: \"rgba(255,0,0,.5)\", radius: 10, density: .3, clearOffset: .2 }, t), l = this[0]; function c() { e = !(document.body.scrollTop > a) } function s() { o = l.clientWidth, a = l.clientHeight, l.height = a + \"px\", n.width = o, n.height = a } function h() { if (e) for (var t in r.clearRect(0, 0, o, a), i) i[t].draw(); requestAnimationFrame(h) } function f() { var t = this; function e() { t.pos.x = Math.random() * o, t.pos.y = a + 100 * Math.random(), t.alpha = .1 + Math.random() * d.clearOffset, t.scale = .1 + .3 * Math.random(), t.speed = Math.random(), \"random\" === d.color ? t.color = \"rgba(\" + Math.floor(255 * Math.random()) + \", \" + Math.floor(0 * Math.random()) + \", \" + Math.floor(0 * Math.random()) + \", \" + Math.random().toPrecision(2) + \")\" : t.color = d.color } t.pos = {}, e(), this.draw = function() { t.alpha"},{"title":"æ ‡ç­¾","date":"2022-01-27T08:31:13.242Z","updated":"2022-01-27T08:31:13.242Z","comments":true,"path":"tags/index.html","permalink":"https://zhangyong3214.github.io/tags/index.html","excerpt":"","text":""},{"title":"æŠ€æœ¯ç¬”è®°","date":"2022-01-27T08:31:13.243Z","updated":"2022-01-27T08:31:13.243Z","comments":true,"path":"æŠ€æœ¯ç¬”è®°/index.html","permalink":"https://zhangyong3214.github.io/%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/index.html","excerpt":"","text":"æˆ‘æ˜¯æŠ€æœ¯ç¬”è®°"},{"title":"å…³äºæˆ‘","date":"2022-01-27T08:31:13.242Z","updated":"2022-01-27T08:31:13.242Z","comments":true,"path":"å…³äºæˆ‘/index.html","permalink":"https://zhangyong3214.github.io/%E5%85%B3%E4%BA%8E%E6%88%91/index.html","excerpt":"","text":"å…³äºæˆ‘åå¹´ç”Ÿæ­»ä¸¤èŒ«èŒ«,å†™ç¨‹åºï¼Œåˆ°å¤©äº®ã€‚åƒè¡Œä»£ç ï¼ŒBugä½•å¤„è—ã€‚çºµä½¿ä¸Šçº¿åˆæ€æ ·ï¼Œæœä»¤æ”¹ï¼Œå¤•æ–­è‚ ã€‚é¢†å¯¼æ¯å¤©æ–°æƒ³æ³•ï¼Œå¤©å¤©æ”¹ï¼Œæ—¥æ—¥å¿™ã€‚ ç›¸é¡¾æ— è¨€ï¼ŒæƒŸæœ‰æ³ªåƒè¡Œã€‚æ¯æ™šç¯ç«é˜‘çŠå¤„ï¼Œç¨‹åºå‘˜ï¼ŒåˆåŠ ç­ï¼Œå·¥ä½œç‹‚~ æ¥ä¸€å¼ æ¥¼ä¸»æ— ç¾é¢œç”Ÿæ´»ç…§ï¼Œè§ç¬‘äº†ï¼ğŸ¤£ğŸ¤£ğŸ¤£ åŸºæœ¬ä¿¡æ¯ ç±»åˆ« ä¿¡æ¯ å‡ºç”Ÿå¹´æœˆ 1990å¹´2æœˆ ç°å±…åœ° åŒ—äº¬å¸‚æœé˜³åŒº ç±è´¯ è¾½å®çœé”¦å·å¸‚ é‚®ç®± &#x38;&#51;&#x34;&#x36;&#x31;&#51;&#x32;&#64;&#113;&#x71;&#x2e;&#x63;&#111;&#x6d; æ•™è‚²ç»å† æ—¶é—´ å­¦æ ¡ ä¸“ä¸š å¤‡æ³¨ 2009.09~2013.07 æ²ˆé˜³åŒ–å·¥å¤§å­¦ ç”µå­ç§‘å­¦ä¸æŠ€æœ¯ ç»Ÿæ‹›æœ¬ç§‘ 2006.09~2009.07 è¾½å®çœåŒ—é•‡å¸‚é«˜çº§ä¸­å­¦ é«˜çº§åŸºç¡€æ•™è‚² å¸‚é‡ç‚¹ å·¥ä½œç»å† æ—¶é—´ å…¬å¸ èŒä½ 2021.04~è‡³ä»Š é¾™æ¹–é›†å›¢ Java å¼€å‘å·¥ç¨‹å¸ˆ 2017.05~2021.04 åŒ…å¤´å¸‚åŒ…é“¶æ¶ˆè´¹é‡‘èè‚¡ä»½æœ‰é™å…¬å¸ Java å¼€å‘å·¥ç¨‹å¸ˆ 2016.09~2017.04 å¤§è¿çµåŠ¨ç§‘æŠ€å‘å±•æœ‰é™å…¬å¸ Java å¼€å‘å·¥ç¨‹å¸ˆ 2013.07~2016.08 å¤§è¿å®‰å‰å°¼å°”ç§‘æŠ€æœ‰é™å…¬å¸ Java å¼€å‘å·¥ç¨‹å¸ˆ ä¸“ä¸šæŠ€èƒ½ Java åŸºç¡€æ‰å®ã€æŒæ¡ JVM åŸç†ã€å¤šçº¿ç¨‹ã€ç½‘ç»œåŸç†ã€è®¾è®¡æ¨¡å¼ã€å¸¸ç”¨çš„æ•°æ®ç»“æ„å’Œç®—æ³• ç†Ÿæ‚‰ Windowsã€Macã€Linux æ“ä½œç³»ç»Ÿï¼Œç†Ÿç»ƒä½¿ç”¨ linux å¸¸ç”¨æ“ä½œæŒ‡ä»¤ ç†Ÿç»ƒä½¿ç”¨ IntelliJ IDEA å¼€å‘å·¥å…·(åŠå„ç§æ’ä»¶)ã€ç†Ÿç»ƒä½¿ç”¨ Git ç‰ˆæœ¬åŒæ­¥å·¥å…· é˜…è¯»è¿‡ Springã€SpringMVCã€ç­‰å¼€æºæ¡†æ¶æºç ï¼Œç†è§£å…¶è®¾è®¡åŸç†åŠåº•å±‚æ¶æ„ï¼Œå…·å¤‡æ¡†æ¶å®šåˆ¶å¼€å‘èƒ½åŠ› ç†è§£ Redis çº¿ç¨‹æ¨¡å‹ï¼ŒNetty çº¿ç¨‹æ¨¡å‹ï¼ŒæŒæ¡åŸºäºå“åº”å¼çš„å¼‚æ­¥éé˜»å¡æ¨¡å‹çš„åŸºæœ¬åŸç†ï¼Œäº†è§£ Webflux ç†Ÿç»ƒæŒæ¡åˆ†å¸ƒå¼ç¼“å­˜ Redisã€Elaticsearchï¼Œå¯¹åˆ†å¸ƒå¼é”ï¼Œå¹‚ç­‰ç­‰å¸¸è§é—®é¢˜æœ‰æ·±å…¥ç ”ç©¶åŠå¤šå¹´å®æˆ˜ç»éªŒ ç†Ÿæ‚‰å¸¸è§æ¶ˆæ¯ä¸­é—´ä»¶çš„ä½¿ç”¨ï¼Œæœ‰å¤šå¹´ RabbitMQ çš„å®æˆ˜å¼€å‘ç»éªŒï¼Œå¯¹é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—æœ‰æ·±å…¥ç†è§£ ç†Ÿç»ƒæŒæ¡ Mysql äº‹åŠ¡ï¼Œç´¢å¼•ï¼Œé”ï¼ŒSQL ä¼˜åŒ–ç›¸å…³çŸ¥è¯†ï¼Œå¯æ ¹æ®ä¸šåŠ¡åœºæ™¯ç»™å‡ºè¯¦ç»†åŠé«˜æ€§èƒ½è®¾è®¡æ–¹æ¡ˆ ç†Ÿç»ƒä½¿ç”¨æ•°æ®åº“æ“ä½œæ¡†æ¶ Mybatisã€Mybatsi-plus è¿›è¡Œé«˜æ•ˆä¸šåŠ¡åŠŸèƒ½å¼€å‘ æŒæ¡ springCloud ç›¸å…³æ¡†æ¶ï¼Œå¯¹ SpringBootã€SpringCloud åŸç†æœ‰ä¸€å®šäº†è§£ï¼Œæœ‰æˆç†Ÿé¡¹ç›®ç»éªŒ ç†Ÿæ‚‰å®šæ—¶ä»»åŠ¡åŠå»¶è¿Ÿä»»åŠ¡ç­‰ä¸šåŠ¡ç›¸å…³è®¾è®¡ï¼Œå¦‚ xxl-jobï¼Œå»¶è¿Ÿæ¶ˆæ¯ç­‰ç›¸å…³æŠ€æœ¯æœ‰å¤šå¹´å¼€å‘ç»éªŒ ç†Ÿæ‚‰å¾®æœåŠ¡æ€æƒ³ï¼ŒMVC åˆ†å±‚ï¼ŒDDD ç†è®ºï¼ŒæœåŠ¡æ‹†åˆ†ï¼Œæ²»ç†ï¼Œç›‘æ§ï¼ŒæœåŠ¡ç†”æ–­ï¼Œé™çº§ç­‰ç›¸å…³èƒ½åŠ› ç†Ÿæ‚‰ jvm åŸç†ï¼Œç†Ÿæ‚‰åƒåœ¾å›æ”¶ä»¥ jvm æ€§èƒ½è°ƒä¼˜æŠ€æœ¯ï¼Œæœ‰è¿‡çº¿ä¸ŠæœåŠ¡å™¨æ€§èƒ½ç›‘æµ‹åŠè°ƒä¼˜ç»éªŒ ç†Ÿæ‚‰å¤šçº¿ç¨‹åŠçº¿ç¨‹æ± ä½¿ç”¨ï¼Œæœ‰å¤šå¹´å¤šçº¿ç¨‹ä¸šåŠ¡å¤„ç†ç»éªŒï¼Œå°è£…è¿‡å¤šçº¿ç¨‹æ‰¹å¤„ç†å·¥å…·ç±»ç­‰å…¬ç”¨ç»„å»º äº†è§£ Mysql åˆ†åº“åˆ†è¡¨ç›¸å…³åŸç†ï¼Œå¦‚ Sardingsphereã€Mycat ç­‰æ¡†æ¶æœ‰ç›¸å…³ä½¿ç”¨ç»éªŒ äº†è§£æ“ä½œç³»ç»Ÿåº•å±‚åŸç†ä»¥åŠ Cã€C++ç¨‹åºå¼€å‘ï¼Œå¯¹è®¡ç®—æœºåº•å±‚åŸç†æœ‰åˆæ­¥äº†è§£ äº†è§£å‰ç«¯å¼€å‘ï¼Œäº†è§£ htmlï¼Œcssï¼Œjsï¼Œvue ç­‰å‰ç«¯æŠ€æœ¯ï¼Œå¯¹å‰ç«¯å¼€å‘æœ‰ä¸€å®šçš„äº†è§£ ç ”ç©¶è¿‡å•ç‰‡æœºç­‰ç¡¬ä»¶å¼€å‘ï¼Œå–œæ¬¢ç§‘æŠ€äº§å“ï¼Œå–œæ¬¢è½¯ä»¶ï¼Œå–œæ¬¢æŠ˜è…¾å„ç§ç”µå­äº§å“ä»¥åŠè½¯ä»¶ é¡¹ç›®ç»éªŒâ€‹ é¡¹ç›®ç»éªŒåªå†™äº†åœ¨åŒ—äº¬ä¹‹åå‚ä¸è¿‡çš„ç›¸å…³é¡¹ç›®ï¼Œåœ¨å¤§è¿åšçš„é¡¹ç›®åå‘äºä¼ ç»Ÿï¼Œé¡¹ç›®ä¹Ÿéƒ½æ˜¯å•ç‚¹éƒ¨ç½²ï¼Œä¸»è¦ç”¨çš„æ¡†æ¶éƒ½æ˜¯springã€mybatisã€Hibernateã€springMVCç­‰ç›¸äº’ç»“åˆä½¿ç”¨ï¼Œå³ï¼šSSMï¼ŒSSHï¼Œç›¸æ¯”äºspringBootæ¥è¯´ä¸å€¼ä¸€æï¼Œç°åœ¨åº”è¯¥æ²¡æœ‰å‡ ä¸ªå…¬å¸è¿˜æ²¡ç”¨springBootäº†å§(#^.^#)ï¼Œå€¼å¾—ä¸€æçš„æ˜¯ï¼Œåˆšæ¯•ä¸šé‚£ä¼šï¼Œåšäº†åŠå¹´çš„Cè¯­è¨€åµŒå…¥å¼å¼€å‘ï¼Œå¤–åŒ…åˆ°å¤§è¿ä¸œè½¯åšå¯¹æ—¥çš„ä½³èƒ½ç›¸æœºç³»ç»Ÿï¼Œè™½ç„¶ç›®å‰æˆ‘å·²ç»åšäº†å¤šå¹´çš„javaå¼€å‘ï¼Œä½†æ˜¯é‚£æ¯•ç«Ÿæ˜¯æˆ‘ç¬¬ä¸€æ¬¡å‚åŠ å¼€å‘é¡¹ç›®ï¼Œäººéƒ½æ˜¯æœ‰åˆæ‹æƒ…èŠ‚çš„å˜›ï¼Œå¯¹è‡ªå·±çš„ç¬¬ä¸€æ¬¡å¿µå¿µä¸å¿˜(æˆ‘æŒ‡å¾—æ˜¯å·¥ä½œğŸ¤­)ï¼Œé‚£åŠå¹´è®©æˆ‘å¯¹ç¡¬ä»¶åº•å±‚æœ‰äº†ä¸€äº›ç†è§£ï¼Œä¹Ÿç®—æ˜¯æœ€å¤§çš„æ”¶è·äº†å§ã€‚ â€”â€” åŒ…é“¶æ¶ˆè´¹é‡‘è(ç°åï¼šè’™å•†æ¶ˆè´¹) â€”â€”â€‹ åŒ…å¤´å¸‚åŒ…é“¶æ¶ˆè´¹é‡‘èè‚¡ä»½æœ‰é™å…¬å¸æ˜¯ç»ä¸­å›½é“¶ç›‘ä¼šæ‰¹å‡†æˆç«‹çš„æŒç‰Œæ¶ˆè´¹é‡‘èå…¬å¸ï¼Œç”±åŒ…å•†é“¶è¡Œå‘èµ·è®¾ç«‹ï¼ŒåŒ…é“¶æ¶ˆè´¹é‡‘èä¸ºä¸ªäººæ¶ˆè´¹è€…æä¾›æ¶ˆè´¹ä¿¡è´·æœåŠ¡ã€‚å…¶ä¸»è¦åˆä½œæ¸ é“æœ‰ï¼šè¯å¤§è´¢å¯Œï¼Œäº¬ä¸œé‡‘æ¡ï¼Œå¾®ç²’è´·ï¼Œå»å“ªå„¿ï¼Œäº¬ä¸œå€Ÿè´·å¹³å°ï¼Œåˆ†æœŸä¹ï¼Œå°ç±³ç­‰å¤šå®¶æ”¾æ¬¾æ¸ é“ã€‚ç›®å‰ï¼Œå·²ç´¯è®¡å®Œæˆ 1200 å¤šä¸‡å®¢æˆ·æ³¨å†Œå’Œ 320 å¤šäº¿æ”¾æ¬¾è§„æ¨¡ã€‚ acsï¼šæ ¸å¿ƒäº¤æ˜“ç³»ç»Ÿä¸»è¦åŒ…å«ä¿¡è´·æ ¸ç®—ä¸šåŠ¡å’Œè™šæ‹Ÿè´¦æˆ·ä¸šåŠ¡ï¼Œä¿¡è´·æ ¸ç®—ä¸»è¦è´Ÿè´£å€Ÿè¿˜æ¬¾ã€æ ¸é”€å‡å…äº¤æ˜“ã€åˆ©æ¯ã€ç½šæ¯è®¡æã€å„ç§è´¹ç”¨ç­‰ä¸šåŠ¡çš„è®¡ç®—å’Œè½åœ°ï¼Œæ—¥ç»ˆç”Ÿæˆäº¤æ˜“æµæ°´æ–‡ä»¶ä¾›ä¼šè®¡æ ¸ç®—ç³»ç»Ÿç”Ÿæˆä¼šè®¡åˆ†å½•ï¼›è™šæ‹Ÿè´¦æˆ·éƒ¨åˆ†ä¸»è¦ä¸ºæ¸…ç»“ç®—äººå‘˜æä¾›äº¤æ˜“äº§ç”Ÿçš„ä¸åŒèµ„é‡‘è´¦æˆ·é‡‘é¢çš„å˜åŒ–åŠèµ„é‡‘æµå‘ï¼Œä¸ºæ¸…ç»“ç®—äººå‘˜å¯¹è´¦æä¾›æ•°æ®æ”¯æŒï¼›ç³»ç»Ÿå¯ä»¥å¤„ç†æ¯åˆ†é’Ÿå³°å€¼ 640 å¤šç¬”æˆä¿¡ç”³è¯·ï¼Œæ¯å°æ—¶å³°å€¼ 2 ä¸‡ç¬”æˆä¿¡ç”³è¯·ï¼Œè´·åæ”¯æŒæ¯å°æ—¶ 17 ä¸‡å®¢æˆ·æ•°æ®ã€‚æ ¸å¿ƒæ—¥ç»ˆå¤„ç†é‡è¾¾ 152 ä¸‡ç¬”(å€Ÿæ®æ•°é‡)ã€‚ glsï¼šè´¢åŠ¡æ ¸ç®—ç³»ç»Ÿå¯¹æ ¸å¿ƒäº¤æ˜“ç³»ç»Ÿæ—¥ç»ˆç”Ÿæˆçš„äº¤æ˜“æµæ°´è§£æä¹‹åæŒ‰ç…§åˆ†å½•å€Ÿè´·è§„åˆ™ç”Ÿæˆè´¢åŠ¡åˆ†å½•æ–‡ä»¶äº¤ç»™é‡‘è¶ç³»ç»Ÿï¼Œ17 å¹´è´¢åŠ¡æ ¸ç®—ç³»ç»Ÿæ˜¯ä¹°æ¥çš„ç³»ç»Ÿï¼Œ19 å¹´ç”±æˆ‘é‡æ–°å¼€å‘å‡ºå±äºå…¬å¸è‡ªå·±çš„è´¢åŠ¡æ ¸ç®—ç³»ç»Ÿï¼Œå¹¶å¢åŠ äº†è´¢åŠ¡å¯¹è´¦åŠŸèƒ½(æ ¸å¿ƒäº¤æ˜“ç³»ç»Ÿå’Œè´¢åŠ¡åˆ†å½•å¯¹è´¦)ï¼Œä¸ä½†åŠæ—¶å‘ç°çº¿ä¸Šäº¤æ˜“çš„é”™è¯¯æ•°æ®ï¼ŒåŠæ—¶è§£å†³é—®é¢˜ï¼Œæ›´æå‡äº†æœˆç»ˆå¯¹è´¦ï¼Œå¹´ç»“çš„æ•ˆç‡ï¼Œå®ç°äº†è´¢åŠ¡å¯¹è´¦è‡ªåŠ¨åŒ–ï¼Œè§£å†³äº†å¹´ç»“äººå·¥å¯¹è´¦çš„ç—›ç‚¹ã€‚ ecifï¼šæ¸ é“ç³»ç»Ÿè¦è´Ÿè´£å¯¹æ¥ç¬¬ä¸‰æ–¹å¼•æµæ¸ é“ï¼Œå®¢æˆ·é€šè¿‡ç¬¬ä¸‰æ–¹æ¸ é“æˆä¿¡ã€å€Ÿæ¬¾ï¼Œæ¸ é“å¼•æµåˆ°åŒ…é“¶ï¼Œç”±äºä¸åŒæ¸ é“çš„æˆä¿¡ã€æ”¾æ¬¾ä¸šåŠ¡é€»è¾‘ä¸åŒï¼Œé’ˆå¯¹ä¸åŒæ¸ é“æä¾›ä¸åŒçš„åŠŸèƒ½å¼€å‘ã€‚å…¶ä¸­éƒ¨åˆ†æ¸ é“ç§¯ç´¯ä¸€å¤©å®¢æˆ·æˆä¿¡è¯·æ±‚æŒ‡å®šæ—¶é—´ç»Ÿä¸€å‘é€æˆä¿¡ç”³è¯·åˆ°åŒ…é“¶ï¼Œç³»ç»Ÿå¯å¤„ç†æ¯åˆ†é’Ÿ 800 ç¬”æˆä¿¡è¯·æ±‚ã€‚ cssï¼šæ¸…ç»“ç®—ç³»ç»Ÿæ­¤ç³»ç»Ÿæ˜¯å…¬å¸å†…éƒ¨æ¸…ç»“ç®—äººå‘˜ä½¿ç”¨çš„å†…éƒ¨ä¸šåŠ¡ç³»ç»Ÿï¼Œä¸»è¦åŠŸèƒ½æœ‰ä¸ªäººæº¢ç¼´æ¬¾è´¦æˆ·ç®¡ç†ã€å¯¹å…¬ä»˜æ¬¾ã€å¯¹ç§ä»˜æ¬¾ã€é€€æ¬¾ä»¥åŠæ¸…ç»“ç®—åŒäº‹è½¬è´¦ä¸šåŠ¡çš„å‘èµ·å’Œå®¡æ ¸åŠŸèƒ½ è”åˆè´·æ¬¾ç³»ç»Ÿä¸»è¦åŠŸèƒ½æœ‰è”åˆè´·æ¬¾åè®®ï¼Œè·¯ç”±é…ç½®ï¼Œè·¯ç”±è§„åˆ™ï¼Œå€Ÿæ®è¿˜æ¬¾è®¡åˆ’æ‹†åˆ†ï¼Œèµ„æ–¹æˆä¿¡ï¼Œå€Ÿæ®ã€äº¤æ˜“æµæ°´æ–‡ä»¶ï¼Œè”åˆè´·æ¬¾æˆä¿¡å½±éŸ³èµ„æ–™æ¨é€ ç›‘ç®¡æŠ¥é€ç³»ç»ŸæŒ‰ç…§ç›‘ç®¡æŠ¥é€éœ€æ±‚ï¼Œå¯¹å€Ÿæ®(æ¯æœˆæŠ¥é€å…¨é‡æ•°æ®)ï¼Œè¿˜æ¬¾è®¡åˆ’ï¼Œè¿˜æ¬¾æµæ°´ï¼Œå®¢æˆ·ï¼Œäº§å“ï¼Œæ ¸é”€ï¼Œå€Ÿæ¬¾ç”³è¯·ï¼Œèµ„äº§è¯åˆ¸åŒ–ï¼Œäº”çº§åˆ†ç±»ç­‰ä¿¡æ¯è¿›è¡ŒåŠ å·¥ä¹‹åæ¨é€ç»™ç›‘ç®¡æŠ¥é€ç³»ç»Ÿ è‡ªæˆ‘è¯„ä»·ä¸šç²¾äºå‹¤ï¼Œè’äºå¬‰ ã€è¡Œæˆäºæ€ï¼Œæ¯äºéšã€‚ æ€§æ ¼ä¹è§‚å¼€æœ—ï¼Œè¯ç—¨ï¼Œçƒ­çˆ±ç”Ÿæ´»ï¼Œå–œæ¬¢æ‹è§†é¢‘è®°å½•ç”Ÿæ´»ï¼Œå–œæ¬¢åˆ†äº«çŸ¥è¯†ï¼Œåˆ†äº«æŠ€æœ¯ï¼Œåˆ†äº«ç”Ÿæ´»ä¸­çš„ç‚¹ç‚¹æ»´æ»´ï¼Œè„¾æ°”å¥½ï¼Œæ€•è€å©† ä¸ªäººçˆ±å¥½ ç”µå­ç§‘æŠ€äº§å“ è½¯ä»¶ â€”â€” å–œæ¬¢winã€Macã€Android å¥½ç”¨æ— å¹¿å‘Šè½¯ä»¶ç ”ç©¶åŠåˆ†äº« è¶³çƒ â€”â€” å–œæ¬¢ä½†æ˜¯æ²¡æœºä¼šç©ï¼Œæ€€å¿µé«˜ä¸­æ—¶ä»£å‘€â€¦. ä¸‰å›½æ€ â€”â€” åŸºæœ¬å·²ç»è¢«å‡‰ä¼é€¼åˆ°é€€æ¸¸äº†â€¦.è€Œä¸”ç”Ÿæ´»ä¸­ä¹Ÿå¾ˆéš¾æ‰¾åˆ°ä¸€èµ·ç©è¿™ä¸ªæ¸¸æˆçš„æœ‹å‹äº†ğŸ¤£ é€›Bç«™ â€”â€” ç”Ÿæ´»åŒºå’Œç§‘æŠ€åŒºä¸€ä¸ªä¸çŸ¥åé˜¿å©†ä¸»ğŸ˜‚ï¼Œä½›ç³»æ›´æ–°è§†é¢‘ ğŸ‘‰ ç‚¹å‡»æ‰“å¼€æˆ‘çš„Bç«™ä¸ªäººç©ºé—´ è®°å¾—ä¸‰è¿ ğŸ‘ğŸ‘ğŸ‘ çœ‹ç”µå½± â€”â€” å–œæ¬¢ç§‘å¹»ã€æ¼«å¨ç²‰ã€è¿½æ–—ç½—å¤§é™†â€¦.."},{"title":"","date":"2022-01-27T08:31:13.129Z","updated":"2022-01-27T08:31:13.129Z","comments":true,"path":"css/custom.css","permalink":"https://zhangyong3214.github.io/css/custom.css","excerpt":"","text":"/* æ–‡ç« é¡µH1-H6å›¾æ ‡æ ·å¼æ•ˆæœ */ h1::before, h2::before, h3::before, h4::before, h5::before, h6::before { -webkit-animation: ccc 1.6s linear infinite ; animation: ccc 1.6s linear infinite ; } @-webkit-keyframes ccc { 0% { -webkit-transform: rotate(0deg); transform: rotate(0deg) } to { -webkit-transform: rotate(-1turn); transform: rotate(-1turn) } } @keyframes ccc { 0% { -webkit-transform: rotate(0deg); transform: rotate(0deg) } to { -webkit-transform: rotate(-1turn); transform: rotate(-1turn) } } #content-inner.layout h1::before { color: #ef50a8 ; margin-left: -1.55rem; font-size: 1.3rem; margin-top: -0.23rem; } #content-inner.layout h2::before { color: #fb7061 ; margin-left: -1.35rem; font-size: 1.1rem; margin-top: -0.12rem; } #content-inner.layout h3::before { color: #ffbf00 ; margin-left: -1.22rem; font-size: 0.95rem; margin-top: -0.09rem; } #content-inner.layout h4::before { color: #a9e000 ; margin-left: -1.05rem; font-size: 0.8rem; margin-top: -0.09rem; } #content-inner.layout h5::before { color: #57c850 ; margin-left: -0.9rem; font-size: 0.7rem; margin-top: 0.0rem; } #content-inner.layout h6::before { color: #5ec1e0 ; margin-left: -0.9rem; font-size: 0.66rem; margin-top: 0.0rem; } #content-inner.layout h1:hover, #content-inner.layout h2:hover, #content-inner.layout h3:hover, #content-inner.layout h4:hover, #content-inner.layout h5:hover, #content-inner.layout h6:hover { color: #49b1f5 ; } #content-inner.layout h1:hover::before, #content-inner.layout h2:hover::before, #content-inner.layout h3:hover::before, #content-inner.layout h4:hover::before, #content-inner.layout h5:hover::before, #content-inner.layout h6:hover::before { color: #49b1f5 ; -webkit-animation: ccc 3.2s linear infinite ; animation: ccc 3.2s linear infinite ; } /* é¡µé¢è®¾ç½®iconè½¬åŠ¨é€Ÿåº¦è°ƒæ•´ */ #rightside_config i.fas.fa-cog.fa-spin { animation: fa-spin 5s linear infinite ; } /*--------æ›´æ¢å­—ä½“------------*/ @font-face { font-family: 'tzy'; /* å­—ä½“åè‡ªå®šä¹‰å³å¯ */ src: url('https://cdn.jsdelivr.net/gh/tzy13755126023/BLOG_SOURCE/font/ZhuZiAWan.woff2'); /* å­—ä½“æ–‡ä»¶è·¯å¾„ */ font-display: swap; } body, .gitcalendar { font-family: tzy !important; } .categoryBar-list { max-height: 400px; } .clock-row { overflow: hidden; text-overflow: ellipsis; } /*3sä¸ºåŠ è½½åŠ¨ç”»çš„æ—¶é—´ï¼Œ1ä¸ºåŠ è½½åŠ¨ç”»çš„æ¬¡æ•°ï¼Œease-in-outä¸ºåŠ¨ç”»æ•ˆæœ*/ #page-header, #web_bg { -webkit-animation: imgblur 2s 1 ease-in-out; animation: imgblur 2s 1 ease-in-out; } @keyframes imgblur { 0% { filter: blur(5px); } 100% { filter: blur(0px); } } /*é€‚é…ä½¿ç”¨-webkitå†…æ ¸çš„æµè§ˆå™¨ */ @-webkit-keyframes imgblur { 0% { -webkit-filter: blur(5px); } 100% { -webkit-filter: blur(0px); } } .table-wrap img { margin: .6rem auto .1rem !important; } /* æ ‡ç­¾å¤–æŒ‚ ç½‘ç«™å¡ç‰‡ start */ .site-card-group img { margin: 0 auto .1rem !important; } .site-card-group .info a img { margin-right: 10px !important; } [data-theme='dark'] .site-card-group .site-card .info .title { color: #f0f0f0 !important; } [data-theme='dark'] .site-card-group .site-card .info .desc { color: rgba(255, 255, 255, .7) !important; } .site-card-group .info .desc { margin-top: 4px !important; } /* ä»£ç å—é¢œè‰² */ figure.highlight pre .addition { color: #00bf03 !important; }"},{"title":"åˆ†ç±»","date":"2022-01-27T08:31:13.129Z","updated":"2022-01-27T08:31:13.129Z","comments":true,"path":"categories/index.html","permalink":"https://zhangyong3214.github.io/categories/index.html","excerpt":"","text":""}],"posts":[{"title":"æ•°æ®ç»“æ„å’Œç®—æ³•","slug":"é¢è¯•åŸºåœ°/æ•°æ®ç»“æ„å’Œç®—æ³•","date":"2022-01-27T08:31:13.129Z","updated":"2022-01-27T08:31:13.129Z","comments":true,"path":"2022/01/27/é¢è¯•åŸºåœ°/æ•°æ®ç»“æ„å’Œç®—æ³•/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E9%9D%A2%E8%AF%95%E5%9F%BA%E5%9C%B0/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%92%8C%E7%AE%97%E6%B3%95/","excerpt":"","text":"æ’åºç®—æ³•é«˜æ•ˆäº¤æ¢ç®—æ³•(å¼‚æˆ–^)æ¦‚å¿µ 0^N = N ; N^N = 0 ç›¸åŒä¸º0ï¼Œä¸åŒä¸º1ï¼Œä¹Ÿå¯ä»¥å«åšæ— è¿›ä½ç›¸åŠ ï¼Œè¿™ä¹ˆåšçš„å‰æï¼šéœ€è¦äº¤æ¢çš„ä¸¤ä¸ªæ•°æŒ‡å‘çš„å†…å­˜æ˜¯ä¸¤ä½ä½ç½® å¼‚æˆ–è¿ç®—æ»¡è¶³äº¤æ¢å¾‹å’Œç»“åˆå¾‹ ä¸ç”¨é¢å¤–å˜é‡äº¤æ¢ä¸¤ä¸ªæ•° 123456// äº¤æ¢arrçš„iå’Œjä½ç½®ä¸Šçš„å€¼public static void swap(int[] arr, int i, int j) &#123; arr[i] = arr[i] ^ arr[j]; arr[j] = arr[i] ^ arr[j]; arr[i] = arr[i] ^ arr[j];&#125; ä¸€ç§æ•°å‡ºç°å¥‡æ•°æ¬¡ä¸€ä¸ªæ•°ç»„ä¸­æœ‰ä¸€ä¸ªæ•°å‡ºç°å¥‡æ•°æ¬¡ï¼Œå…¶ä»–æ•°éƒ½å‡ºç°å¶æ•°æ¬¡ï¼Œæ€ä¹ˆæ‰¾åˆ°è¿™ä¸€ä¸ªæ•°ï¼Ÿ 1234567public static void printOddTimesNum1(int[] arr) &#123; int eor = 0; for (int i = 0; i &lt; arr.length; i++) &#123; eor ^= arr[i]; &#125; System.out.println(eor);&#125; ä¸¤ç§æ•°å‡ºç°å¥‡æ•°æ¬¡ä¸€ä¸ªæ•°ç»„ä¸­æœ‰ä¸¤ä¸ªæ•°å‡ºç°å¥‡æ•°æ¬¡ï¼Œå…¶ä»–æ•°éƒ½å‡ºç°äº†å¶æ•°æ¬¡ï¼Œæ€ä¹ˆæ‰¾åˆ°è¿™ä¸¤ä¸ªæ•°ï¼Ÿ 123456789101112131415161718192021public static void printOddTimesNum2(int[] arr) &#123; int eor = 0; for (int i = 0; i &lt; arr.length; i++) &#123; eor ^= arr[i]; &#125; // a å’Œ bæ˜¯ä¸¤ç§æ•° // eor != 0 // eoræœ€å³ä¾§çš„1ï¼Œæå–å‡ºæ¥ // eor : 00110010110111000 // rightOne :00000000000001000 int rightOne = eor &amp; (-eor); // æå–å‡ºæœ€å³çš„1 int onlyOne = 0; // eor&#x27; for (int i = 0 ; i &lt; arr.length;i++) &#123; // arr[1] = 111100011110000 // rightOne= 000000000010000 if ((arr[i] &amp; rightOne) != 0) &#123; onlyOne ^= arr[i]; &#125; &#125; System.out.println(onlyOne + &quot; &quot; + (eor ^ onlyOne));&#125; å†’æ³¡æ’åº åŸºæœ¬å†’æ³¡æ’åºç®—æ³• 123456789101112131415public static void bubbleSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; // 0 ~ N-1 // 0 ~ N-2 // 0 ~ N-3 for (int e = arr.length - 1; e &gt; 0; e--) &#123; // 0 ~ e for (int i = 0; i &lt; e; i++) &#123; if (arr[i] &gt; arr[i + 1]) &#123; swap(arr, i, i + 1); &#125; &#125; &#125; &#125; å†’æ³¡æ’åºç®—æ³•ä¼˜åŒ– åœ¨ä¸€è¶Ÿæ’åºè¿‡ç¨‹ä¸­å¦‚æœä¸€æ¬¡éƒ½æ²¡æœ‰äº¤æ¢è¿‡ï¼Œé‚£è¯´æ˜åç»­çš„æ•°éƒ½æ˜¯æœ‰åºçš„ï¼Œä¸éœ€è¦åœ¨è¿›è¡Œåç»­çš„æ’åºäº†ï¼Œå¦‚æœå…ƒç´ æœ¬æ¥å°±æ˜¯æœ‰åºçš„ï¼Œå°±åªæ¯”è¾ƒä¸€æ¬¡å°±ç»“æŸäº†ã€‚ 12345678910111213141516171819202122232425public static void bubbleSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; // æ ‡è¯†å˜é‡ï¼Œè¡¨ç¤ºæ˜¯å¦è¿›è¡Œè¿‡äº¤æ¢ boolean flag = false; for (int i = 0; i &lt; arr.length - 1; i++) &#123; for (int j = 0; j &lt; arr.length - 1 - i; j++) &#123; // å¦‚æœå‰é¢çš„æ•°æ¯”åé¢çš„æ•°å¤§ï¼Œåˆ™äº¤æ¢ if (arr[j] &gt; arr[j + 1]) &#123; flag = true; int temp = arr[j]; arr[j] = arr[j + 1]; arr[j + 1] = temp; &#125; &#125; // åœ¨ä¸€è¶Ÿæ’åºä¸­ï¼Œä¸€æ¬¡äº¤æ¢éƒ½æ²¡æœ‰å‘ç”Ÿè¿‡ if (!flag) &#123; break; &#125; else &#123; // é‡ç½®flag!!!, è¿›è¡Œä¸‹æ¬¡åˆ¤æ–­ flag = false; &#125; &#125;&#125; é€‰æ‹©æ’åº 0 ~ N-1 æ‰¾åˆ°æœ€å°å€¼ï¼Œåœ¨å“ªï¼Œæ”¾åˆ°0ä½ç½®ä¸Š 1 ~ n-1 æ‰¾åˆ°æœ€å°å€¼ï¼Œåœ¨å“ªï¼Œæ”¾åˆ°1 ä½ç½®ä¸Š 2 ~ n-1 æ‰¾åˆ°æœ€å°å€¼ï¼Œåœ¨å“ªï¼Œæ”¾åˆ°2 ä½ç½®ä¸Š 123456789101112public static void selectionSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; for (int i = 0; i &lt; arr.length - 1; i++) &#123; int minIndex = i; for (int j = i + 1; j &lt; arr.length; j++) &#123; // i ~ N-1 ä¸Šæ‰¾æœ€å°å€¼çš„ä¸‹æ ‡ minIndex = arr[j] &lt; arr[minIndex] ? j : minIndex; &#125; swap(arr, i, minIndex); &#125;&#125; æ’å…¥æ’åº 0~1å•èŒƒå›´æœ‰åº 0~2èŒƒå›´æœ‰åº 0~3èŒƒå›´æœ‰åº 0~NèŒƒå›´æœ‰åº 1234567891011public static void insertionSort(int[] arr) &#123; if (arr == null || arr.length &lt; 2) &#123; return; &#125; // ä¸åª1ä¸ªæ•° for (int i = 1; i &lt; arr.length; i++) &#123; // 0 ~ i åšåˆ°æœ‰åº for (int j = i - 1; j &gt;= 0 &amp;&amp; arr[j] &gt; arr[j + 1]; j--) &#123; swap(arr, j, j + 1); &#125; &#125;&#125; æŸ¥æ‰¾ç®—æ³•äºŒåˆ†æŸ¥æ‰¾äºŒåˆ†æ³•çš„è¯¦è§£ä¸æ‰©å±• åœ¨ä¸€ä¸ªæœ‰åºæ•°ç»„ä¸­ï¼ŒæŸ¥æ‰¾æŸä¸ªæ•°æ˜¯å¦å­˜åœ¨ åœ¨ä¸€ä¸ªæœ‰åºæ•°ç»„ä¸­ï¼Œæ‰¾&gt;=æŸä¸ªæ•°æœ€å·¦ä¾§çš„ä½ç½® å±€éƒ¨æœ€å°å€¼é—®é¢˜ 1234567891011121314151617181920public static boolean exist(int[] sortedArr, int num) &#123; if (sortedArr == null || sortedArr.length == 0) &#123; return false; &#125; int L = 0; int R = sortedArr.length - 1; int mid = 0; // L..R while (L &lt; R) &#123; // L..R è‡³å°‘ä¸¤ä¸ªæ•°çš„æ—¶å€™ mid = L + ((R - L) &gt;&gt; 1); if (sortedArr[mid] == num) &#123; return true; &#125; else if (sortedArr[mid] &gt; num) &#123; R = mid - 1; &#125; else &#123; L = mid + 1; &#125; &#125; return sortedArr[L] == num;&#125; æ•°ç»„èŒƒå›´ä¸Šæ±‚æœ€å¤§å€¼é€’å½’è§£æ³• 123456789101112public static int process(int[] arr, int L, int R) &#123; // arr[L..R]èŒƒå›´ä¸Šåªæœ‰ä¸€ä¸ªæ•°ï¼Œç›´æ¥è¿”å›ï¼Œbase case if (L == R) &#123; return arr[L]; &#125; // L...R ä¸åªä¸€ä¸ªæ•° // mid = (L + R) / 2 int mid = L + ((R - L) &gt;&gt; 1); // ä¸­ç‚¹ int leftMax = process(arr, L, mid); int rightMax = process(arr, mid + 1, R); return Math.max(leftMax, rightMax);&#125; å¯¹æ•°å™¨çš„æ¦‚å¿µ æœ‰ä¸€ä¸ªä½ æƒ³è¦æµ‹è¯•çš„æ–¹æ³•a å®ç°å¤æ‚åº¦ä¸å¥½ä½†æ˜¯å®¹æ˜“å®ç°çš„æ–¹æ³•b å®ç°ä¸€ä¸ªéšæœºæ ·æœ¬äº§ç”Ÿå™¨ æŠŠæ–¹æ³•aå’Œæ–¹æ³•bè·‘ç›¸åŒçš„éšæœºæ ·æœ¬ï¼Œçœ‹çœ‹å¾—åˆ°çš„ç»“æœæ˜¯å¦ä¸€æ · å¦‚æœæœ‰ä¸€ä¸ªéšæœºæ ·æœ¬æ—¶çš„æ¯”å¯¹ç»“æœä¸ä¸€è‡´ï¼Œæ‰“å°æ ·æœ¬è¿›è¡Œäººå·¥å¹²é¢„ï¼Œæ”¹å¯¹æ–¹æ³•aæˆ–è€…æ–¹æ³•b å½“æ ·æœ¬æ•°é‡å¾ˆå¤šæ—¶æ¯”å¯¹æµ‹è¯•ä¾ç„¶æ­£ç¡®ï¼Œå¯ä»¥ç¡®å®šæ–¹æ³•aå·²ç»æ­£ç¡® æ•°ç»„abæ•°ç»„åˆå¹¶åˆ°a é¢˜ç›®ï¼šç»™å‡ºä¸¤ä¸ªæœ‰åºçš„æ•´æ•°æ•°ç»„Aå’ŒBï¼Œè¯·å°†æ•°ç»„Båˆå¹¶åˆ°æ•°ç»„Aä¸­ï¼Œå˜æˆä¸€ä¸ªæœ‰åºçš„æ•°ç»„ã€‚æ³¨æ„ï¼šå¯ä»¥å‡è®¾Aæ•°ç»„æœ‰è¶³å¤Ÿçš„ç©ºé—´å­˜æ”¾Bæ•°ç»„çš„å…ƒç´ ï¼ŒAå’ŒBä¸­åˆå§‹çš„å…ƒç´ æ•°ç›®åˆ†åˆ«ä¸ºmå’Œnã€‚ é¢˜è§£ï¼šæœ€ä¼˜è§£ï¼šä»åå¾€å‰å¤„ç†,ä¸éœ€è¦å¼€è¾Ÿé¢å¤–ç©ºé—´ã€‚ä»åå¾€å‰ï¼Œè¿™æ ·ä¸éœ€è¦è¿›è¡Œå†—ä½™å¤„ç†ã€‚ 12345678910111213141516171819202122/** * @param a æ•°ç»„aï¼Œæœ‰è¶³å¤Ÿçš„ç©ºé—´åˆå¹¶æ•°ç»„b * @param m æ•°ç»„aé‡Œé¢çš„å…ƒç´ ä¸ªæ•° * @param b æ•°ç»„b * @param n æ•°ç»„bé‡Œé¢çš„å…ƒç´ ä¸ªæ•° */public static void merge(int[] a, int m, int[] b, int n) &#123; int i = m - 1; int j = n - 1; int index = m + n - 1; while (i &gt;= 0 &amp;&amp; j &gt;= 0) &#123; if(a[i] &gt; b[j] )&#123; a[index--] = a[i--]; &#125; else &#123; a[index--] = b[j--]; &#125; &#125; //å¦‚æœAçš„æ•°å­—æ¯”Bå¤šï¼Œåˆ™ä¸ä¼šè¿›å…¥åç»­å¤„ç†ï¼›å¦‚æœBçš„æ•°å­—æ¯”Aå¤šï¼Œåˆ™è¿›å…¥åç»­å¤„ç†ï¼Œå°†Bå‰©ä½™æ•°å­—æ·»åŠ åˆ°æ•°ç»„Aä¸­ã€‚ while (j &gt;= 0) &#123; a[index--] = b[j--]; &#125;&#125; abæ•°ç»„åˆå¹¶åˆ°c é¢˜ç›®ï¼š åˆå¹¶ä¸¤ä¸ªæœ‰åºæ•´å‹æ•°æ®ï¼ˆå…¥å‚ä¸¤ä¸ªéœ€è¦åˆå¹¶çš„æ•°ç»„ï¼Œè¿”å›å€¼åˆå¹¶å¥½çš„æ–°æ•°ç»„ï¼‰ 123456789101112131415161718192021222324252627private static int[] margeArr(int[] a, int[] b) &#123; int[] c = new int[a.length + b.length]; int i = 0, j = 0; int index = 0; //æ¯”è¾ƒæŒ‡é’ˆi,jæŒ‡å‘çš„å€¼ï¼Œå°çš„å€¼å­˜å…¥æŒ‡é’ˆindexæŒ‡å‘çš„ç»“æœæ•°ç»„ä¸­ï¼Œå½“æœ‰ä¸€ä¸ªæŒ‡é’ˆï¼ˆiæˆ–jï¼‰å…ˆåˆ°è¾¾æ•°ç»„æœ«å°¾æ—¶ï¼Œæ¯”è¾ƒç»“æŸï¼› while (i &lt; a.length &amp;&amp; j &lt; b.length) &#123; if (a[i] &lt; b[j]) &#123; c[index++] = a[i++]; &#125; else &#123; c[index++] = b[j++]; &#125; &#125; int l; //å°†æŒ‡é’ˆï¼ˆiæˆ–jï¼‰æ²¡æœ‰åˆ°è¾¾æ•°ç»„æœ«å°¾çš„æ•°ç»„å¤åˆ¶åˆ°æŒ‡é’ˆindexæŒ‡å‘çš„ç»“æœæ•°ç»„ä¸­ if (i &lt; a.length) &#123; for (l = i; l &lt; a.length; l++) &#123; c[index++] = a[l]; &#125; &#125; //å°†æŒ‡é’ˆï¼ˆiæˆ–jï¼‰æ²¡æœ‰åˆ°è¾¾æ•°ç»„æœ«å°¾çš„æ•°ç»„å¤åˆ¶åˆ°æŒ‡é’ˆindexæŒ‡å‘çš„ç»“æœæ•°ç»„ä¸­ if (j &lt; b.length) &#123; for (l = j; l &lt; b.length; l++) &#123; c[index++] = b[l]; &#125; &#125; return c;&#125; æŸ¥æ‰¾ä¸¤æ•°ä¹‹å’Œç­‰äºç›®æ ‡æ•° é¢˜ç›®ï¼šç»™å®šä¸€ä¸ªæ•°ç»„å’Œä¸€ä¸ªç›®æ ‡æ•°ï¼Œä»æ•°ç»„ä¸­æ‰¾åˆ°ä¸¤ä¸ªæ•°ï¼Œæ˜¯è¿™ä¸¤ä¸ªæ•°ä¹‹å’Œç­‰äºç›®æ ‡æ•°ã€‚è¿”å›å…¶åœ¨æ•°ç»„ä¸­çš„ç¼–å· 12345678910public static int[] twoSum(int[] nums, int target) &#123; Map&lt;Integer, Integer&gt; map = new HashMap&lt;&gt;(); for (int i = 0; i &lt; nums.length; i++) &#123; if (map.containsKey(target - nums[i])) &#123; return new int[]&#123;map.get(target - nums[i]), i&#125;; &#125; map.put(nums[i], i); &#125; return null;&#125; èºæ—‹æ‰“å°äºŒç»´æ•°ç»„1234567891011121314151617181920212223242526272829303132333435363738394041424344454647public static void printEdge(int[][] m, int tR, int tC, int dR, int dC) &#123; if (tR == dR) &#123; for (int i = tC; i &lt;= dC; i++) &#123; System.out.print(m[tR][i] + &quot; &quot;); &#125; &#125; else if (tC == dC) &#123; for (int i = tR; i &lt;= dR; i++) &#123; System.out.print(m[i][tC] + &quot; &quot;); &#125; &#125; else &#123; int curC = tC; int curR = tR; while (curC != dC) &#123; System.out.print(m[tR][curC] + &quot; &quot;); curC++; &#125; while (curR != dR) &#123; System.out.print(m[curR][dC] + &quot; &quot;); curR++; &#125; while (curC != tC) &#123; System.out.print(m[dR][curC] + &quot; &quot;); curC--; &#125; while (curR != tR) &#123; System.out.print(m[curR][tC] + &quot; &quot;); curR--; &#125; &#125;&#125;public static void spiralOrderPrint(int[][] matrix) &#123; int tR = 0; int tC = 0; int dR = matrix.length - 1; int dC = matrix[0].length - 1; while (tR &lt;= dR &amp;&amp; tC &lt;= dC) &#123; printEdge(matrix, tR++, tC++, dR--, dC--); &#125;&#125;public static void main(String[] args) &#123; int[][] matrix = &#123; &#123; 1, 2, 3, 4 &#125;, &#123; 5, 6, 7, 8 &#125;, &#123; 9, 10, 11, 12 &#125;, &#123; 13, 14, 15, 16 &#125; &#125;; spiralOrderPrint(matrix);&#125; é“¾è¡¨ å¯¹äºç¬”è¯•ï¼Œä¸ç”¨å¤ªåœ¨ä¹ç©ºé—´å¤æ‚åº¦ï¼Œä¸€åˆ‡ä¸ºäº†æ—¶é—´å¤æ‚åº¦ å¯¹äºé¢è¯•ï¼Œæ—¶é—´å¤æ‚åº¦ä¾ç„¶æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œä½†æ˜¯ä¸€å®šè¦æ‰¾åˆ°ç©ºé—´æœ€çœçš„æ–¹æ³• é‡è¦æŠ€å·§ é¢å¤–æ•°æ®ç»“æ„è®°å½•ï¼ˆå“ˆå¸Œè¡¨ç­‰ï¼‰ å¿«æ…¢æŒ‡é’ˆ é“¾è¡¨åè½¬å•å‘é“¾è¡¨åè½¬123456789// å•å‘é“¾è¡¨èŠ‚ç‚¹public static class Node &#123; public int value; public Node next; public Node(int data) &#123; value = data; &#125;&#125; 1234567891011121314// head å•å‘é“¾è¡¨åè½¬ç®—æ³•// a -&gt; b -&gt; c -&gt; null// c -&gt; b -&gt; a -&gt; nullpublic static Node reverseLinkedList(Node head) &#123; Node pre = null; Node next = null; while (head != null) &#123; next = head.next; head.next = pre; pre = head; head = next; &#125; return pre;&#125; 123456789101112/** * é€’å½’åè½¬æ–¹å¼ */private Node reverseLinkedList(Node head) &#123; if (head == null || head.next == null) &#123; return head; &#125; Node newHead = reverseLinkedList(head.next); head.next.next = head; head.next = null; return newHead;&#125; åŒå‘é“¾è¡¨åè½¬12345678910// åŒå‘é“¾è¡¨èŠ‚ç‚¹public static class DoubleNode &#123; public int value; public DoubleNode last; public DoubleNode next; public DoubleNode(int data) &#123; value = data; &#125;&#125; 12345678910111213// åŒå‘é“¾è¡¨åè½¬ç®—æ³•public static DoubleNode reverseDoubleList(DoubleNode head) &#123; DoubleNode pre = null; DoubleNode next = null; while (head != null) &#123; next = head.next; head.next = pre; head.last = next; pre = head; head = next; &#125; return pre;&#125; æŸ¥æ‰¾é“¾è¡¨ä¸­ç‚¹å¿«æ…¢æŒ‡é’ˆåº”ç”¨ æŸ¥æ‰¾é“¾è¡¨ä¸­ç‚¹æˆ–ä¸­ç‚¹ä¸Šä¸€ä¸ª1234567891011121314// head å¤´ è§£ï¼šæŸ¥æ‰¾é“¾è¡¨ä¸­ç‚¹æˆ–è€…ä¸­ç‚¹å‰ä¸€ä¸ªèŠ‚ç‚¹public static Node midOrUpMidNode(Node head) &#123; if (head == null || head.next == null || head.next.next == null) &#123; return head; &#125; // é“¾è¡¨æœ‰3ä¸ªç‚¹æˆ–ä»¥ä¸Š Node slow = head.next; Node fast = head.next.next; while (fast.next != null &amp;&amp; fast.next.next != null) &#123; slow = slow.next; fast = fast.next.next; &#125; return slow;&#125; æŸ¥æ‰¾é“¾è¡¨ä¸­ç‚¹æˆ–ä¸­ç‚¹ä¸‹ä¸€ä¸ª12345678910111213// æŸ¥æ‰¾é“¾è¡¨ä¸­ç‚¹æˆ–è€…ä¸­ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹public static Node midOrDownMidNode(Node head) &#123; if (head == null || head.next == null) &#123; return head; &#125; Node slow = head.next; Node fast = head.next; while (fast.next != null &amp;&amp; fast.next.next != null) &#123; slow = slow.next; fast = fast.next.next; &#125; return slow;&#125; åˆ¤æ–­ä¸€ä¸ªé“¾è¡¨æ˜¯å¦æ˜¯å›æ–‡ç»“æ„ã€é¢˜ç›®ã€‘ç»™å®šä¸€ä¸ªå•å‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹headï¼Œè¯·åˆ¤æ–­è¯¥é“¾è¡¨æ˜¯å¦ä¸ºå›æ–‡ç»“æ„ã€‚ã€ä¾‹å­ã€‘1-&gt;2-&gt;1,è¿”å›true;1-&gt;2-&gt;2-&gt;1,è¿”å›trueï¼›15-&gt;6-&gt;15ï¼Œè¿”å›trueï¼›1-&gt;2-&gt;3ï¼Œè¿”å›falseã€‚å¦‚æœé“¾è¡¨é•¿åº¦ä¸ºNï¼Œæ—¶é—´å¤æ‚åº¦è¾¾åˆ°O(N)ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦è¾¾åˆ°O(1)ã€‚ è§£é¢˜æ€è·¯1ï¼š 1ï¼šéå†é“¾è¡¨ï¼ŒæŠŠæ¯ä¸ªå…ƒç´ æ”¾åˆ°æ ˆé‡Œé¢ï¼›2ï¼šä»æ ˆé‡Œé¢ä¾æ¬¡å¼¹å‡ºå…ƒç´ å’ŒåŸæ¥é“¾è¡¨æŒ¨ä¸ªå…ƒç´ æ¯”å¯¹ã€‚ è§£é¢˜æ€è·¯2ï¼š 1ï¼šé€šè¿‡å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°ä¸­ç‚¹å’Œç»“æŸç‚¹ï¼ŒåªæŠŠå³ä¾§éƒ¨åˆ†æ”¾åˆ°æ ˆé‡Œé¢å»ï¼›2ï¼šä»æ ˆé‡Œé¢ä¾æ¬¡å¼¹å‡ºå…ƒç´ å’ŒåŸæ¥é“¾è¡¨æŒ¨ä¸ªå…ƒç´ æ¯”å¯¹ã€‚ 12345678910111213141516// 1ï¼šéå†é“¾è¡¨ï¼ŒæŠŠæ¯ä¸ªå…ƒç´ æ”¾åˆ°æ ˆé‡Œé¢ï¼›2ï¼šä»æ ˆé‡Œé¢ä¾æ¬¡å¼¹å‡ºå…ƒç´ å’ŒåŸæ¥é“¾è¡¨æŒ¨ä¸ªå…ƒç´ æ¯”å¯¹public static boolean isPalindrome1(Node head) &#123; Stack&lt;Node&gt; stack = new Stack&lt;Node&gt;(); Node cur = head; while (cur != null) &#123; stack.push(cur); cur = cur.next; &#125; while (head != null) &#123; if (head.value != stack.pop().value) &#123; return false; &#125; head = head.next; &#125; return true;&#125; 123456789101112131415161718192021222324// 1ï¼šé€šè¿‡å¿«æ…¢æŒ‡é’ˆæ‰¾åˆ°ä¸­ç‚¹å’Œç»“æŸç‚¹ï¼ŒåªæŠŠå³ä¾§éƒ¨åˆ†æ”¾åˆ°æ ˆé‡Œé¢å»ï¼›2ï¼šä»æ ˆé‡Œé¢ä¾æ¬¡å¼¹å‡ºå…ƒç´ å’ŒåŸæ¥é“¾è¡¨æŒ¨ä¸ªå…ƒç´ æ¯”å¯¹public static boolean isPalindrome2(Node head) &#123; if (head == null || head.next == null) &#123; return true; &#125; Node right = head.next; Node cur = head; while (cur.next != null &amp;&amp; cur.next.next != null) &#123; right = right.next; cur = cur.next.next; &#125; Stack&lt;Node&gt; stack = new Stack&lt;Node&gt;(); while (right != null) &#123; stack.push(right); right = right.next; &#125; while (!stack.isEmpty()) &#123; if (head.value != stack.pop().value) &#123; return false; &#125; head = head.next; &#125; return true;&#125; é“¾è¡¨æ’åºå•å‘é“¾è¡¨åˆ†å·¦ä¸­å³ã€é¢˜ç›®ã€‘ å°†å•å‘é“¾è¡¨æŒ‰ç…§æŸå€¼åˆ’åˆ†æˆå·¦è¾¹å°ï¼Œä¸­é—´ç›¸ç­‰ï¼Œå³è¾¹å¤§çš„å½¢å¼ï¼šç»™å®šä¸€ä¸ªå•é“¾è¡¨å¤´èŠ‚ç‚¹headï¼ŒèŠ‚ç‚¹çš„å€¼ç±»å‹æ˜¯æ•´å‹ï¼Œå†ç»™å®šä¸€ä¸ªæ•´æ•°pivotã€‚å®ç°ä¸€ä¸ªè°ƒæ•´é“¾è¡¨çš„å‡½æ•°ï¼Œå°†é“¾è¡¨è°ƒæ•´ä¸ºåšéƒ¨åˆ†éƒ½æ˜¯å€¼å°äºpivotçš„èŠ‚ç‚¹ï¼Œä¸­é—´éƒ¨åˆ†éƒ½æ˜¯å€¼ç­‰äºpiovtçš„èŠ‚ç‚¹ï¼Œæœ‰éƒ¨åˆ†éƒ½æ˜¯å€¼å¤§äºpiovtçš„èŠ‚ç‚¹ã€‚ã€è¿›é˜¶ã€‘åœ¨å®ç°åŸé—®é¢˜åŠŸèƒ½çš„åŸºç¡€ä¸Šå¢åŠ è¦æ±‚ï¼šå°äºï¼Œç­‰äºï¼Œå¤§äºpivotèŠ‚ç‚¹ä¹‹é—´é¡ºåºå’Œä¹‹å‰ä¸€æ ·ï¼Œæ—¶é—´å¤æ‚åº¦O(N)ï¼Œé¢å¤–ç©ºé—´å¤æ‚åº¦O(1)ã€‚ è§£é¢˜æ€è·¯1ï¼š å°†é“¾è¡¨æ”¾å…¥æ•°ç»„ï¼Œæ’åºï¼Œå†è½¬æˆé“¾è¡¨ è§£é¢˜æ€è·¯2ï¼š å·¦ä¸­å³åˆ†åˆ«å‡†å¤‡ä¸¤ä¸ªæŒ‡é’ˆ(å…±6ä¸ªå˜é‡)ï¼Œç„¶åéå†åŸé“¾è¡¨ï¼Œæ’åºä¹‹ååˆ†åˆ«æ’å…¥ç›¸åº”ä½ç½®(è€ƒè™‘è¾¹ç•Œé—®é¢˜) 12345678910111213141516171819202122232425262728293031323334353637383940414243444546// å°†é“¾è¡¨æ”¾å…¥æ•°ç»„ï¼Œæ’åºï¼Œå†è½¬æˆé“¾è¡¨public static Node listPartition1(Node head, int pivot) &#123; if (head == null) &#123; return head; &#125; Node cur = head; int i = 0; while (cur != null) &#123; i++; cur = cur.next; &#125; Node[] nodeArr = new Node[i]; i = 0; cur = head; for (i = 0; i != nodeArr.length; i++) &#123; nodeArr[i] = cur; cur = cur.next; &#125; arrPartition(nodeArr, pivot); for (i = 1; i != nodeArr.length; i++) &#123; nodeArr[i - 1].next = nodeArr[i]; &#125; nodeArr[i - 1].next = null; return nodeArr[0];&#125;public static void arrPartition(Node[] nodeArr, int pivot) &#123; int small = -1; int big = nodeArr.length; int index = 0; while (index != big) &#123; if (nodeArr[index].value &lt; pivot) &#123; swap(nodeArr, ++small, index++); &#125; else if (nodeArr[index].value == pivot) &#123; index++; &#125; else &#123; swap(nodeArr, --big, index); &#125; &#125;&#125;public static void swap(Node[] nodeArr, int a, int b) &#123; Node tmp = nodeArr[a]; nodeArr[a] = nodeArr[b]; nodeArr[b] = tmp;&#125; 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354// å·¦ä¸­å³åˆ†åˆ«å‡†å¤‡ä¸¤ä¸ªæŒ‡é’ˆ(å…±6ä¸ªå˜é‡)ï¼Œç„¶åéå†åŸé“¾è¡¨ï¼Œæ’åºä¹‹ååˆ†åˆ«æ’å…¥ç›¸åº”ä½ç½®(è€ƒè™‘è¾¹ç•Œé—®é¢˜)public static Node listPartition2(Node head, int pivot) &#123; Node sH = null; // small head Node sT = null; // small tail Node eH = null; // equal head Node eT = null; // equal tail Node mH = null; // big head Node mT = null; // big tail Node next = null; // save next node // every node distributed to three lists while (head != null) &#123; next = head.next; head.next = null; if (head.value &lt; pivot) &#123; if (sH == null) &#123; sH = head; sT = head; &#125; else &#123; sT.next = head; sT = head; &#125; &#125; else if (head.value == pivot) &#123; if (eH == null) &#123; eH = head; eT = head; &#125; else &#123; eT.next = head; eT = head; &#125; &#125; else &#123; if (mH == null) &#123; mH = head; mT = head; &#125; else &#123; mT.next = head; mT = head; &#125; &#125; head = next; &#125; // å°äºåŒºåŸŸçš„å°¾å·´ï¼Œè¿ç­‰äºåŒºåŸŸçš„å¤´ï¼Œç­‰äºåŒºåŸŸçš„å°¾å·´è¿å¤§äºåŒºåŸŸçš„å¤´ if (sT != null) &#123; // å¦‚æœæœ‰å°äºåŒºåŸŸ sT.next = eH; eT = eT == null ? sT : eT; // ä¸‹ä¸€æ­¥ï¼Œè°å»è¿å¤§äºåŒºåŸŸçš„å¤´ï¼Œè°å°±å˜æˆeT &#125; // ä¸‹ä¸€æ­¥ï¼Œä¸€å®šæ˜¯éœ€è¦ç”¨eT å»æ¥ å¤§äºåŒºåŸŸçš„å¤´ // æœ‰ç­‰äºåŒºåŸŸï¼ŒeT -&gt; ç­‰äºåŒºåŸŸçš„å°¾ç»“ç‚¹ // æ— ç­‰äºåŒºåŸŸï¼ŒeT -&gt; å°äºåŒºåŸŸçš„å°¾ç»“ç‚¹ // eT å°½é‡ä¸ä¸ºç©ºçš„å°¾å·´èŠ‚ç‚¹ if (eT != null) &#123; // å¦‚æœå°äºåŒºåŸŸå’Œç­‰äºåŒºåŸŸï¼Œä¸æ˜¯éƒ½æ²¡æœ‰ eT.next = mH; &#125; return sH != null ? sH : (eH != null ? eH : mH);&#125; é“¾è¡¨é—­ç¯åŠç›¸äº¤é—®é¢˜å•é“¾è¡¨æŸ¥æ‰¾é—­ç¯ä½ç½®æ³¨ï¼šå•é“¾è¡¨é—­ç¯åªèƒ½æœ‰ä¸€ä¸ªç¯ï¼Œå¦‚æœäº§ç”Ÿç¯ï¼Œå¿…ç„¶ä¼šå‡ºç°é—­ç¯ è§£æ³•1ï¼šé¢å¤–ç©ºé—´è§£å†³ ç”³è¯·ä¸€ä¸ªseté›†åˆï¼Œä»å¤´èŠ‚ç‚¹éå†é“¾è¡¨ï¼Œæ¯éå†ä¸€ä¸ªå…ƒç´ å°±æŸ¥è¯¢è¯¥èŠ‚ç‚¹æ˜¯å¦åœ¨é›†åˆä¸­ï¼Œå¦‚æœæ²¡æœ‰å°±æŠŠè¯¥èŠ‚ç‚¹æ”¾è¿›å»ï¼Œå¦‚æœæœ‰ï¼Œè¯¥èŠ‚ç‚¹å°±æ˜¯ç¯ä½ç½® 1.... è§£æ³•2ï¼šæœ‰é™å‡ ä¸ªå˜é‡è§£å†³ å¿«æ…¢æŒ‡é’ˆä»å•é“¾è¡¨å¤´èŠ‚ç‚¹å¼€å§‹èµ°ï¼Œç›´è‡³ä¸¤ä¸ªèŠ‚ç‚¹ç›¸é‡ï¼Œè¯´æ˜æœ‰ç¯ï¼Œæœ€åæŒ‡å‘nullï¼Œè¯´æ˜æ— ç¯ ç›¸é‡ä¹‹åå¿«æŒ‡é’ˆå›åˆ°å¤´èŠ‚ç‚¹ï¼Œä¹‹åä¸€æ¬¡èµ°ä¸€æ­¥ï¼Œæ…¢æŒ‡é’ˆåœåœ¨åŸåœ°ï¼Œå†æ¬¡ç›¸é‡çš„ä½ç½®å³æ˜¯ç¯èŠ‚ç‚¹ä½ç½®(è®°ä½ç»“è®ºï¼Œä¸è¦é—®ä¸ºä»€ä¹ˆ) 123456789101112131415161718192021222324252627282930public static class Node &#123; public int value; public Node next; public Node(int data) &#123; this.value = data; &#125;&#125;// æ‰¾åˆ°é“¾è¡¨ç¬¬ä¸€ä¸ªå…¥ç¯èŠ‚ç‚¹ï¼Œå¦‚æœæ— ç¯ï¼Œè¿”å›nullpublic static Node getLoopNode(Node head) &#123; if (head == null || head.next == null || head.next.next == null) &#123; return null; &#125; // n1 æ…¢ n2 å¿« Node slow = head.next; // n1 -&gt; slow Node fast = head.next.next; // n2 -&gt; fast while (slow != fast) &#123; if (fast.next == null || fast.next.next == null) &#123; return null; &#125; fast = fast.next.next; slow = slow.next; &#125; // slow fast ç›¸é‡ fast = head; // n2 -&gt; walk again from head while (slow != fast) &#123; slow = slow.next; fast = fast.next; &#125; return slow;&#125; ä¸¤ä¸ªæ— ç¯é“¾è¡¨äº¤ç‚¹ä½ç½®æ³¨ï¼š å¦‚æœä¸¤ä¸ªå•å‘é“¾è¡¨ç›¸äº¤ï¼Œç›¸äº¤åé¢çš„éƒ¨åˆ†å¿…ç„¶æ˜¯å…±æœ‰çš„ï¼Œé‚£ä¹ˆä¸¤ä¸ªé“¾è¡¨æœ€åçš„é‚£ä¸ªèŠ‚ç‚¹å¿…ç„¶æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ é•¿é“¾è¡¨å…ˆèµ°ä¸¤ä¸ªé“¾è¡¨å·®å€¼çš„æ­¥æ•°ï¼Œç„¶åçŸ­é“¾è¡¨åœ¨å¼€å§‹èµ°ï¼Œä»–ä¿©ä¸€å®šä¼šåœ¨ç¬¬ä¸€ä¸ªç›¸äº¤çš„ä½ç½®ç›¸é‡ 123456789101112131415161718192021222324252627282930313233// å¦‚æœä¸¤ä¸ªé“¾è¡¨éƒ½æ— ç¯ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç›¸äº¤èŠ‚ç‚¹ï¼Œå¦‚æœä¸æƒ³äº¤ï¼Œè¿”å›nullpublic static Node noLoop(Node head1, Node head2) &#123; if (head1 == null || head2 == null) &#123; return null; &#125; Node cur1 = head1; Node cur2 = head2; int n = 0; while (cur1.next != null) &#123; n++; cur1 = cur1.next; &#125; while (cur2.next != null) &#123; n--; cur2 = cur2.next; &#125; if (cur1 != cur2) &#123; return null; &#125; // n : é“¾è¡¨1é•¿åº¦å‡å»é“¾è¡¨2é•¿åº¦çš„å€¼ cur1 = n &gt; 0 ? head1 : head2; // è°é•¿ï¼Œè°çš„å¤´å˜æˆcur1 cur2 = cur1 == head1 ? head2 : head1; // è°çŸ­ï¼Œè°çš„å¤´å˜æˆcur2 n = Math.abs(n); while (n != 0) &#123; n--; cur1 = cur1.next; &#125; while (cur1 != cur2) &#123; cur1 = cur1.next; cur2 = cur2.next; &#125; return cur1;&#125; ä¸¤æ¡æœ‰ç¯é“¾è¡¨æŸ¥æ‰¾äº¤ç‚¹åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼šå…¥ç¯èŠ‚ç‚¹å¯èƒ½æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå¯èƒ½ä¸æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚å›¾ æƒ…å†µ1ï¼šå…¥ç¯èŠ‚ç‚¹å¯èƒ½æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±æ˜¯æ±‚å•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç¯èŠ‚ç‚¹é—®é¢˜ï¼Œåªä¸è¿‡ä»ç›¸äº¤ä½ç½®å¼€å§‹èµ° æƒ…å†µ2ï¼šå¦‚æœé“¾è¡¨1åœ¨è½¬å›åˆ°è‡ªå·±çš„è¿‡ç¨‹ä¸­æ²¡æœ‰é‡åˆ°é“¾è¡¨2ï¼Œå°±è¯´æ˜æ˜¯å„è‡ªæˆç¯çš„ï¼Œç›¸äº¤èŠ‚ç‚¹è¿”å›ç©ºå°±é†’æ¥ï¼Œå¦‚æœé‡åˆ°ï¼Œå°±æ˜¯æƒ…å†µ2ï¼Œè¿”å›ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œéƒ½å¯¹ï¼Œéƒ½å±äºç¬¬ä¸€ä¸ªç›¸äº¤çš„èŠ‚ç‚¹ 123456789101112131415161718192021222324252627282930313233343536373839// ä¸¤ä¸ªæœ‰ç¯é“¾è¡¨ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç›¸äº¤èŠ‚ç‚¹ï¼Œå¦‚æœä¸æƒ³äº¤è¿”å›nullpublic static Node bothLoop(Node head1, Node loop1, Node head2, Node loop2) &#123; Node cur1 = null; Node cur2 = null; if (loop1 == loop2) &#123; cur1 = head1; cur2 = head2; int n = 0; while (cur1 != loop1) &#123; n++; cur1 = cur1.next; &#125; while (cur2 != loop2) &#123; n--; cur2 = cur2.next; &#125; cur1 = n &gt; 0 ? head1 : head2; cur2 = cur1 == head1 ? head2 : head1; n = Math.abs(n); while (n != 0) &#123; n--; cur1 = cur1.next; &#125; while (cur1 != cur2) &#123; cur1 = cur1.next; cur2 = cur2.next; &#125; return cur1; &#125; else &#123; cur1 = loop1.next; while (cur1 != loop1) &#123; if (cur1 == loop2) &#123; return loop1; &#125; cur1 = cur1.next; &#125; return null; &#125;&#125; æŸ¥æ‰¾ä¸¤ä¸ªé“¾è¡¨ç›¸äº¤èŠ‚ç‚¹æ³¨ï¼šéš¾ç‚¹ä¸ºè€ƒè™‘æ˜¯å¦æœ‰ç¯ï¼Œæœ‰ç¯é“¾è¡¨ç›¸äº¤ä»¥åŠæ— ç¯é“¾è¡¨ç›¸äº¤é—®é¢˜ï¼Œæ²¡æœ‰ç”¨åˆ°é¢å¤–æ•°æ®ç»“æ„ï¼Œåªç”¨åˆ°æœ‰é™å‡ ä¸ªå˜é‡ 1234567891011121314151617public static Node getIntersectNode(Node head1, Node head2) &#123; if (head1 == null || head2 == null) &#123; return null; &#125; // åˆ†åˆ«æ‰¾åˆ°ä¸¤ä¸ªé“¾è¡¨çš„ç¯ä½ç½® Node loop1 = getLoopNode(head1); Node loop2 = getLoopNode(head2); if (loop1 == null &amp;&amp; loop2 == null) &#123; // æ— ç¯é“¾è¡¨ç›¸äº¤é—®é¢˜ return noLoop(head1, head2); &#125; if (loop1 != null &amp;&amp; loop2 != null) &#123; // ä¸¤æ¡æœ‰ç¯é“¾è¡¨ç›¸äº¤é—®é¢˜ return bothLoop(head1, loop1, head2, loop2); &#125; return null;&#125; äºŒå‰æ ‘æ•°æ®ç»“æ„ 12345678public static class Node &#123; public int value; public Node left; public Node right; public Node(int v) &#123; value = v; &#125;&#125; äºŒå‰æ ‘éå† å…ˆåºéå†ï¼šå¤´-&gt;å·¦-&gt;å³ ä¸­åºéå†ï¼šå·¦-&gt;å¤´-&gt;å³ ååºéå†ï¼šå·¦-&gt;å³-&gt;å¤´ é€’å½’éå†äºŒå‰æ ‘éå†è¯´æ˜ é€’å½’é€šè¿‡æ‰“å°æ—¶æœºä¸åŒï¼Œå®ç°å…ˆï¼Œä¸­ï¼Œååºéå† 12345678910public static void f(Node head) &#123; if (head == null) &#123; return; &#125; // 1 å‰åº f(head.left); // 2 ä¸­åº f(head.right); // 3 ååº&#125; éé€’å½’éå†äºŒå‰æ ‘ å…ˆåºéå†(æ·±åº¦æ€§éå†) å‡†å¤‡ä¸€ä¸ªæ ˆï¼Œæ ¹èŠ‚ç‚¹å…¥æ ˆå¼¹å‡ºï¼Œæ‰“å°ï¼Œç„¶åå…ˆå‹å³ï¼Œå†å‹å·¦ å¼¹å‡ºæ‰“å°ï¼Œå…ˆå‹å³å†å‹å·¦ï¼Œå‘¨è€Œå¤å§‹ 123456789101112131415161718public static void pre(Node head) &#123; System.out.print(&quot;pre-order: &quot;); if (head != null) &#123; Stack&lt;Node&gt; stack = new Stack&lt;Node&gt;(); stack.add(head); while (!stack.isEmpty()) &#123; head = stack.pop(); System.out.print(head.value + &quot; &quot;); if (head.right != null) &#123; stack.push(head.right); &#125; if (head.left != null) &#123; stack.push(head.left); &#125; &#125; &#125; System.out.println();&#125; ååºéå† åœ¨å…ˆåºéå†çš„åŸºç¡€ä¹‹ä¸Šï¼Œå¢åŠ ä¸€ä¸ªæ”¶é›†æ ˆï¼Œå¼¹å‡ºæ¥å°±æ”¾åˆ°æ”¶é›†æ ˆä¸­(ä¸æ‰“å°)ï¼Œç„¶åå…ˆå‹å·¦ï¼Œå†å‹å³ æŠŠæ”¶é›†æ ˆä¸­çš„å…ƒç´ ä¾æ¬¡å‡ºæ ˆï¼Œæ‰“å° 1234567891011121314151617181920212223public static void pos1(Node head) &#123; System.out.print(&quot;pos-order: &quot;); if (head != null) &#123; Stack&lt;Node&gt; s1 = new Stack&lt;Node&gt;(); Stack&lt;Node&gt; s2 = new Stack&lt;Node&gt;(); s1.push(head); while (!s1.isEmpty()) &#123; head = s1.pop(); // å¤´ å³ å·¦ s2.push(head); if (head.left != null) &#123; s1.push(head.left); &#125; if (head.right != null) &#123; s1.push(head.right); &#125; &#125; // å·¦ å³ å¤´ while (!s2.isEmpty()) &#123; System.out.print(s2.pop().value + &quot; &quot;); &#125; &#125; System.out.println();&#125; ä¸­åºéå† æ•´æ£µæ ‘å·¦è¾¹ç•Œè¿›æ ˆï¼Œä¾æ¬¡å¼¹å‡ºçš„è¿‡ç¨‹ä¸­ï¼Œæ‰“å°ï¼Œå¯¹å¼¹å‡ºèŠ‚ç‚¹çš„å³æ ‘å‘¨è€Œå¤å§‹ ä¸ºä»€ä¹ˆï¼Ÿ å› ä¸ºæ•´ä¸ªæ ‘éƒ½ä¼šè¢«ä»–çš„å·¦è¾¹ç•Œåˆ†è§£æ‰ï¼Œæˆ‘ä»¬æŠŠå¤´å’Œå·¦è¾¹ç•Œå‹æ ˆï¼Œç„¶åå†å³ï¼Œå‡ºæ ˆçš„æ—¶å€™å°±æ˜¯å·¦ï¼Œå¤´ï¼Œå³ 1234567891011121314151617public static void in(Node cur) &#123; System.out.print(&quot;in-order: &quot;); if (cur != null) &#123; Stack&lt;Node&gt; stack = new Stack&lt;Node&gt;(); while (!stack.isEmpty() || cur != null) &#123; if (cur != null) &#123; stack.push(cur); cur = cur.left; &#125; else &#123; cur = stack.pop(); System.out.print(cur.value + &quot; &quot;); cur = cur.right; &#125; &#125; &#125; System.out.println();&#125; å®½åº¦éå†å®½åº¦éå†å°±æ˜¯æ¨ªç€éå†ï¼Œä¹Ÿæ˜¯å±‚æ¬¡éå† ç”¨é˜Ÿåˆ—ï¼Œå¤´èŠ‚ç‚¹æ”¾é˜Ÿåˆ—ï¼Œæ¯ä¸€æ¬¡å¼¹å‡ºå°±æ‰“å°ï¼Œç„¶åå…ˆæ”¾å·¦å†æ”¾å³ï¼Œæ¯ä¸€ä¸ªå…ƒç´ å‡ºé˜Ÿåˆ—éƒ½æ˜¯å…ˆæ”¾å·¦å†æ”¾å³ 123456789101112131415161718// ä»nodeå‡ºå‘ï¼Œè¿›è¡Œå®½åº¦ä¼˜å…ˆéå†public static void width(Node head) &#123; if (head == null) &#123; return; &#125; Queue&lt;Node&gt; queue = new LinkedList&lt;&gt;(); queue.add(head); while (!queue.isEmpty()) &#123; Node cur = queue.poll(); System.out.println(cur.value); if (cur.left != null) &#123; queue.add(cur.left); &#125; if (cur.right != null) &#123; queue.add(cur.right); &#125; &#125;&#125; æ±‚äºŒå‰æ ‘çš„æœ€å¤§å®½åº¦(éš¾)åˆ†æï¼šå®½åº¦æ€§éå†çš„æ—¶å€™è¦çŸ¥é“æ¯ä¸€å±‚çš„èŠ‚ç‚¹ä¸ªæ•° è§£ï¼šéå†æ¯ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼ŒçŸ¥é“ä»–åœ¨ç¬¬å‡ å±‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667// ç”¨hashè¡¨çš„è§£æ³•public static int maxWidthUseMap(Node head) &#123; if (head == null) &#123; return 0; &#125; Queue&lt;Node&gt; queue = new LinkedList&lt;&gt;(); queue.add(head); // key åœ¨ å“ªä¸€å±‚ï¼Œvalue HashMap&lt;Node, Integer&gt; levelMap = new HashMap&lt;&gt;(); levelMap.put(head, 1); int curLevel = 1; // å½“å‰ä½ æ­£åœ¨ç»Ÿè®¡å“ªä¸€å±‚çš„å®½åº¦ int curLevelNodes = 0; // å½“å‰å±‚curLevelå±‚ï¼Œå®½åº¦ç›®å‰æ˜¯å¤šå°‘ int max = 0; while (!queue.isEmpty()) &#123; Node cur = queue.poll(); int curNodeLevel = levelMap.get(cur); if (cur.left != null) &#123; levelMap.put(cur.left, curNodeLevel + 1); queue.add(cur.left); &#125; if (cur.right != null) &#123; levelMap.put(cur.right, curNodeLevel + 1); queue.add(cur.right); &#125; if (curNodeLevel == curLevel) &#123; curLevelNodes++; &#125; else &#123; max = Math.max(max, curLevelNodes); curLevel++; curLevelNodes = 1; &#125; &#125; max = Math.max(max, curLevelNodes); return max;&#125;// ä¸ç”¨hashè¡¨çš„æ–¹æ³• (éš¾åº¦é«˜)public static int maxWidthNoMap(Node head) &#123; if (head == null) &#123; return 0; &#125; Queue&lt;Node&gt; queue = new LinkedList&lt;&gt;(); queue.add(head); Node curEnd = head; // å½“å‰å±‚ï¼Œæœ€å³èŠ‚ç‚¹æ˜¯è° Node nextEnd = null; // ä¸‹ä¸€å±‚ï¼Œæœ€å³èŠ‚ç‚¹æ˜¯è° int max = 0; int curLevelNodes = 0; // å½“å‰å±‚çš„èŠ‚ç‚¹æ•° while (!queue.isEmpty()) &#123; Node cur = queue.poll(); if (cur.left != null) &#123; queue.add(cur.left); nextEnd = cur.left; &#125; if (cur.right != null) &#123; queue.add(cur.right); nextEnd = cur.right; &#125; curLevelNodes++; if (cur == curEnd) &#123; max = Math.max(max, curLevelNodes); curLevelNodes = 0; curEnd = nextEnd; &#125; &#125; return max;&#125; æŠ˜çº¸é—®é¢˜ ç»“æœå¯çœ‹åšå¤´èŠ‚ç‚¹æ˜¯å‡¹ï¼Œæ‰€æœ‰çš„å·¦å­æ ‘å¤´èŠ‚ç‚¹éƒ½æ˜¯å‡¹ï¼Œæ‰€æœ‰å³å­æ ‘å¤´è‚©ç‚¹éƒ½æ˜¯å‡¸çš„äºŒå‰æ ‘ ä¸­åºéå†å³å¯æ‰“å°å‡ºä»ä¸Šåˆ°ä¸‹çš„æ‰€æœ‰ç»“æ„ 12345678910111213141516public static void main(String[] args) &#123; int N = 4; process(1, N, true);&#125;// è¿™ä¸ªèŠ‚ç‚¹åœ¨ç¬¬iå±‚ï¼Œä¸€å…±æœ‰Nå±‚ï¼ŒNå›ºå®šä¸å˜çš„// è¿™ä¸ªèŠ‚ç‚¹å¦‚æœæ˜¯å‡¹çš„è¯ï¼Œdown = T// è¿™ä¸ªèŠ‚ç‚¹å¦‚æœæ˜¯å‡¸çš„è¯ï¼Œdown = F// å‡½æ•°çš„åŠŸèƒ½ï¼šä¸­åºæ‰“å°ä»¥ä½ æƒ³è±¡çš„èŠ‚ç‚¹ä¸ºå¤´çš„æ•´æ£µæ ‘ï¼public static void process(int i, int N, boolean down) &#123; if (i &gt; N) &#123; return; &#125; process(i + 1, N, true); System.out.print(down ? &quot;å‡¹ &quot; : &quot;å‡¸ &quot;); process(i + 1, N, false);&#125; æœç´¢äºŒå‰æ ‘(é€’å½’å¥—è·¯) é¢˜ç›®ï¼šå¦‚ä½•åˆ¤æ–­ä¸€é¢—äºŒå‰æ ‘æ˜¯æœç´¢äºŒå‰æ ‘ï¼Ÿ æœç´¢äºŒå‰æ ‘çš„ç‰¹ç‚¹ï¼šä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå·¦å­æ ‘çš„èŠ‚ç‚¹ä¸€å®šæ¯”å®ƒå°ï¼Œå³å­æ ‘çš„èŠ‚ç‚¹ä¸€å®šæ¯”å®ƒå¤§ è§£é¢˜ï¼š ä¸­åºéå†ä¸€å®šæ˜¯å‡åºï¼Œå¦‚æœæŸä¸ªä½ç½®æœ‰é™åºï¼Œä¸€å®šä¸æ˜¯æœç´¢äºŒå‰æ ‘ é€’å½’å¥—è·¯é¢˜è§£ :å‘æˆ‘å·¦æ ‘è¦ä¿¡æ¯ï¼Œå³æ ‘è¦ä¿¡æ¯ï¼Œå·¦æ ‘å¿…é¡»æ˜¯æœç´¢äºŒå‰æ ‘ä¸”å·¦æ ‘æœ€å¤§å€¼å°äºæˆ‘ï¼Œå³æ ‘æ˜¯æœç´¢äºŒå‰æ ‘å¹¶ä¸”æœ€å°å€¼å¤§äºæˆ‘ï¼›å·¦æ ‘ä¿¡æ¯ï¼š1.æ˜¯å¦æ˜¯æœç´¢äºŒå‰æ ‘ï¼Œ2.æœ€å¤§å€¼ï¼Œ3.æœ€å°å€¼ï¼›å³æ ‘ä¹Ÿæ˜¯ æ³¨æ„ï¼šé€’å½’å¥—è·¯ï¼Œå¯ä»¥è§£å†³ä¸€åˆ‡æ ‘å½¢DP é—®é¢˜ï¼Œæ— éæ˜¯å¯èƒ½æ€§çš„ç½—åˆ—æœ‰éš¾åº¦ 12345678910111213141516171819202122232425262728293031323334// è§£æ³•1ï¼š é¢å¤–å¼•å…¥æ•°ç»„// èŠ‚ç‚¹public static class Node &#123; public int value; public Node left; public Node right; public Node(int data) &#123; this.value = data; &#125;&#125;// ä¸­åºéå†åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œç„¶ååˆ¤æ–­æ•°ç»„æ˜¯ä¸æ˜¯å‡åºpublic static boolean isBST1(Node head) &#123; if (head == null) &#123; return true; &#125; ArrayList&lt;Node&gt; arr = new ArrayList&lt;&gt;(); in(head, arr); for (int i = 1; i &lt; arr.size(); i++) &#123; if (arr.get(i).value &lt;= arr.get(i - 1).value) &#123; return false; &#125; &#125; return true;&#125;// ä¸­åºéå†public static void in(Node head, ArrayList&lt;Node&gt; arr) &#123; if (head == null) &#123; return; &#125; in(head.left, arr); arr.add(head); in(head.right, arr);&#125; 12345678910111213141516171819// è§£æ³•2ï¼šé€’å½’æ–¹å¼public static int preValue = Integer.MIN_VALUE;public static boolean checkBST(Node head) &#123; if (head == null) &#123; return true; &#125; boolean checkLeft = checkBST(head.left); if (!checkLeft) &#123; return false; &#125; // ä¸­åºæ‰“å°çš„æ—¶æœºï¼Œæ¢æˆäº†ä¸­åºæ¯”è¾ƒçš„æ—¶æœº if (head.value &lt;= preValue) &#123; return false; &#125; else &#123; preValue = head.value; &#125; return checkBST(head.right);&#125; 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253// è§£æ³•3ï¼šé€’å½’å¥—è·¯/** * é€’å½’è¿”å›å€¼ */public static class Info &#123; public boolean isBST; // æ˜¯å¦æ˜¯æœç´¢äºŒå‰æ ‘ public int max; // æœ€å¤§å€¼ public int min; // æœ€å°å€¼ public Info(boolean i, int ma, int mi) &#123; isBST = i; max = ma; min = mi; &#125;&#125;public static Info process(Node x) &#123; if (x == null) &#123; return null; &#125; Info leftInfo = process(x.left); Info rightInfo = process(x.right); int min = x.value; int max = x.value; // æœ€å°å€¼å’Œæœ€å¤§å€¼å°±æ˜¯æˆ‘å½“å‰èŠ‚ç‚¹çš„å€¼å’Œå®ƒæ¯”è¾ƒå¾—å‡ºçš„æœ€å°å€¼å’Œæœ€å¤§å€¼ if (leftInfo != null) &#123; min = Math.min(min, leftInfo.min); max = Math.max(max, leftInfo.max); &#125; if (rightInfo != null) &#123; min = Math.min(min, rightInfo.min); max = Math.max(max, rightInfo.max); &#125; // æ˜¯å¦æ˜¯æœç´¢äºŒå‰æ ‘ boolean isBST = true; // å·¦è¾¹æœ‰ä¿¡æ¯å¹¶ä¸”å·¦è¾¹ä¸æ˜¯æœç´¢äºŒå‰æ ‘ if (leftInfo != null &amp;&amp; !leftInfo.isBST) &#123; isBST = false; &#125; if (rightInfo != null &amp;&amp; !rightInfo.isBST) &#123; isBST = false; &#125; // å·¦è¾¹æœ‰ä¿¡æ¯ï¼Œä½†æ˜¯å·¦è¾¹çš„æœ€å¤§å€¼å¤§äºç­‰äºæˆ‘çš„å€¼ if (leftInfo != null &amp;&amp; leftInfo.max &gt;= x.value) &#123; isBST = false; &#125; // å³è¾¹æœ‰ä¿¡æ¯ï¼Œå³è¾¹çš„æœ€å°å€¼å°äºç­‰äºæˆ‘å½“å‰å€¼ if (rightInfo != null &amp;&amp; rightInfo.min &lt;= x.value) &#123; isBST = false; &#125; return new Info(isBST, max, min);&#125; å®Œå…¨äºŒå‰æ ‘ å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªäºŒå‰æ ‘æ˜¯å®Œå…¨äºŒå‰æ ‘ å®Œå…¨äºŒå‰æ ‘ï¼šä¸€é¢—äºŒå‰æ ‘ä»å·¦åˆ°å³æ˜¯ä¾æ¬¡å˜æ»¡çš„ï¼Œå³ä½¿ä¸æ»¡ï¼Œä¹Ÿæ˜¯å˜æ»¡çš„æ ·å­ è§£é¢˜ï¼šäºŒå‰æ ‘å®½åº¦éå†ï¼Œ1.ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å¦‚æœæœ‰æœ‰èŠ‚ç‚¹ï¼Œæ²¡å·¦èŠ‚ç‚¹ï¼Œfalseï¼›2.åœ¨ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸è¿è§„æƒ…å†µï¼Œå¦‚æœé‡åˆ°ç¬¬ä¸€ä¸ªå·¦å³ä¸¤ä¸ªèŠ‚ç‚¹ä¸åŒå…¨æƒ…å†µï¼Œæ¥ä¸‹æ¥é‡åˆ°çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œå¿…é¡»æ˜¯å¶å­èŠ‚ç‚¹ 1234567891011121314151617181920212223242526272829303132public static boolean isCBT(Node head) &#123; if (head == null) &#123; return true; &#125; LinkedList&lt;Node&gt; queue = new LinkedList&lt;&gt;(); // æ˜¯å¦é‡åˆ°è¿‡å·¦å³ä¸¤ä¸ªå­©å­ä¸åŒå…¨çš„èŠ‚ç‚¹ boolean leaf = false; Node l = null; Node r = null; queue.add(head); while (!queue.isEmpty()) &#123; head = queue.poll(); l = head.left; r = head.right; // å¦‚æœé‡åˆ°äº†ä¸åŒå…¨çš„èŠ‚ç‚¹ä¹‹åï¼Œåˆå‘ç°å½“å‰èŠ‚ç‚¹ä¸æ˜¯å¶èŠ‚ç‚¹ if ((leaf &amp;&amp; (l != null || r != null)) || (l == null &amp;&amp; r != null)) &#123; return false; &#125; if (l != null) &#123; queue.add(l); &#125; if (r != null) &#123; queue.add(r); &#125; // é‡åˆ°å·¦å³ä¸¤ä¸ªèŠ‚ç‚¹ä¸åŒå…¨çš„æƒ…å†µï¼Œä¿®æ”¹æ ‡è®° if (l == null || r == null) &#123; leaf = true; &#125; &#125; return true;&#125; å¹³è¡¡äºŒå‰æ ‘ å¦‚ä½•åˆ¤æ–­ä¸€æ£µæ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘ å¹³è¡¡äºŒå‰æ ‘ç‰¹æ€§ï¼šå¯¹äºä»»ä½•ä¸€ä¸ªå­æ ‘æ¥è¯´ï¼Œå·¦æ ‘çš„é«˜åº¦å’Œå³æ ‘çš„é«˜åº¦å·®ï¼Œéƒ½ä¸è¶…è¿‡1 è§£å†³æ€è·¯ï¼šå‡è®¾æˆ‘å¯ä»¥å‘æˆ‘çš„å·¦æ ‘è¦ä¿¡æ¯ï¼Œå¯ä»¥å‘å³æ ‘è¦ä¿¡æ¯ï¼Œå¦‚æœæˆ‘æ•´æ£µæ ‘æ˜¯å¹³è¡¡äºŒå‰æ ‘ï¼Œæˆ‘å·¦æ ‘å¾—æ˜¯å¹³çš„ï¼Œå³æ ‘å¾—æ˜¯å¹³çš„ï¼Œå¯¹äºXèŠ‚ç‚¹æ¥è¯´ï¼Œå·¦æ ‘-å³æ ‘é«˜åº¦å·®&lt;=1ï¼›æˆ‘å‘å·¦æ ‘è¦ä¿¡æ¯ï¼š1.æ˜¯å¦æ˜¯å¹³çš„ï¼›2.é«˜åº¦æ˜¯å¤šå°‘ï¼Œå³æ ‘è¦ä¿¡æ¯ï¼š1.æ˜¯å¦æ˜¯å¹³çš„ï¼›2.é«˜åº¦æ˜¯å¤šå°‘ 12345678910111213141516171819202122232425262728293031323334/** * è¿”å›å€¼ä¿¡æ¯ */public static class Info &#123; public boolean isBalanced; public int height; public Info(boolean i, int h) &#123; isBalanced = i; height = h; &#125;&#125;public static Info process(Node x) &#123; if (x == null) &#123; return new Info(true, 0); &#125; Info leftInfo = process(x.left); Info rightInfo = process(x.right); // xä¸ºå¤´çš„èŠ‚ç‚¹çš„é«˜åº¦ï¼šå·¦æ ‘å’Œå³æ ‘è¾ƒå¤§çš„é‚£ä¸ªé«˜åº¦å†åŠ ä¸Šæˆ‘è‡ªå·±(+1) int height = Math.max(leftInfo.height, rightInfo.height) + 1; // æ˜¯å¦æ˜¯å¹³è¡¡æ ‘ï¼šæˆ‘å·¦æ ‘å¾—æ˜¯å¹³è¡¡ï¼Œå³æ ‘å¾—æ˜¯å¹³è¡¡æ ‘ï¼Œå¹¶ä¸”æˆ‘å·¦æ ‘å’Œå³æ ‘çš„é«˜åº¦å·®çš„ç»å¯¹å€¼å¾—å°äº2 boolean isBalanced = true; if (!leftInfo.isBalanced) &#123; isBalanced = false; &#125; if (!rightInfo.isBalanced) &#123; isBalanced = false; &#125; if (Math.abs(leftInfo.height - rightInfo.height) &gt; 1) &#123; isBalanced = false; &#125; return new Info(isBalanced, height);&#125; æ»¡äºŒå‰æ ‘ å¦‚ä½•åˆ¤æ–­ä¸€æ£µæ ‘æ˜¯æ»¡äºŒå‰æ ‘ æ ‘æœ€å¤§æ·±åº¦Lï¼ŒèŠ‚ç‚¹ä¸ªæ•°Nï¼Œæ»¡è¶³N=2(Læ¬¡æ–¹)-1 è§£æ³•(é€’å½’å¥—è·¯)ï¼šå…ˆæ±‚äºŒå‰æ ‘æœ€å¤§æ·±åº¦Lï¼Œå†æ±‚èŠ‚ç‚¹ä¸ªæ•°Nï¼Œæ»¡è¶³N=2(Læ¬¡æ–¹)-1 12345678910111213141516171819202122232425262728293031323334// æ»¡äºŒå‰æ ‘è§£æ³•ï¼šé€’å½’å¥—è·¯/** * è¿”å›å€¼ä¿¡æ¯ */public static class Info &#123; public int height; public int nodes; public Info(int h, int n) &#123; height = h; nodes = n; &#125;&#125;public static boolean isFull(Node head) &#123; if (head == null) &#123; return true; &#125; Info all = process(head); // N=2(Læ¬¡æ–¹)-1 return (1 &lt;&lt; all.height) - 1 == all.nodes;&#125;public static Info process(Node head) &#123; if (head == null) &#123; return new Info(0, 0); &#125; Info leftInfo = process(head.left); Info rightInfo = process(head.right); // é«˜åº¦ç­‰äºå·¦æ ‘å’Œå³æ ‘æœ€é«˜çš„é«˜åº¦+1 int height = Math.max(leftInfo.height, rightInfo.height) + 1; // æ€»ä¸ªæ•°ç­‰äºå·¦è¾¹çš„ä¸ªæ•°åŠ ä¸Šå³è¾¹çš„ä¸ªæ•°åŠ 1 int nodes = leftInfo.nodes + rightInfo.nodes + 1; return new Info(height, nodes);&#125; äºŒå‰æ ‘æœ€ä½å…¬å…±ç¥–å…ˆ ç»™å®šä¸¤ä¸ªäºŒå‰æ ‘èŠ‚ç‚¹node1å’Œnode2ï¼Œæ‰¾åˆ°ä»–ä»¬çš„æœ€ä½å…¬å…±ç¥–å…ˆèŠ‚ç‚¹ è§£æ³•1ï¼šéå†æ•´æ£µæ ‘ï¼ŒæŠŠæ‰€æœ‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹éƒ½ç»´æŠ¤åˆ°ä¸€ä¸ªMapä¸­ï¼Œç„¶åæ‰¾åˆ°node1çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹ç»´æŠ¤åˆ°setä¸­ï¼Œå†éå†node2çš„æ‰€æœ‰çš„çˆ¶ï¼Œç¬¬ä¸€ä¸ªåœ¨setä¸­é‡åˆ°çš„èŠ‚ç‚¹å°±æ˜¯æœ€ä½å…¬å…±ç¥–å…ˆ 1234567891011121314151617181920212223242526272829303132333435// è§£æ³•1public static Node lca(Node head, Node o1, Node o2) &#123; if (head == null) &#123; return null; &#125; HashMap&lt;Node, Node&gt; parentMap = new HashMap&lt;&gt;(); parentMap.put(head, null); fillParentMap(head, parentMap); HashSet&lt;Node&gt; set = new HashSet&lt;&gt;(); Node cur = o1; set.add(cur); // åªæœ‰å¤´èŠ‚ç‚¹æ‰ç­‰äºè‡ªå·±çš„çˆ¶ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹ä¸ç­‰äºè‡ªå·±çš„çˆ¶ï¼Œå°±å¯ä»¥å¾€ä¸Šèµ° while (null != parentMap.get(cur)) &#123; cur = parentMap.get(cur); set.add(cur); &#125; // o1å¾€ä¸Šæ‰€æœ‰èŠ‚ç‚¹éƒ½åœ¨è¿™ä¸ªseté‡Œé¢ï¼Œåªæœ‰æœ€åˆçš„headä¸åœ¨é‡Œé¢ cur = o2; while (!set.contains(cur)) &#123; cur = parentMap.get(cur); &#125; return cur;&#125;// ç»´æŠ¤æ•´æ£µæ ‘çš„æ‰€æœ‰çˆ¶èŠ‚ç‚¹åˆ°Mapä¸­private static void fillParentMap(Node head, HashMap&lt;Node, Node&gt; fatherMap) &#123; if (head.left != null) &#123; fatherMap.put(head.left, head); fillParentMap(head.left, fatherMap); &#125; if (head.right != null) &#123; fatherMap.put(head.right, head); fillParentMap(head.right, fatherMap); &#125;&#125; è§£æ³•2(éå¸¸æŠ½è±¡)ï¼šå¯èƒ½çš„æƒ…å†µæœ‰1ï¼šnode1å’Œnode2äº’ä¸ºå…¬å…±ç¥–å…ˆï¼›2ï¼šnode1å’Œnode2ä¸äº’ä¸ºå…¬å…±ç¥–å…ˆï¼› 1234567891011121314/** * è§£æ³•2ï¼šå¯èƒ½çš„æƒ…å†µæœ‰1ï¼šnode1å’Œnode2äº’ä¸ºå…¬å…±ç¥–å…ˆï¼›2ï¼šnode1å’Œnode2ä¸äº’ä¸ºå…¬å…±ç¥–å…ˆï¼› */public static Node lowestCommonAncestor(Node head, Node o1, Node o2) &#123; if (head == null || head == o1 || head == o2) &#123; return head; &#125; Node left = lowestCommonAncestor(head.left, o1, o2); Node right = lowestCommonAncestor(head.right, o1, o2); if (left != null &amp;&amp; right != null) &#123; return head; &#125; return left != null ? left : right;&#125; å›¾ å¸¸è§çš„è¡¨ç¤ºå›¾çš„æ–¹æ³•ï¼šä¸´æ¥è¡¨æ³•ï¼Œå’Œä¸´æ¥çŸ©é˜µæ³•ï¼Œæ•°ç»„ç­‰ åšæ¨¡æ¿ï¼Œç„¶åæŠŠæ‰€æœ‰çš„å›¾çš„é—®é¢˜è½¬åŒ–ä¸ºè‡ªå·±ç†Ÿæ‚‰çš„æ•°æ®ç»“æ„ï¼Œå¸¦ç€æ¨¡æ¿ä¸Šè€ƒåœº å›¾çš„å®½åº¦ä¼˜å…ˆéå†çº¦ç‘Ÿå¤«åœ†ç¯é—®é¢˜é€†æ³¢å…°è®¡ç®—å™¨ å®ç°ä¸€ä¸ªè®¡ç®—å™¨ï¼Œåªæœ‰åŠ å‡ä¹˜é™¤æ³•ï¼Œæ²¡æœ‰æ‹¬å·ï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¦‚10+2+3*5 è§£é¢˜ï¼šè¡¨è¾¾å¼è½¬åŒ–ä¸ºåç¼€è¡¨è¾¾å¼ï¼ˆé€†æ³¢å…°è¡¨è¾¾å¼ï¼‰ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125// è§£é¢˜public static void main(String[] args) &#123; String str = &quot;10+2+3*5&quot;; // è¡¨è¾¾å¼è½¬æ¢ä¸ºæ“ä½œæ•°å’Œæ“ä½œç¬¦çš„ä¸­ç¼€è¡¨è¾¾å¼æ•°ç»„ String[] strArr = changeStrArr(str); // ä¸­ç¼€è¡¨è¾¾å¼è½¬åŒ–ä¸ºåç¼€è¡¨è¾¾å¼ List&lt;String&gt; polandList = polandNotation(strArr); System.out.println(polandList); // åç¼€è¡¨è¾¾å¼è®¡ç®— System.out.println(calculate(polandList));&#125;/** * å­—ç¬¦ä¸²è½¬æˆä¸­ç¼€çš„æ•°ç»„ * åªæœ‰åŠ å‡ä¹˜é™¤ï¼Œæ²¡æœ‰æ‰©å· */private static String[] changeStrArr(String str) &#123; StringBuilder stringBuilder = new StringBuilder(); for (char c : str.toCharArray()) &#123; if (&quot;+-*/&quot;.contains(String.valueOf(c))) &#123; stringBuilder.append(&quot;;&quot;); stringBuilder.append(c); stringBuilder.append(&quot;;&quot;); &#125; else &#123; stringBuilder.append(c); &#125; &#125; return stringBuilder.toString().split(&quot;;&quot;);&#125;/** * ä¸­ç¼€è¡¨è¾¾å¼è½¬åŒ–ä¸ºåç¼€è¡¨è¾¾å¼ * 1.åˆå§‹åŒ–ä¸¤ä¸ªæ ˆï¼Œè¿ç®—ç¬¦æ ˆs1å’Œå‚¨å­˜ä¸­é—´ç»“æœçš„æ ˆs2 * 2.ä»å·¦åˆ°å³æ‰«æä¸­ç¼€è¡¨è¾¾å¼ * 3.é‡åˆ°æ“ä½œæ•°ï¼Œå…¥æ ˆs2 * 4.é‡åˆ°è¿ç®—ç¬¦ï¼Œæ¯”è¾ƒå…¶ä¸s1æ ˆé¡¶è¿ç®—ç¬¦çš„ä¼˜å…ˆçº§ï¼š * (1).å¦‚æœs1ä¸ºç©ºï¼Œæˆ–è€…æ ˆé¡¶è¿ç®—ç¬¦ä¸ºå·¦æ‹¬å·&quot;(&quot;,ç›´æ¥å°†è¿ç®—ç¬¦å…¥æ ˆï¼› * (2).å¦åˆ™ï¼Œè‹¥ä¼˜å…ˆçº§æ¯”æ ˆé¡¶è¿ç®—ç¬¦é«˜ï¼Œä¹Ÿå°†è¿ç®—ç¬¦å…¥æ ˆs1; * (3).å¦åˆ™ï¼Œå°†s1æ ˆé¡¶è¿ç®—ç¬¦å¼¹å‡ºå…¥æ ˆs2ä¸­ï¼Œå†æ¬¡è½¬åˆ°(4-1) ä¸s1ä¸­æ–°çš„æ ˆé¡¶è¿ç®—ç¬¦æ¯”è¾ƒï¼› * æœ¬æ–¹æ³•åªè€ƒè™‘åˆ°åŠ å‡ä¹˜é™¤æ“ä½œï¼Œä¸è€ƒè™‘æ‰©å· */private static List&lt;String&gt; polandNotation(String[] str) &#123; List&lt;String&gt; s2 = new ArrayList&lt;&gt;(); Stack&lt;String&gt; s1 = new Stack&lt;&gt;(); for (String itm : str) &#123; // é‡åˆ°æ“ä½œæ•°ï¼Œç›´æ¥å…¥æ ˆs2 if (itm.matches(&quot;\\\\d+&quot;)) &#123; s2.add(itm); &#125; else &#123; // å¦‚æœæ ˆä¸ä¸ºç©ºï¼Œå¹¶ä¸”æ ˆé¡¶ä¼˜å…ˆçº§æ¯”æˆ‘ç›®å‰è¿ç®—ç¬¦ä¼˜å…ˆçº§é«˜ï¼Œå°±æŠŠæ ˆé¡¶è¿ç®—ç¬¦å¦‚s2ï¼Œç„¶åå§å½“å‰è¿ç®—ç¬¦å¦‚s1 while (!s1.isEmpty() &amp;&amp; Operation.getValue(s1.peek()) &gt;= Operation.getValue(itm)) &#123; s2.add(s1.pop()); &#125; s1.push(itm); &#125; &#125; while (!s1.isEmpty()) &#123; s2.add(s1.pop()); &#125; return s2;&#125;/** * è¿ç®—ç¬¦æ¯”è¾ƒ */private static class Operation &#123; private static int ADD = 1; private static int SUB = 1; private static int MUL = 2; private static int DIV = 2; public static int getValue(String operation) &#123; int result = 0; switch (operation) &#123; case &quot;+&quot;: result = ADD; break; case &quot;-&quot;: result = SUB; break; case &quot;*&quot;: result = MUL; break; case &quot;/&quot;: result = DIV; break; default: break; &#125; return result; &#125;&#125;/** * é€†æ³¢å…°è¡¨è¾¾å¼è®¡ç®— * 1.å®šä¹‰ä¸€ä¸ªæ ˆï¼ŒåŒ¹é…åˆ°éè¿ç®—ç¬¦å°±å…¥æ ˆ * 2.é‡åˆ°è¿ç®—ç¬¦å°±æŠŠæ ˆé¡¶ä¸¤ä¸ªæ•°å­—å‡ºæ ˆï¼Œç”¨åå‡ºæ ˆçš„æ•°å’Œå…ˆå‡ºæ ˆçš„æ•°åšè¿ç®—ï¼ŒæŠŠè¿ç®—ç»“æœå†å…¥æ ˆ * 3.ç›´åˆ°æœ€åï¼Œæ ˆé¡¶ç»“æœå³ä¸ºè®¡ç®—ç»“æœ */private static int calculate(List&lt;String&gt; polandList) &#123; Stack&lt;String&gt; stack = new Stack&lt;&gt;(); for (String itm : polandList) &#123; // åŒ¹é…çš„æ˜¯å¤šä½æ•° if (itm.matches(&quot;\\\\d+&quot;)) &#123; stack.push(itm); &#125; else &#123; // å¼¹å‡ºä¸¤ä¸ªæ•°ï¼Œå¹¶è¿ç®—ï¼Œå†å…¥æ ˆ int num2 = Integer.parseInt(stack.pop()); int num1 = Integer.parseInt(stack.pop()); int res = 0; if (itm.equals(&quot;+&quot;)) &#123; res = num1 + num2; &#125; else if (itm.equals(&quot;-&quot;)) &#123; res = num1 - num2; &#125; else if (itm.equals(&quot;*&quot;)) &#123; res = num1 * num2; &#125; else if (itm.equals(&quot;/&quot;)) &#123; res = num1 / num2; &#125; else &#123; throw new RuntimeException(&quot;è¿ç®—ç¬¦æœ‰è¯¯&quot;); &#125; stack.push(String.valueOf(res)); &#125; &#125; return Integer.parseInt(stack.pop());&#125; å‰ç¼€æ ‘1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495// å‰ç¼€æ ‘æ•°æ®ç»“æ„public static class Node1 &#123; public int pass; public int end; public Node1[] nexts; // char tmp = &#x27;b&#x27; (tmp - &#x27;a&#x27;) public Node1() &#123; pass = 0; end = 0; // 0 a // 1 b // 2 c // .. .. // 25 z // nexts[i] == null iæ–¹å‘çš„è·¯ä¸å­˜åœ¨ // nexts[i] != null iæ–¹å‘çš„è·¯å­˜åœ¨ nexts = new Node1[26]; &#125;&#125;// æ·»åŠ å…ƒç´ public void insert(String word) &#123; if (word == null) &#123; return; &#125; char[] str = word.toCharArray(); Node1 node = root; node.pass++; int path = 0; for (int i = 0; i &lt; str.length; i++) &#123; // ä»å·¦å¾€å³éå†å­—ç¬¦ path = str[i] - &#x27;a&#x27;; // ç”±å­—ç¬¦ï¼Œå¯¹åº”æˆèµ°å‘å“ªæ¡è·¯ if (node.nexts[path] == null) &#123; node.nexts[path] = new Node1(); &#125; node = node.nexts[path]; node.pass++; &#125; node.end++;&#125;// wordè¿™ä¸ªå•è¯ä¹‹å‰åŠ å…¥è¿‡å‡ æ¬¡public int search(String word) &#123; if (word == null) &#123; return 0; &#125; char[] chs = word.toCharArray(); Node1 node = root; int index = 0; for (int i = 0; i &lt; chs.length; i++) &#123; index = chs[i] - &#x27;a&#x27;; if (node.nexts[index] == null) &#123; return 0; &#125; node = node.nexts[index]; &#125; return node.end;&#125;// æ‰€æœ‰åŠ å…¥çš„å­—ç¬¦ä¸²ä¸­ï¼Œæœ‰å‡ ä¸ªæ˜¯ä»¥preè¿™ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå‰ç¼€çš„public int prefixNumber(String pre) &#123; if (pre == null) &#123; return 0; &#125; char[] chs = pre.toCharArray(); Node1 node = root; int index = 0; for (int i = 0; i &lt; chs.length; i++) &#123; index = chs[i] - &#x27;a&#x27;; if (node.nexts[index] == null) &#123; return 0; &#125; node = node.nexts[index]; &#125; return node.pass;&#125;// åˆ é™¤public void delete(String word) &#123; if (search(word) != 0) &#123; char[] chs = word.toCharArray(); Node1 node = root; node.pass--; int path = 0; for (int i = 0; i &lt; chs.length; i++) &#123; path = chs[i] - &#x27;a&#x27;; if (--node.nexts[path].pass == 0) &#123; node.nexts[path] = null; return; &#125; node = node.nexts[path]; &#125; node.end--; &#125;&#125; è´ªå¿ƒç®—æ³•åœ¨æŸä¸€ä¸ªæ ‡å‡†ä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘æœ€æ»¡è¶³æ ‡å‡†çš„æ ·æœ¬ï¼Œæœ€åè€ƒè™‘æœ€ä¸æ»¡è¶³æ ‡å‡†çš„æ ·æœ¬ï¼Œæœ€ç»ˆå¾—åˆ°ä¸€ä¸ªç­”æ¡ˆçš„ç®—æ³•ï¼Œå«åšè´ªå¿ƒç®—æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ä»æ•´ä½“æœ€ä¼˜ä¸ŠåŠ ä»¥è€ƒè™‘ï¼Œæ‰€åšå‡ºçš„æ˜¯æŸç§æ„ä¹‰ä¸Šçš„å±€éƒ¨æœ€ä¼˜è§£ã€‚ ä¼šè®®å®¤å ç”¨é—®é¢˜é—®é¢˜ï¼šåªæœ‰ä¸€ä¸ªä¼šè®®å®¤ï¼Œå¤šä¸ªä¼šè®®å ç”¨ä¼šè®®å®¤çš„æ—¶é—´æœ‰å†²çªï¼Œå¦‚ä½•è®©ä¼šè®®å®¤è¿›è¡Œçš„ä¼šè®®æœ€å¤šï¼Œè¿”å›æœ€å¤šçš„ä¼šè®®åœºæ¬¡ è§£ï¼šå“ªä¸ªä¼šè®®ç»“æŸæ—¶é—´æ—©ï¼Œå°±ä¼˜å…ˆå®‰æ’ï¼Œç„¶åæ¥ä¸‹æ¥ç»§ç»­æ‰¾ä¸‹ä¸€ä¸ªä¼šè®®ç»“æŸæ—¶é—´æ—©çš„ä¼šè®® 1234567891011121314151617181920212223242526272829303132// ä¼šè®®å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´public static class Program &#123; public int start; public int end; public Program(int start, int end) &#123; this.start = start; this.end = end; &#125;&#125;// æ¯”è¾ƒå™¨public static class ProgramComparator implements Comparator&lt;Program&gt; &#123; @Override public int compare(Program o1, Program o2) &#123; return o1.end - o2.end; &#125;&#125;// ä¼šè®®çš„å¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´ï¼Œéƒ½æ˜¯æ•°å€¼ï¼Œä¸ä¼š &lt; 0public static int bestArrange2(Program[] programs) &#123; Arrays.sort(programs, new ProgramComparator()); int timeLine = 0; int result = 0; // ä¾æ¬¡éå†æ¯ä¸€ä¸ªä¼šè®®ï¼Œç»“æŸæ—¶é—´æ—©çš„ä¼šè®®å…ˆéå† for (int i = 0; i &lt; programs.length; i++) &#123; if (timeLine &lt;= programs[i].start) &#123; result++; timeLine = programs[i].end; &#125; &#125; return result;&#125; å…«çš‡åé—®é¢˜å¤šçº¿ç¨‹ç›¸å…³ä¸‰ä¸ªçº¿ç¨‹äº¤æ›¿æ‰“å° ä¸‰ä¸ªçº¿ç¨‹äº¤æ›¿æ‰“å°ï¼Œ1çº¿ç¨‹æ‰“å°1ï¼›2çº¿ç¨‹æ‰“å°2ï¼›3çº¿ç¨‹æ‰“å°3ï¼›1çº¿ç¨‹æ‰“å°4â€¦â€¦ä¸€ç›´æ‰“å°åˆ°100 è§£é¢˜æ–¹å¼ç”±å¾ˆå¤šï¼Œæ— éå°±æ˜¯æ¶‰åŠåˆ°çº¿ç¨‹é€šä¿¡é—®é¢˜ä»¥åŠä¿®æ”¹å…±äº«å˜é‡é—®é¢˜ é¢˜è§£1ï¼šä¸åŠ é”ï¼Œåˆ©ç”¨çº¿ç¨‹å¯è§æ€§ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051public class ThreadPrint &#123; private static volatile int i = 0; private static volatile int flag = 0; public static void main(String[] args) &#123; Thread thread1 = new Thread(new Thread1()); Thread thread2 = new Thread(new Thread2()); Thread thread3 = new Thread(new Thread3()); thread1.start(); thread2.start(); thread3.start(); &#125; public static class Thread1 implements Runnable &#123; public void run() &#123; while (i &lt;= 100) &#123; if (flag == 0) &#123; System.out.println(&quot;t1=&quot; + i); i++; flag = 1; &#125; &#125; &#125; &#125; public static class Thread2 implements Runnable &#123; public void run() &#123; while (i &lt;= 100) &#123; if (flag == 1) &#123; System.out.println(&quot;t2=&quot; + i); i++; flag = 2; &#125; &#125; &#125; &#125; public static class Thread3 implements Runnable &#123; public void run() &#123; while (i &lt;= 100) &#123; if (flag == 2) &#123; System.out.println(&quot;t3=&quot; + i); i++; flag = 0; &#125; &#125; &#125; &#125;&#125; é¢˜è§£2ï¼šLockSupport å®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142public class ThreadPrint2 &#123; private static int number = 1; private static Thread thread1, thread2,thread3; public static void main(String[] args) &#123; thread1 = new Thread(ThreadPrint2::thread1, &quot;thread1&quot;); thread2 = new Thread(ThreadPrint2::thread2, &quot;thread2&quot;); thread3 = new Thread(ThreadPrint2::thread3, &quot;thread3&quot;); thread1.start(); thread2.start(); thread3.start(); &#125; public static void thread1() &#123; while (ThreadPrint2.number &lt;= 100) &#123; System.out.println(&quot;thread1:&quot; + ThreadPrint2.number); ThreadPrint2.number++; LockSupport.unpark(thread2); LockSupport.park(); &#125; &#125; public static void thread2() &#123; while (ThreadPrint2.number &lt;= 100) &#123; LockSupport.park(); System.out.println(&quot;thread2:&quot; + ThreadPrint2.number); ThreadPrint2.number++; LockSupport.unpark(thread3); &#125; &#125; public static void thread3() &#123; while (ThreadPrint2.number &lt;= 100) &#123; LockSupport.park(); System.out.println(&quot;thread3:&quot; + ThreadPrint2.number); ThreadPrint2.number++; LockSupport.unpark(thread1); &#125; &#125;&#125; é¢˜è§£3ï¼šç»å…¸å®ç° å®ç°wait-&gt;notifyAll 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162public class ThreadPrint3 &#123; private static int count = 1; public static void main(String[] args) &#123; Object lock = new Object(); new Thread(() -&gt; &#123; try &#123; synchronized (lock) &#123; while (count &lt;= 100) &#123; if (count % 3 == 1) &#123; System.out.println(Thread.currentThread().getName() + &quot;---&gt;&quot; + count); count++; &#125; lock.notifyAll(); lock.wait(); &#125; lock.notifyAll(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;, &quot;T1&quot;).start(); new Thread(() -&gt; &#123; try &#123; synchronized (lock) &#123; while (count &lt;= 100) &#123; if (count % 3 == 2) &#123; System.out.println(Thread.currentThread().getName() + &quot;---&gt;&quot; + count); count++; &#125; lock.notifyAll(); lock.wait(); &#125; lock.notifyAll(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;, &quot;T2&quot;).start(); new Thread(() -&gt; &#123; try &#123; synchronized (lock) &#123; while (count &lt;= 100) &#123; if (count % 3 == 0) &#123; System.out.println(Thread.currentThread().getName() + &quot;---&gt;&quot; + count); count++; &#125; lock.notifyAll(); lock.wait(); &#125; lock.notifyAll(); &#125; &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125;, &quot;T3&quot;).start(); &#125;&#125; é¢˜è§£4ï¼šLockå®ç° 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263public class ThreadPrint4 &#123; private static int cnt = 0; public static void main(String[] args) &#123; Lock lock = new ReentrantLock(); Condition c1 = lock.newCondition(); Condition c2 = lock.newCondition(); Condition c3 = lock.newCondition(); new Thread(() -&gt; &#123; lock.lock(); try &#123; while (cnt &lt;= 100 &amp;&amp; cnt % 3 == 0) &#123; System.out.println(Thread.currentThread().getName() + &quot;----&gt;&quot; + cnt); cnt++; c2.signal(); c1.await(); &#125; c3.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;, &quot;T1&quot;).start(); new Thread(() -&gt; &#123; lock.lock(); try &#123; while (cnt &lt;= 100 &amp;&amp; cnt % 3 == 1) &#123; System.out.println(Thread.currentThread().getName() + &quot;----&gt;&quot; + cnt); cnt++; c3.signal(); c2.await(); &#125; c1.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;, &quot;T2&quot;).start(); new Thread(() -&gt; &#123; lock.lock(); try &#123; while (cnt &lt;= 100 &amp;&amp; cnt % 3 == 2) &#123; System.out.println(Thread.currentThread().getName() + &quot;----&gt;&quot; + cnt); cnt++; c1.signal(); c3.await(); &#125; c2.signal(); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; finally &#123; lock.unlock(); &#125; &#125;, &quot;T3&quot;).start(); &#125;&#125; å…¶ä»–ç®—æ³•é¢˜","categories":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zhangyong3214.github.io/categories/%E9%9D%A2%E8%AF%95/"}],"tags":[{"name":"åç«¯æŠ€æœ¯","slug":"åç«¯æŠ€æœ¯","permalink":"https://zhangyong3214.github.io/tags/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/"}]},{"title":"Dockeræ“ä½œç¬”è®°-ä»å°ç™½åˆ°å…¥é—¨","slug":"è½¯ä»¶å·¥å…·/Dockeræ“ä½œç¬”è®°-ä»å°ç™½åˆ°å…¥é—¨","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/Dockeræ“ä½œç¬”è®°-ä»å°ç™½åˆ°å…¥é—¨/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/Docker%E6%93%8D%E4%BD%9C%E7%AC%94%E8%AE%B0-%E4%BB%8E%E5%B0%8F%E7%99%BD%E5%88%B0%E5%85%A5%E9%97%A8/","excerpt":"1ã€Dockerå®‰è£…centos ä¸ºä¾‹ï¼šæŸ¥çœ‹ç‰ˆæœ¬ï¼šcat /etc/redhat-release å‚è€ƒç½‘å€ 121.å…ˆå®‰è£…gccï¼šyum -y install gcc 2.æŸ¥çœ‹ç‰ˆæœ¬ï¼šgcc -v å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ…","text":"1ã€Dockerå®‰è£…centos ä¸ºä¾‹ï¼šæŸ¥çœ‹ç‰ˆæœ¬ï¼šcat /etc/redhat-release å‚è€ƒç½‘å€ 121.å…ˆå®‰è£…gccï¼šyum -y install gcc 2.æŸ¥çœ‹ç‰ˆæœ¬ï¼šgcc -v å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ… 1yum install -y yum-utils device-mapper-persistent-data lvm2 1.1ã€é˜¿é‡ŒåŠ é€Ÿï¼š1yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo æŸ¥çœ‹é…ç½®ï¼š vi /etc/yum.repos.d/docker-ce.repo æ›´æ–°è½¯ä»¶åŒ…ï¼š yum makecache fast å®‰è£…dockerï¼š yum install docker-ce docker-ce-cli containerd.io é…ç½®æ–‡ä»¶ä½ç½®ï¼š /etc/sysconfig/docker å¯åŠ¨dockerï¼š systemctl start docker è®¾ç½®å¼€æœºå¯åŠ¨ï¼š systemctl enable docker æŸ¥çœ‹dockerå¯åŠ¨è¿›ç¨‹ï¼š ps -ef|grep docker æŸ¥çœ‹dockerç‰ˆæœ¬ï¼š docker version docker info 1.2ã€ä¸‹è½½é•œåƒ1234docker pull mysql:5.7 docker pull rabbitmq:management ï¼ˆå¸¦ç®¡ç†å°çš„MQï¼‰docker pull zookeeper:latest docker pull redis:rc-buster é•œåƒæœç´¢åœ°å€ é•œåƒåŠ é€Ÿåœ°å€ 1.3ã€æƒé™é—®é¢˜è§£å†³dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šé»˜è®¤èµ‹äºˆåå­—ä¸ºdockerçš„ç”¨æˆ·ç»„è¯»å†™Unix socketçš„æƒé™ï¼Œå› æ­¤åªè¦åˆ›å»ºdockerç”¨æˆ·ç»„ï¼Œå¹¶å°†å½“å‰ç”¨æˆ·åŠ å…¥åˆ°dockerç”¨æˆ·ç»„ä¸­ï¼Œé‚£ä¹ˆå½“å‰ç”¨æˆ·å°±æœ‰æƒé™è®¿é—®Unix socketäº†ï¼Œè¿›è€Œä¹Ÿå°±å¯ä»¥æ‰§è¡Œdockerç›¸å…³å‘½ä»¤ æ·»åŠ dockerç”¨æˆ·ç»„ sudo groupadd docker å°†ç™»é™†ç”¨æˆ·åŠ å…¥åˆ°dockerç”¨æˆ·ç»„ä¸­ sudo gpasswd -a $USER docker æ›´æ–°ç”¨æˆ·ç»„ newgrp docker æµ‹è¯•dockerå‘½ä»¤æ˜¯å¦å¯ä»¥ä½¿ç”¨sudoæ­£å¸¸ä½¿ç”¨ docker ps 2ã€é•œåƒæ“ä½œ æŸ¥çœ‹é•œåƒï¼šdocker images å±•ç¤ºæ‰€æœ‰æ‰€æœ‰é•œåƒï¼ˆåŒ…å«ä¸­é—´é•œåƒå±‚ï¼‰ï¼šdocker images -a æŸ¥è¯¢é•œåƒï¼šdocker search é•œåƒåå­— åˆ é™¤é•œåƒï¼šdocker rmi é•œåƒid 3ã€å®¹å™¨æ“ä½œ å¯åŠ¨mysqlï¼š docker run -p 3306:3306 --name mysql01 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.7 å¯åŠ¨rabitmqï¼š docker run -d -p 5672:5672 -p 15672:15672 --name myrabitmq é•œåƒid å¯åŠ¨redisï¼š docker run -d -p 6379:6379 --name myredis é•œåƒid å¯åŠ¨zookeeperï¼š docker run --name zk01 -p 2181:2181 --restart always -d é•œåƒid å¯åŠ¨nacosï¼š docker run --name nacos-2.0.1 -e MODE=standalone -p 8849:8848 -d nacos/nacos-server:2.0.1 å¯åŠ¨kibanaï¼š docker run -d --name kibana7.7.1 --net mynet -p 5601:5601 kibana:7.7.1 Kibana åœ¨Dokerä¸­å¯åŠ¨ç›¸å…³é…ç½® 123docker exec -it kibana7.7.1 bashcd config vi kibana.yml æŸ¥çœ‹æ—¥å¿—ï¼š docker logs -f -t â€“tail 100 kibana7.7.1 æ›´æ–°å¯åŠ¨å‚æ•°ï¼š docker update â€“restart=always xxx æŸ¥çœ‹æ‰€æœ‰å®¹å™¨ï¼š docker ps -a æŸ¥çœ‹å¯åŠ¨å®¹å™¨ï¼š docker ps å¯åŠ¨å·²åœæ­¢çš„å®¹å™¨ï¼š docker start å®¹å™¨idæˆ–åå­— å…³é—­å®¹å™¨ ï¼š docker stop å®¹å™¨id å–æ¶ˆå®¹å™¨å¼€æœºå¯åŠ¨ï¼š docker update --restart=no å®¹å™¨ID å¼ºåˆ¶å…³é—­ï¼š docker kill å®¹å™¨id åˆ é™¤å·²åœæ­¢å®¹å™¨ ï¼š docker rm å®¹å™¨id åˆ é™¤æ²¡æœ‰åœæ­¢å®¹å™¨ï¼š docker rm -f å®¹å™¨id è¿›å…¥å®¹å™¨å†…éƒ¨ï¼š docker exec -it ç¨‹åºid /bin/bash exit å…³é—­å®¹å™¨é€€å‡º(è‡ªæµ‹ä¸ä¼šé€€å‡º)ï¼š ctrl+p+q æŸ¥çœ‹æ—¥å¿—ï¼š docker logs -f (è¿½åŠ ) -t (åŠ å…¥æ—¶é—´æˆ³) --tail 3 (æ˜¾ç¤ºæœ€å3è¡Œ) å®¹å™¨id æŸ¥çœ‹å®¹å™¨ç»“æ„ç»†èŠ‚ï¼š docker inspect å®¹å™¨id æ‹·è´å®¹å™¨ä¸­çš„æ–‡ä»¶ï¼š docker cp å®¹å™¨id:æ–‡ä»¶è·¯å¾„ è¦æ‹·è´åˆ°çš„è·¯å¾„ æäº¤è‡ªå·±çš„dockeré•œåƒï¼š docker commit -a=&quot;lgd&quot; -m=&quot;mysql-lgd&quot; 243baa0ea2a7 ligoudan/lgd-mysql:1.0","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"Gitç¬”è®°-å¸¸ç”¨å‘½ä»¤ä»¥åŠæ—¥å¸¸æ“ä½œæŠ€å·§æ±‡æ€»","slug":"è½¯ä»¶å·¥å…·/gitç¬”è®°","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/gitç¬”è®°/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/git%E7%AC%94%E8%AE%B0/","excerpt":"1ã€ä¸ºGité…ç½®ä»£ç†ï¼ˆè§£å†³å›½å†…è¿æ¥gitæ…¢é—®é¢˜ï¼‰ç›¸å…³æ–‡ç« ï¼šè§£å†³gitæ— æ³•cloneæç¤º443ä»¥åŠé…ç½®gitä»£ç†æ–¹æ³• 12345678# æ·»åŠ å½“å‰ä»“åº“é…ç½®ï¼šgit config --local http.proxy &quot;127.0.0.1:1087&quot; # åˆ é™¤å½“å‰ä»“åº“é…ç½®ï¼šgit config --unset --local http.proxy# æ·»åŠ å…¨å±€é…ç½®ï¼šgit config --global http.proxy &quot;127.0.0.1:1087&quot; # åˆ é™¤å…¨å±€é…ç½®ï¼šgit config --unset --global http.proxy","text":"1ã€ä¸ºGité…ç½®ä»£ç†ï¼ˆè§£å†³å›½å†…è¿æ¥gitæ…¢é—®é¢˜ï¼‰ç›¸å…³æ–‡ç« ï¼šè§£å†³gitæ— æ³•cloneæç¤º443ä»¥åŠé…ç½®gitä»£ç†æ–¹æ³• 12345678# æ·»åŠ å½“å‰ä»“åº“é…ç½®ï¼šgit config --local http.proxy &quot;127.0.0.1:1087&quot; # åˆ é™¤å½“å‰ä»“åº“é…ç½®ï¼šgit config --unset --local http.proxy# æ·»åŠ å…¨å±€é…ç½®ï¼šgit config --global http.proxy &quot;127.0.0.1:1087&quot; # åˆ é™¤å…¨å±€é…ç½®ï¼šgit config --unset --global http.proxy æ³¨ï¼šæ·»åŠ ç›¸å…³é…ç½®ä¹Ÿå¯ä»¥åˆ°æœ¬åœ°ä»“åº“å¯¹åº”çš„ç›®å½•ï¼Œä¿®æ”¹.gitæ–‡ä»¶å¤¹é‡Œé¢çš„configæ–‡ä»¶ï¼Œå¦‚ä¸‹å›¾ï¼Œæˆ‘çš„æœ¬åœ°çš„1087ç«¯å£æ˜¯æˆ‘çš„ç§‘å­¦ä¸Šç½‘åœ°å€ config é…ç½®æœ‰systemçº§åˆ« globalï¼ˆç”¨æˆ·çº§åˆ«ï¼‰ å’Œlocalï¼ˆå½“å‰ä»“åº“ï¼‰ä¸‰ä¸ª è®¾ç½®å…ˆä»system-ã€‹global-ã€‹local åº•å±‚é…ç½®ä¼šè¦†ç›–é¡¶å±‚é…ç½® åˆ†åˆ«ä½¿ç”¨â€“system/global/local å¯ä»¥å®šä½åˆ°é…ç½®æ–‡ä»¶ æŸ¥çœ‹ç³»ç»Ÿconfig 1git config --system --list æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼ˆglobalï¼‰é…ç½® 1git config --global --list æŸ¥çœ‹å½“å‰ä»“åº“é…ç½®ä¿¡æ¯ 1git config --local --list","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"IDEAå¸¸ç”¨å¿«æ·é”®(Macç‰ˆ)","slug":"è½¯ä»¶å·¥å…·/IDEAå¸¸ç”¨å¿«æ·é”®","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/IDEAå¸¸ç”¨å¿«æ·é”®/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/IDEA%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/","excerpt":"","text":"Macé”®ç›˜ç¬¦å·å’Œä¿®é¥°é”®è¯´æ˜ âŒ˜ Command â‡§ Shift âŒ¥ Option âŒƒ Control â†©ï¸ Return/Enter âŒ« Delete âŒ¦ å‘å‰åˆ é™¤é”®ï¼ˆFn+Deleteï¼‰ â†‘ ä¸Šç®­å¤´ â†“ ä¸‹ç®­å¤´ â† å·¦ç®­å¤´ â†’ å³ç®­å¤´ â‡ Page Upï¼ˆFn+â†‘ï¼‰ â‡Ÿ Page Downï¼ˆFn+â†“ï¼‰ Home Fn + â† End Fn + â†’ â‡¥ å³åˆ¶è¡¨ç¬¦ï¼ˆTabé”®ï¼‰ â‡¤ å·¦åˆ¶è¡¨ç¬¦ï¼ˆShift+Tabï¼‰ â‹ Escape (Esc) Editingï¼ˆç¼–è¾‘ï¼‰ âŒƒSpace åŸºæœ¬çš„ä»£ç è¡¥å…¨ï¼ˆè¡¥å…¨ä»»ä½•ç±»ã€æ–¹æ³•ã€å˜é‡ï¼‰ âŒƒâ‡§Space æ™ºèƒ½ä»£ç è¡¥å…¨ï¼ˆè¿‡æ»¤å™¨æ–¹æ³•åˆ—è¡¨å’Œå˜é‡çš„é¢„æœŸç±»å‹ï¼‰ âŒ˜â‡§â†© è‡ªåŠ¨ç»“æŸä»£ç ï¼Œè¡Œæœ«è‡ªåŠ¨æ·»åŠ åˆ†å· âŒ˜P æ˜¾ç¤ºæ–¹æ³•çš„å‚æ•°ä¿¡æ¯ âŒƒJ, Mid. button click å¿«é€ŸæŸ¥çœ‹æ–‡æ¡£ â‡§F1 æŸ¥çœ‹å¤–éƒ¨æ–‡æ¡£ï¼ˆåœ¨æŸäº›ä»£ç ä¸Šä¼šè§¦å‘æ‰“å¼€æµè§ˆå™¨æ˜¾ç¤ºç›¸å…³æ–‡æ¡£ï¼‰ âŒ˜+é¼ æ ‡æ”¾åœ¨ä»£ç ä¸Š æ˜¾ç¤ºä»£ç ç®€è¦ä¿¡æ¯ âŒ˜F1 åœ¨é”™è¯¯æˆ–è­¦å‘Šå¤„æ˜¾ç¤ºå…·ä½“æè¿°ä¿¡æ¯ âŒ˜N, âŒƒâ†©, âŒƒN ç”Ÿæˆä»£ç ï¼ˆgetterã€setterã€æ„é€ å‡½æ•°ã€hashCode/equals,toStringï¼‰ âŒƒO è¦†ç›–æ–¹æ³•ï¼ˆé‡å†™çˆ¶ç±»æ–¹æ³•ï¼‰ âŒƒI å®ç°æ–¹æ³•ï¼ˆå®ç°æ¥å£ä¸­çš„æ–¹æ³•ï¼‰ âŒ˜âŒ¥T åŒ…å›´ä»£ç ï¼ˆä½¿ç”¨if..else, try..catch, for, synchronizedç­‰åŒ…å›´ é€‰ä¸­çš„ä»£ç ï¼‰ âŒ˜/ æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šä¸è¡Œæ³¨é‡Š âŒ˜âŒ¥/ æ³¨é‡Š/å–æ¶ˆæ³¨é‡Šä¸å—æ³¨é‡Š âŒ¥â†‘ è¿ç»­é€‰ä¸­ä»£ç å—fa âŒ¥â†“ å‡å°‘å½“å‰é€‰ä¸­çš„ä»£ç å— âŒƒâ‡§Q æ˜¾ç¤ºä¸Šä¸‹æ–‡ä¿¡æ¯ âŒ¥â†© æ˜¾ç¤ºæ„å‘åŠ¨ä½œå’Œå¿«é€Ÿä¿®å¤ä»£ç  âŒ˜âŒ¥L æ ¼å¼åŒ–ä»£ç  âŒƒâŒ¥O ä¼˜åŒ–import âŒƒâŒ¥I è‡ªåŠ¨ç¼©è¿›çº¿ â‡¥ / â‡§â‡¥ ç¼©è¿›ä»£ç  / åç¼©è¿›ä»£ç  âŒ˜X å‰ªåˆ‡å½“å‰è¡Œæˆ–é€‰å®šçš„å—åˆ°å‰ªè´´æ¿ âŒ˜C å¤åˆ¶å½“å‰è¡Œæˆ–é€‰å®šçš„å—åˆ°å‰ªè´´æ¿ âŒ˜V ä»å‰ªè´´æ¿ç²˜è´´ âŒ˜â‡§V ä»æœ€è¿‘çš„ç¼“å†²åŒºç²˜è´´ âŒ˜D å¤åˆ¶å½“å‰è¡Œæˆ–é€‰å®šçš„å— âŒ˜âŒ« åˆ é™¤å½“å‰è¡Œæˆ–é€‰å®šçš„å—çš„è¡Œ âŒƒâ‡§J æ™ºèƒ½çš„å°†ä»£ç æ‹¼æ¥æˆä¸€è¡Œ âŒ˜â†© æ™ºèƒ½çš„æ‹†åˆ†æ‹¼æ¥çš„è¡Œ â‡§â†© å¼€å§‹æ–°çš„ä¸€è¡Œ âŒ˜â‡§U å¤§å°å†™åˆ‡æ¢ âŒ˜â‡§] / âŒ˜â‡§[ é€‰æ‹©ç›´åˆ°ä»£ç å—ç»“æŸ/å¼€å§‹ âŒ¥âŒ¦ åˆ é™¤åˆ°å•è¯çš„æœ«å°¾ï¼ˆâŒ¦é”®ä¸ºFn+Deleteï¼‰ âŒ¥âŒ« åˆ é™¤åˆ°å•è¯çš„å¼€å¤´ âŒ˜+ / âŒ˜- å±•å¼€ / æŠ˜å ä»£ç å— âŒ˜â‡§+ å±•å¼€æ‰€ä»¥ä»£ç å— âŒ˜â‡§- æŠ˜å æ‰€æœ‰ä»£ç å— âŒ˜W å…³é—­æ´»åŠ¨çš„ç¼–è¾‘å™¨é€‰é¡¹å¡ Search/Replaceï¼ˆæŸ¥è¯¢/æ›¿æ¢ï¼‰ Double â‡§ æŸ¥è¯¢ä»»ä½•ä¸œè¥¿ âŒ˜F æ–‡ä»¶å†…æŸ¥æ‰¾ âŒ˜G æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼Œå‘ä¸‹æŸ¥æ‰¾ âŒ˜â‡§G æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼Œå‘ä¸ŠæŸ¥æ‰¾ âŒ˜R æ–‡ä»¶å†…æ›¿æ¢ âŒ˜â‡§F å…¨å±€æŸ¥æ‰¾ï¼ˆæ ¹æ®è·¯å¾„ï¼‰ âŒ˜â‡§R å…¨å±€æ›¿æ¢ï¼ˆæ ¹æ®è·¯å¾„ï¼‰ âŒ˜â‡§S æŸ¥è¯¢ç»“æ„ï¼ˆUltimate Edition ç‰ˆä¸“ç”¨ï¼Œéœ€è¦åœ¨Keymapä¸­è®¾ç½®ï¼‰ âŒ˜â‡§M æ›¿æ¢ç»“æ„ï¼ˆUltimate Edition ç‰ˆä¸“ç”¨ï¼Œéœ€è¦åœ¨Keymapä¸­è®¾ç½®ï¼‰ Usage Searchï¼ˆä½¿ç”¨æŸ¥è¯¢ï¼‰ âŒ¥F7 / âŒ˜F7 åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾ç”¨æ³• / åœ¨ç±»ä¸­æŸ¥æ‰¾ç”¨æ³• âŒ˜â‡§F7 åœ¨æ–‡ä»¶ä¸­çªå‡ºæ˜¾ç¤ºçš„ç”¨æ³• âŒ˜âŒ¥F7 æ˜¾ç¤ºç”¨æ³• Compile and Runï¼ˆç¼–è¯‘å’Œè¿è¡Œï¼‰ âŒ˜F9 ç¼–è¯‘Project âŒ˜â‡§F9 ç¼–è¯‘é€‰æ‹©çš„æ–‡ä»¶ã€åŒ…æˆ–æ¨¡å— âŒƒâŒ¥R å¼¹å‡º Run çš„å¯é€‰æ‹©èœå• âŒƒâŒ¥D å¼¹å‡º Debug çš„å¯é€‰æ‹©èœå• âŒƒR è¿è¡Œ âŒƒD è°ƒè¯• âŒƒâ‡§R, âŒƒâ‡§D ä»ç¼–è¾‘å™¨è¿è¡Œä¸Šä¸‹æ–‡ç¯å¢ƒé…ç½® Debuggingï¼ˆè°ƒè¯•ï¼‰ F8 è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™ä¸è¿›å…¥å½“å‰æ–¹æ³•ä½“å†… F7 è¿›å…¥ä¸‹ä¸€æ­¥ï¼Œå¦‚æœå½“å‰è¡Œæ–­ç‚¹æ˜¯ä¸€ä¸ªæ–¹æ³•ï¼Œåˆ™è¿›å…¥å½“å‰æ–¹æ³•ä½“å†…ï¼Œå¦‚æœè¯¥ æ–¹æ³•ä½“è¿˜æœ‰æ–¹æ³•ï¼Œåˆ™ä¸ä¼šè¿›å…¥è¯¥å†…åµŒçš„æ–¹æ³•ä¸­ â‡§F7 æ™ºèƒ½æ­¥å…¥ï¼Œæ–­ç‚¹æ‰€åœ¨è¡Œä¸Šæœ‰å¤šä¸ªæ–¹æ³•è°ƒç”¨ï¼Œä¼šå¼¹å‡ºè¿›å…¥å“ªä¸ªæ–¹æ³• â‡§F8 è·³å‡º âŒ¥F9 è¿è¡Œåˆ°å…‰æ ‡å¤„ï¼Œå¦‚æœå…‰æ ‡å‰æœ‰å…¶ä»–æ–­ç‚¹ä¼šè¿›å…¥åˆ°è¯¥æ–­ç‚¹ âŒ¥F8 è®¡ç®—è¡¨è¾¾å¼ï¼ˆå¯ä»¥æ›´æ”¹å˜é‡å€¼ä½¿å…¶ç”Ÿæ•ˆï¼‰ âŒ˜âŒ¥R æ¢å¤ç¨‹åºè¿è¡Œï¼Œå¦‚æœè¯¥æ–­ç‚¹ä¸‹é¢ä»£ç è¿˜æœ‰æ–­ç‚¹åˆ™åœåœ¨ä¸‹ä¸€ä¸ªæ–­ç‚¹ä¸Š âŒ˜F8 åˆ‡æ¢æ–­ç‚¹ï¼ˆè‹¥å…‰æ ‡å½“å‰è¡Œæœ‰æ–­ç‚¹åˆ™å–æ¶ˆæ–­ç‚¹ï¼Œæ²¡æœ‰åˆ™åŠ ä¸Šæ–­ç‚¹ï¼‰ âŒ˜â‡§F8 æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯ Navigationï¼ˆå¯¼èˆªï¼‰ âŒ˜O æŸ¥æ‰¾ç±»æ–‡ä»¶ âŒ˜â‡§O æŸ¥æ‰¾æ‰€æœ‰ç±»å‹æ–‡ä»¶ã€æ‰“å¼€æ–‡ä»¶ã€æ‰“å¼€ç›®å½•ï¼Œæ‰“å¼€ç›®å½•éœ€è¦åœ¨è¾“å…¥çš„å†…å®¹å‰é¢æˆ–åé¢åŠ ä¸€ä¸ªåæ–œæ / âŒ˜âŒ¥O å‰å¾€æŒ‡å®šçš„å˜é‡ / æ–¹æ³• âŒƒâ† / âŒƒâ†’ å·¦å³åˆ‡æ¢æ‰“å¼€çš„ç¼–è¾‘tabé¡µ F12 è¿”å›åˆ°å‰ä¸€ä¸ªå·¥å…·çª—å£ â‹ ä»å·¥å…·çª—å£è¿›å…¥ä»£ç æ–‡ä»¶çª—å£ â‡§â‹ éšè—å½“å‰æˆ–æœ€åä¸€ä¸ªæ´»åŠ¨çš„çª—å£ï¼Œä¸”å…‰æ ‡è¿›å…¥ä»£ç æ–‡ä»¶çª—å£ âŒ˜â‡§F4 å…³é—­æ´»åŠ¨run/messages/find/â€¦ tab âŒ˜L åœ¨å½“å‰æ–‡ä»¶è·³è½¬åˆ°æŸä¸€è¡Œçš„æŒ‡å®šå¤„ âŒ˜E æ˜¾ç¤ºæœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶è®°å½•åˆ—è¡¨ âŒ˜âŒ¥â† / âŒ˜âŒ¥â†’ é€€å› / å‰è¿›åˆ°ä¸Šä¸€ä¸ªæ“ä½œçš„åœ°æ–¹ âŒ˜â‡§âŒ« è·³è½¬åˆ°æœ€åä¸€ä¸ªç¼–è¾‘çš„åœ°æ–¹ âŒ¥F1 æ˜¾ç¤ºå½“å‰æ–‡ä»¶é€‰æ‹©ç›®æ ‡å¼¹å‡ºå±‚ï¼Œå¼¹å‡ºå±‚ä¸­æœ‰å¾ˆå¤šç›®æ ‡å¯ä»¥è¿›è¡Œé€‰æ‹©(å¦‚åœ¨ ä»£ç ç¼–è¾‘çª—å£å¯ä»¥é€‰æ‹©æ˜¾ç¤ºè¯¥æ–‡ä»¶çš„Finder) âŒ˜B / âŒ˜ é¼ æ ‡ç‚¹å‡» è¿›å…¥å…‰æ ‡æ‰€åœ¨çš„æ–¹æ³•/å˜é‡çš„æ¥å£æˆ–æ˜¯å®šä¹‰å¤„ âŒ˜âŒ¥B è·³è½¬åˆ°å®ç°å¤„ï¼Œåœ¨æŸä¸ªè°ƒç”¨çš„æ–¹æ³•åä¸Šä½¿ç”¨ä¼šè·³åˆ°å…·ä½“çš„å®ç°å¤„ï¼Œå¯ä»¥è·³è¿‡æ¥å£ âŒ¥ Space, âŒ˜Y å¿«é€Ÿæ‰“å¼€å…‰æ ‡æ‰€åœ¨æ–¹æ³•ã€ç±»çš„å®šä¹‰ âŒƒâ‡§B è·³è½¬åˆ°ç±»å‹å£°æ˜å¤„ âŒ˜U å‰å¾€å½“å‰å…‰æ ‡æ‰€åœ¨æ–¹æ³•çš„çˆ¶ç±»çš„æ–¹æ³• / æ¥å£å®šä¹‰ âŒƒâ†“ / âŒƒâ†‘ å½“å‰å…‰æ ‡è·³è½¬åˆ°å½“å‰æ–‡ä»¶çš„å‰ä¸€ä¸ª/åä¸€ä¸ªæ–¹æ³•åä½ç½® âŒ˜] / âŒ˜[ ç§»åŠ¨å…‰æ ‡åˆ°å½“å‰æ‰€åœ¨ä»£ç çš„èŠ±æ‹¬å·å¼€å§‹/ç»“æŸä½ç½® âŒ˜F12 å¼¹å‡ºå½“å‰æ–‡ä»¶ç»“æ„å±‚ï¼Œå¯ä»¥åœ¨å¼¹å‡ºçš„å±‚ä¸Šç›´æ¥è¾“å…¥è¿›è¡Œç­›é€‰ï¼ˆå¯ç”¨äºæœç´¢ç±»ä¸­çš„æ–¹æ³•ï¼‰ âŒƒH æ˜¾ç¤ºå½“å‰ç±»çš„å±‚æ¬¡ç»“æ„ âŒ˜â‡§H æ˜¾ç¤ºæ–¹æ³•å±‚æ¬¡ç»“æ„ âŒƒâŒ¥H æ˜¾ç¤ºè°ƒç”¨å±‚æ¬¡ç»“æ„ F2 / â‡§F2 è·³è½¬åˆ°ä¸‹ä¸€ä¸ª/ä¸Šä¸€ä¸ªçªå‡ºé”™è¯¯æˆ–è­¦å‘Šçš„ä½ç½® F4 / âŒ˜â†“ ç¼–è¾‘/æŸ¥çœ‹ä»£ç æº âŒ¥ Home æ˜¾ç¤ºåˆ°å½“å‰æ–‡ä»¶çš„å¯¼èˆªæ¡ F3é€‰ä¸­æ–‡ä»¶/æ–‡ä»¶å¤¹/ä»£ç è¡Œï¼Œæ·»åŠ /å–æ¶ˆä¹¦ç­¾ âŒ¥F3 é€‰ä¸­æ–‡ä»¶/æ–‡ä»¶å¤¹/ä»£ç è¡Œï¼Œä½¿ç”¨åŠ©è®°ç¬¦æ·»åŠ /å–æ¶ˆä¹¦ç­¾ âŒƒ0â€¦âŒƒ9 å®šä½åˆ°å¯¹åº”æ•°å€¼çš„ä¹¦ç­¾ä½ç½® âŒ˜F3 æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç­¾ Refactoringï¼ˆé‡æ„ï¼‰ F5 å¤åˆ¶æ–‡ä»¶åˆ°æŒ‡å®šç›®å½• F6 ç§»åŠ¨æ–‡ä»¶åˆ°æŒ‡å®šç›®å½• âŒ˜âŒ« åœ¨æ–‡ä»¶ä¸Šä¸ºå®‰å…¨åˆ é™¤æ–‡ä»¶ï¼Œå¼¹å‡ºç¡®è®¤æ¡† â‡§F6 é‡å‘½åæ–‡ä»¶ âŒ˜F6 æ›´æ”¹ç­¾å âŒ˜âŒ¥N ä¸€è‡´æ€§ âŒ˜âŒ¥M å°†é€‰ä¸­çš„ä»£ç æå–ä¸ºæ–¹æ³• âŒ˜âŒ¥V æå–å˜é‡ âŒ˜âŒ¥F æå–å­—æ®µ âŒ˜âŒ¥C æå–å¸¸é‡ âŒ˜âŒ¥P æå–å‚æ•° VCS/Local Historyï¼ˆç‰ˆæœ¬æ§åˆ¶/æœ¬åœ°å†å²è®°å½•ï¼‰ âŒ˜K æäº¤ä»£ç åˆ°ç‰ˆæœ¬æ§åˆ¶å™¨ âŒ˜T ä»ç‰ˆæœ¬æ§åˆ¶å™¨æ›´æ–°ä»£ç  âŒ¥â‡§C æŸ¥çœ‹æœ€è¿‘çš„å˜æ›´è®°å½• âŒƒC å¿«é€Ÿå¼¹å‡ºç‰ˆæœ¬æ§åˆ¶å™¨æ“ä½œé¢æ¿ Live Templatesï¼ˆåŠ¨æ€ä»£ç æ¨¡æ¿ï¼‰ âŒ˜âŒ¥J å¼¹å‡ºæ¨¡æ¿é€‰æ‹©çª—å£ï¼Œå°†é€‰å®šçš„ä»£ç ä½¿ç”¨åŠ¨æ€æ¨¡æ¿åŒ…ä½ âŒ˜J æ’å…¥è‡ªå®šä¹‰åŠ¨æ€ä»£ç æ¨¡æ¿ Generalï¼ˆé€šç”¨ï¼‰ âŒ˜1â€¦âŒ˜9 æ‰“å¼€ç›¸åº”ç¼–å·çš„å·¥å…·çª—å£ âŒ˜S ä¿å­˜æ‰€æœ‰ âŒ˜âŒ¥Y åŒæ­¥ã€åˆ·æ–° âŒƒâŒ˜F åˆ‡æ¢å…¨å±æ¨¡å¼ âŒ˜â‡§F12 åˆ‡æ¢æœ€å¤§åŒ–ç¼–è¾‘å™¨ âŒ¥â‡§F æ·»åŠ åˆ°æ”¶è—å¤¹ âŒ¥â‡§I æ£€æŸ¥å½“å‰æ–‡ä»¶ä¸å½“å‰çš„é…ç½®æ–‡ä»¶ `Â§âŒƒ, âŒƒ``å¿«é€Ÿåˆ‡æ¢å½“å‰çš„schemeï¼ˆåˆ‡æ¢ä¸»é¢˜ã€ä»£ç æ ·å¼ç­‰ï¼‰ âŒ˜, æ‰“å¼€IDEAç³»ç»Ÿè®¾ç½® âŒ˜; æ‰“å¼€é¡¹ç›®ç»“æ„å¯¹è¯æ¡† â‡§âŒ˜A æŸ¥æ‰¾åŠ¨ä½œï¼ˆå¯è®¾ç½®ç›¸å…³é€‰é¡¹ï¼‰ âŒƒâ‡¥ ç¼–è¾‘çª—å£æ ‡ç­¾å’Œå·¥å…·çª—å£ä¹‹é—´åˆ‡æ¢ï¼ˆå¦‚æœåœ¨åˆ‡æ¢çš„è¿‡ç¨‹åŠ æŒ‰ä¸Šdeleteï¼Œåˆ™æ˜¯å…³é—­å¯¹åº”é€‰ä¸­çš„çª—å£ï¼‰ Otherï¼ˆä¸€äº›å®˜æ–¹æ–‡æ¡£ä¸Šæ²¡æœ‰ä½“ç°çš„å¿«æ·é”®ï¼‰ âŒ˜â‡§8 ç«–ç¼–è¾‘æ¨¡å¼ å¯¼èˆª âŒ˜O æŸ¥æ‰¾ç±»æ–‡ä»¶ Ctrl + N âŒ˜âŒ¥O å‰å¾€æŒ‡å®šçš„å˜é‡ / æ–¹æ³• Ctrl + Shift + Alt + N âŒƒâ† / âŒƒâ†’ å·¦å³åˆ‡æ¢æ‰“å¼€çš„ç¼–è¾‘tabé¡µ Altâ† / Altâ†’ â‹ ä»å·¥å…·çª—å£è¿›å…¥ä»£ç æ–‡ä»¶çª—å£ ESC âŒ˜L åœ¨å½“å‰æ–‡ä»¶è·³è½¬åˆ°æŸä¸€è¡Œçš„æŒ‡å®šå¤„ Ctrl + G âŒ˜E æ˜¾ç¤ºæœ€è¿‘æ‰“å¼€çš„æ–‡ä»¶è®°å½•åˆ—è¡¨ Ctrl + E âŒ˜âŒ¥â† / âŒ˜âŒ¥â†’ é€€å› / å‰è¿›åˆ°ä¸Šä¸€ä¸ªæ“ä½œçš„åœ°æ–¹ Ctrl + Alt + â† Ctrl + Alt + â†’ âŒ˜â‡§âŒ« è·³è½¬åˆ°æœ€åä¸€ä¸ªç¼–è¾‘çš„åœ°æ–¹ âŒƒH æ˜¾ç¤ºå½“å‰ç±»çš„å±‚æ¬¡ç»“æ„ Ctrl + H âŒ˜â‡§H æ˜¾ç¤ºæ–¹æ³•å±‚æ¬¡ç»“æ„ âŒƒâŒ¥H æ˜¾ç¤ºè°ƒç”¨å±‚æ¬¡ç»“æ„ F4 / âŒ˜â†“ ç¼–è¾‘/æŸ¥çœ‹ä»£ç æº âŒ˜âŒ¥U æ˜¾ç¤ºç±»UMLå›¾ âŒƒJ æŸ¥çœ‹æ³¨é‡Š ç¼–è¾‘ âŒ¥âŒ¦ åˆ é™¤åˆ°å•è¯çš„æœ«å°¾ï¼ˆâŒ¦é”®ä¸ºFn+Deleteï¼‰ âŒ¥âŒ« åˆ é™¤åˆ°å•è¯çš„å¼€å¤´ âŒ˜+ / âŒ˜- å±•å¼€ / æŠ˜å ä»£ç å— âŒ˜F1 åœ¨é”™è¯¯æˆ–è­¦å‘Šå¤„æ˜¾ç¤ºå…·ä½“æè¿°ä¿¡æ¯ âŒ˜âŒ¥L æ ¼å¼åŒ–ä»£ç  âŒƒâŒ¥O ä¼˜åŒ–import â‡§â†© å¼€å§‹æ–°çš„ä¸€è¡Œ âŒ˜â‡§â†© è‡ªåŠ¨ç»“æŸä»£ç ï¼Œè¡Œæœ«è‡ªåŠ¨æ·»åŠ åˆ†å· âŒƒI å®ç°æ–¹æ³•ï¼ˆå®ç°æ¥å£ä¸­çš„æ–¹æ³•ï¼‰ â‡§F6 é‡å‘½åæ–‡ä»¶æˆ–è€…å˜é‡ âŒ˜N, âŒƒâ†©, âŒƒN ç”Ÿæˆä»£ç ï¼ˆgetterã€setterã€æ„é€ å‡½æ•°ã€hashCode/equals,toStringï¼‰ âŒ˜P æ˜¾ç¤ºæ–¹æ³•çš„å‚æ•°ä¿¡æ¯ æŸ¥æ‰¾ Doubleâ‡§ æŸ¥æ‰¾ä»»ä½•ä¸œè¥¿ âŒ˜â‡§F å…¨å±€æŸ¥æ‰¾ï¼ˆæ ¹æ®è·¯å¾„ï¼‰ âŒ˜F æ–‡ä»¶å†…æŸ¥æ‰¾ âŒ˜G æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼Œå‘ä¸‹æŸ¥æ‰¾ âŒ˜â‡§G æŸ¥æ‰¾æ¨¡å¼ä¸‹ï¼Œå‘ä¸ŠæŸ¥æ‰¾ âŒ˜âŒ¥B è·³è½¬åˆ°æ¥å£çš„å®ç° âŒ˜U æŸ¥çœ‹æ¥å£å®šä¹‰ âŒ˜âŒ¥â† / âŒ˜âŒ¥â†’ é€€å› / å‰è¿›åˆ°ä¸Šä¸€ä¸ªæ“ä½œçš„åœ°æ–¹ âŒ˜B / âŒ˜ é¼ æ ‡ç‚¹å‡» è¿›å…¥å…‰æ ‡æ‰€åœ¨çš„æ–¹æ³•/å˜é‡çš„æ¥å£æˆ–æ˜¯å®šä¹‰å¤„ âŒƒâ‡§B è·³è½¬åˆ°ç±»å‹å£°æ˜å¤„ âŒ¥ Space, âŒ˜Y å¿«é€Ÿæ‰“å¼€å…‰æ ‡æ‰€åœ¨æ–¹æ³•ã€ç±»çš„å®šä¹‰ âŒ˜O æŸ¥æ‰¾ç±»æ–‡ä»¶ âŒ˜â‡§O æŸ¥æ‰¾æ‰€æœ‰ç±»å‹æ–‡ä»¶ã€æ‰“å¼€æ–‡ä»¶ã€æ‰“å¼€ç›®å½•ï¼Œæ‰“å¼€ç›®å½•éœ€è¦åœ¨è¾“å…¥çš„å†…å®¹å‰é¢æˆ–åé¢åŠ ä¸€ä¸ªåæ–œæ / F12 è¿”å›åˆ°å‰ä¸€ä¸ªå·¥å…·çª—å£ â‹ ä»å·¥å…·çª—å£è¿›å…¥ä»£ç æ–‡ä»¶çª—å£ â‡§â‹ éšè—å½“å‰æˆ–æœ€åä¸€ä¸ªæ´»åŠ¨çš„çª—å£ï¼Œä¸”å…‰æ ‡è¿›å…¥ä»£ç æ–‡ä»¶çª—å£ F3é€‰ä¸­æ–‡ä»¶/æ–‡ä»¶å¤¹/ä»£ç è¡Œï¼Œæ·»åŠ /å–æ¶ˆä¹¦ç­¾ âŒ¥F3 é€‰ä¸­æ–‡ä»¶/æ–‡ä»¶å¤¹/ä»£ç è¡Œï¼Œä½¿ç”¨åŠ©è®°ç¬¦æ·»åŠ /å–æ¶ˆä¹¦ç­¾ âŒƒ0â€¦âŒƒ9 å®šä½åˆ°å¯¹åº”æ•°å€¼çš„ä¹¦ç­¾ä½ç½® âŒ˜F3 æ˜¾ç¤ºæ‰€æœ‰ä¹¦ç­¾ âŒ¥F1 æ˜¾ç¤ºå½“å‰æ–‡ä»¶é€‰æ‹©ç›®æ ‡å¼¹å‡ºå±‚ï¼Œå¼¹å‡ºå±‚ä¸­æœ‰å¾ˆå¤šç›®æ ‡å¯ä»¥è¿›è¡Œé€‰æ‹©(å¦‚åœ¨ä»£ç ç¼–è¾‘çª—å£å¯ä»¥é€‰æ‹©æ˜¾ç¤ºè¯¥æ–‡ä»¶çš„Finder) âŒ˜F12 å¼¹å‡ºå½“å‰æ–‡ä»¶ç»“æ„å±‚ï¼Œå¯ä»¥åœ¨å¼¹å‡ºçš„å±‚ä¸Šç›´æ¥è¾“å…¥è¿›è¡Œç­›é€‰ï¼ˆå¯ç”¨äºæœç´¢ç±»ä¸­çš„æ–¹æ³•ï¼‰ é€šç”¨ âŒƒâŒ˜F åˆ‡æ¢å…¨å±æ¨¡å¼","categories":[{"name":"ç¬”è®°","slug":"ç¬”è®°","permalink":"https://zhangyong3214.github.io/categories/%E7%AC%94%E8%AE%B0/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"ä¸ºMacOSæ‰“é€ è‡ªå·±ç‚«é…·ç»ˆç«¯-Iterm2+oh-my-zsh","slug":"è½¯ä»¶å·¥å…·/ä¸ºMacOSæ‰“é€ è‡ªå·±ç‚«é…·ç»ˆç«¯-","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/ä¸ºMacOSæ‰“é€ è‡ªå·±ç‚«é…·ç»ˆç«¯-/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/%E4%B8%BAMacOS%E6%89%93%E9%80%A0%E8%87%AA%E5%B7%B1%E7%82%AB%E9%85%B7%E7%BB%88%E7%AB%AF-/","excerpt":"1ã€iTerm2 iTerm2 æ˜¯ä¸€æ¬¾å®Œå…¨å…è´¹ï¼Œä¸“ä¸º Mac OS ç”¨æˆ·æ‰“é€ å¤šå‘½ä»¤è¡Œåº”ç”¨ã€‚ å®‰è£…å®Œæˆåï¼Œåœ¨/binç›®å½•ä¸‹ä¼šå¤šå‡ºä¸€ä¸ªzshçš„æ–‡ä»¶ã€‚ Macç³»ç»Ÿé»˜è®¤ä½¿ç”¨dashä½œä¸ºç»ˆç«¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ä¿®æ”¹é»˜è®¤ä½¿ç”¨zshï¼šchsh -s /bin/zsh å¦‚æœæƒ³ä¿®æ”¹å›é»˜è®¤dashï¼ŒåŒæ ·ä½¿ç”¨chshå‘½ä»¤å³å¯ï¼šchsh -s /bin/bash Zsh æ˜¯ä¸€æ¬¾å¼ºå¤§çš„è™šæ‹Ÿç»ˆç«¯ï¼Œæ—¢æ˜¯ä¸€ä¸ªç³»ç»Ÿçš„è™šæ‹Ÿç»ˆç«¯ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªè„šæœ¬è¯­è¨€çš„äº¤äº’è§£æå™¨ã€‚","text":"1ã€iTerm2 iTerm2 æ˜¯ä¸€æ¬¾å®Œå…¨å…è´¹ï¼Œä¸“ä¸º Mac OS ç”¨æˆ·æ‰“é€ å¤šå‘½ä»¤è¡Œåº”ç”¨ã€‚ å®‰è£…å®Œæˆåï¼Œåœ¨/binç›®å½•ä¸‹ä¼šå¤šå‡ºä¸€ä¸ªzshçš„æ–‡ä»¶ã€‚ Macç³»ç»Ÿé»˜è®¤ä½¿ç”¨dashä½œä¸ºç»ˆç«¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤ä¿®æ”¹é»˜è®¤ä½¿ç”¨zshï¼šchsh -s /bin/zsh å¦‚æœæƒ³ä¿®æ”¹å›é»˜è®¤dashï¼ŒåŒæ ·ä½¿ç”¨chshå‘½ä»¤å³å¯ï¼šchsh -s /bin/bash Zsh æ˜¯ä¸€æ¬¾å¼ºå¤§çš„è™šæ‹Ÿç»ˆç«¯ï¼Œæ—¢æ˜¯ä¸€ä¸ªç³»ç»Ÿçš„è™šæ‹Ÿç»ˆç«¯ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºä¸€ä¸ªè„šæœ¬è¯­è¨€çš„äº¤äº’è§£æå™¨ã€‚ 1.1ã€iterm2 å®‰è£…ä¸‹è½½åœ°å€ 1.2ã€iTermæ“ä½œå¿«æ·é”® command + tï¼šæ–°å»ºçª—å£ command + dï¼šå‚ç›´åˆ†å±ï¼Œ command + shift + dï¼šæ°´å¹³åˆ†å±ã€‚ command + ] å’Œcommand + [ åœ¨æœ€è¿‘ä½¿ç”¨çš„åˆ†å±ç›´æ¥åˆ‡æ¢. command + alt + æ–¹å‘é”®ï¼šåˆ‡æ¢åˆ°æŒ‡å®šä½ç½®çš„åˆ†å±ã€‚ command + æ•°å­—ï¼šåˆ‡æ¢æ ‡ç­¾é¡µã€‚ command + æ–¹å‘é”®ï¼šæŒ‰æ–¹å‘åˆ‡æ¢æ ‡ç­¾é¡µã€‚ shift + command + sï¼šä¿å­˜å½“å‰çª—å£å¿«ç…§ã€‚ command + alt + bï¼šå¿«ç…§å›æ”¾ã€‚å¾ˆæœ‰æ„æ€çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥å¯¹ä½ çš„æ“ä½œæ ¹æ®æ—¶é—´è½´è¿›è¡Œå›æ”¾ã€‚å¯ä»¥æ‹–åŠ¨ä¸‹æ–¹çš„æ—¶é—´è½´ï¼Œä¹Ÿå¯ä»¥æŒ‰å·¦å³æ–¹å‘é”® 1.3ã€åˆ›å»ºä¸€é”®ç™»å½•æœåŠ¡å™¨1.3.1ã€ç¬¬ä¸€æ­¥ï¼šæ–°å»ºé…ç½®æ–‡ä»¶ï¼Œå†…å®¹ï¼š12345678set user ç”¨æˆ·åset host IPåœ°å€set password å¯†ç spawn ssh $user@$hostexpect &quot;*assword:*&quot;send &quot;$password\\r&quot;interactexpect eof 1.3.2ã€ç¬¬äºŒæ­¥ï¼šiTerm2é…ç½®æ·»åŠ 1expect ~/.ssh/SIT02-10.231.143.184 2ã€Oh My ZshOh My Zsh å®˜ç½‘ Oh My Zsh æ˜¯ä¸€æ¬¾ç¤¾åŒºé©±åŠ¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒåŸºäº zsh å‘½ä»¤è¡Œï¼Œæä¾›äº†ä¸»é¢˜é…ç½®ï¼Œæ’ä»¶æœºåˆ¶ï¼Œå·²ç»å†…ç½®çš„ä¾¿æ·æ“ä½œã€‚ç»™æˆ‘ä»¬ä¸€ç§å…¨æ–°çš„æ–¹å¼ä½¿ç”¨å‘½ä»¤è¡Œã€‚ 2.1ã€oh my zsh å®‰è£…2.1.1ã€æ–¹å¼11sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot; 2.1.2ã€æ–¹å¼21`sh -c &quot;$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)&quot;` 2.1.3ã€æ–¹å¼3ï¼ˆå›½å†…æ¨èä½¿ç”¨ï¼‰1sh -c &quot;$(curl -fsSL https://gitee.com/pocmon/ohmyzsh/raw/master/tools/install.sh)&quot; 2.2ã€å¸è½½oh my zsh1uninstall_on_my_zsh 2.3ã€æ›´æ¢ä¸»é¢˜12vi ~/.zshrcZSH_THEME=&quot;macovsky-ruby&quot; &quot;steeef&quot; 2.4ã€å®‰è£…è¯­æ³•é«˜äº®æ’ä»¶1234# è¿›å…¥æ–‡ä»¶å¤¹cd ~/.oh-my-zsh/custom/plugins# ä¸‹è½½æ’ä»¶git clone https://github.com/zsh-users/zsh-syntax-highlighting.git 2.5ã€è‡ªåŠ¨è¡¥å…¨æ’ä»¶1git clone https://github.com/zsh-users/zsh-autosuggestions.git 2.5.1ã€å¯ç”¨æ’ä»¶12345vi ~/.zshrcplugins=( git zsh-autosuggestions zsh-syntax-highlighting )source ~/.zshrc","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"å†›äº‹çº§åˆ«å®‰å…¨å¼ºåº¦ï¼Œå…è´¹å¯†ç ç®¡ç†å·¥å…·KeePassï¼Œæ°¸è¿œæ»´ç¥","slug":"è½¯ä»¶å·¥å…·/å…è´¹å¯†ç ç®¡ç†å·¥å…·KeePassæ°¸è¿œçš„ç¥","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/å…è´¹å¯†ç ç®¡ç†å·¥å…·KeePassæ°¸è¿œçš„ç¥/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/%E5%85%8D%E8%B4%B9%E5%AF%86%E7%A0%81%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7KeePass%E6%B0%B8%E8%BF%9C%E7%9A%84%E7%A5%9E/","excerpt":"","text":"å‰è¨€â€‹ æ¬¢è¿å¤§å®¶æ”¶çœ‹æœ¬ç¯‡æ–‡ç« å¯¹åº”Bç«™è§†é¢‘è§£è¯´ï¼šğŸ‘‰ ç‚¹æ­¤è·³è½¬Bç«™è§†é¢‘è§£è¯´æ•™ç¨‹ ğŸ‘ˆ â€‹ å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯å–œæ¬¢ç§‘æŠ€ï¼Œå–œæ¬¢åˆ†äº«ï¼Œå–œæ¬¢è½¯ä»¶ï¼Œå–œæ¬¢æŠ˜è…¾ï¼Œæœ‰æ´ç™–åˆæœ‰å¼ºè¿«ç—‡çš„ç§‘æŠ€å†œåå·¥â€”æè‹Ÿè›‹ï¼Œä»Šå¤©æˆ‘æ¥ç»™å¤§å®¶åˆ†äº«ä¸€æ¬¾å¯†ç ç®¡ç†è½¯ä»¶ï¼šKeePassã€‚ä½ æ˜¯å¦æœ‰è¿‡è¿™ç§ç»å†ï¼šå¹³å‡æ¯åŠä¸ªæœˆæˆ–è€…ä¸€ä¸ªæœˆï¼Œæˆ‘ä»¬å†ç™»å½•æŸäº›ç½‘ç«™æˆ–è€…ç™»å½•æŸäº›è´¦å·çš„æ—¶å€™ï¼Œå‘ç°æˆ‘ä»¬çš„å¯†ç è®°ä¸ä½äº†ï¼Œç”¨å¸¸ç”¨çš„å¯†ç è¯•è¿‡å‡ æ¬¡ä¹‹åï¼Œå‘ç°è¿˜æ˜¯ä¸å¯¹ï¼Œå¹²è„†ç›´æ¥ç‚¹å‡»å¿˜è®°å¯†ç ï¼Œç”¨æ‰‹æœºéªŒè¯ç æˆ–è€…é‚®ç®±éªŒè¯ç æ‰¾å›å¯†ç æ›´æ”¹æˆä¸ºæˆ‘ä»¬å¸¸ç”¨çš„å¯†ç ï¼Œå¦‚æœè¿™ä¸ªç½‘ç«™æˆ–è€…è¿™ä¸ªè´¦å·æˆ‘ä»¬å¥½ä¹…æ²¡ç™»å½•è¿‡ï¼Œç»‘å®šçš„æ‰‹æœºå·è¿˜æ˜¯æˆ‘ä¹‹å‰ç”¨è¿‡çš„æ‰‹æœºå·ï¼Œå¯èƒ½å°±å¾—é€šè¿‡ç”³è¯‰æä¾›å„ç§èµ„æ–™æ‰¾å›å¯†ç ï¼Œé‚£ç­‰å¾…ä½ çš„å°†æ˜¯å™©æ¢¦çº§åˆ«çš„æ“ä½œï¼Œå¦‚æœè¿™ä¸ªè´¦å·ä¸å¤ªé‡è¦ï¼Œæˆ‘ä¸è¦äº†ä¹Ÿå°±ç®—äº†ï¼Œå¦‚æœè¿™ä¸ªè´¦å·å¾ˆé‡è¦ï¼Œé‚£æ­¤æ—¶æ­¤åˆ»ä½ çš„å†…å¿ƒåº”è¯¥å·²ç»ä¸‡é©¬(ç¾Šé©¼)å´©è…¾äº†ã€‚æœ‰äº›äººå¯èƒ½å–œæ¬¢æŠŠå¯†ç è®°å½•åœ¨ä¸€ä¸ªç‰¹å®šçš„ç¬”è®°æœ¬ä¸Šé¢ï¼Œä½†æ˜¯å¦‚æœè¿™ä¸ªç¬”è®°æœ¬ä¸¢äº†â€¦.ä¸¢åœ¨å®¶é‡Œæ‰¾ä¸åˆ°è¿˜å¥½è¯´ï¼Œä¸‡ä¸€ä¸¢åœ¨å¤–é¢ï¼Œé‚£ä½ æ‹…å¿ƒçš„åº”è¯¥ä¸æ˜¯ä½ æœ‰å¾ˆå¤šç½‘ç«™ç™»å½•ä¸ä¸Šäº†ï¼Œè€Œæ˜¯ä½ çš„å¯†ç å¾ˆå¯èƒ½è¢«åˆ«äººçŸ¥é“äº†ï¼›è¿˜æœ‰äººå–œæ¬¢æŠŠå¯†ç è®°å½•åœ¨ç”µè„‘çš„æœ¬åœ°è®°äº‹æœ¬ï¼Œæˆ–è€…æ‰‹æœºçš„è®°äº‹æœ¬é‡Œé¢ï¼Œä½†æ˜¯è¿™åªå­˜åœ¨äºä½ ç”µè„‘æœ¬åœ°æˆ–è€…æ‰‹æœºæœ¬åœ°ï¼Œä¸‡ä¸€ç”µè„‘é‡è£…ç³»ç»Ÿï¼Œæˆ–è€…æ¢æ‰‹æœºâ€¦â€¦åˆæ˜¯ä¸ªéš¾é¢˜ï¼Œæ­¤æ—¶æ­¤åˆ»èªæ˜çš„ä½ å¯èƒ½ä¼šæƒ³ï¼Œé‚£æˆ‘æŠŠå¯†ç æ”¾åœ¨äº‘ç¬”è®°é‡Œé¢ï¼Œæˆ‘æŠŠè¿™ä¸ªç¬”è®°åœ¨åŠ ä¸ªæ‰“å¼€å¯†ç ï¼Œé‚£ä¸å°±å¥½äº†å—ï¼Ÿæ²¡é”™ï¼Œæˆ‘åœ¨è®¤è¯†KeePassä¹‹å‰ï¼Œæˆ‘å°±æ˜¯è¿™ä¹ˆåšçš„ï¼Œä½†æ˜¯ä½ æ”¾åœ¨äº‘ç¬”è®°é‡Œé¢ï¼Œåœ¨åŠ ä¸ªç¬”è®°çš„å¼€å¯å¯†ç ï¼Œè¿™ç§æƒ…å†µï¼Œä½ çš„å¯†ç å°±ä¾èµ–äº†äº‘ç¬”è®°æœåŠ¡å•†çš„æœåŠ¡å™¨ï¼Œè€Œä¸”ä½ æŠŠå¯†ç éƒ½æ”¾åˆ°äººå®¶çš„æœåŠ¡å™¨ä¸Šï¼Œä½ è§‰å¾—è¿™æ˜¯å®‰å…¨çš„å—ï¼Ÿéš¾é“ä½ çœŸçš„è®¤ä¸ºä½ åŠ äº†ä¸€ä¸ªå¼€å¯å¯†ç ï¼Œå°±æ²¡æœ‰äººèƒ½çœ‹åˆ°äº†å—ï¼Ÿä½ çš„å¼€å¯å¯†ç çš„åŠ å¯†ç®—æ³•å¯éƒ½æ˜¯äººå®¶äº‘ç¬”è®°è¿è¥å•†ç»™ä½ æä¾›çš„â€¦.. â€‹ ç°åœ¨æˆ‘å°±æ¥ç»™å¤§å®¶éš†é‡ä»‹ç»ä¸€ä¸‹ä»Šå¤©çš„ä¸»è§’ï¼ŒKeePassï¼Œå¹¶è¯¦ç»†è¯´æ˜å®ƒæ˜¯å¦‚ä½•è§£å†³æˆ‘ä»¬ä¸Šè¿°çš„è¿™äº›é—®é¢˜çš„ã€‚ç›®å‰ä¸»æµçš„å¯†ç ç®¡ç†å·¥å…·ä¸»è¦æœ‰ï¼šKeePassï¼ˆå…è´¹ å¼€æº å…¼å®¹æ€§å¼ºï¼‰ï¼ŒLastPassï¼ˆæœ€å¤§çš„ä¼˜åŠ¿æ˜¯è·¨æµè§ˆå™¨å¹³å°ï¼Œæ”¶è´¹ï¼‰ï¼Œ1Passwordï¼ˆè·¨å¹³å°ç®¡ç† ç”¨æˆ·è®¤å¯åº¦é«˜ï¼‰ï¼ŒEnpassï¼ˆæ”¯æŒå¹³å°å¤š 20æ¡å¯†ç å…è´¹ï¼‰ã€‚å¯ä»¥çœ‹å‡ºï¼Œé™¤äº†KeePassï¼Œå…¶ä»–éƒ½æ˜¯æ”¶è´¹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¯«æ— æ‚¬å¿µçš„é€‰æ‹©äº†å®ƒï¼ŒKeePassä»2003å¹´è‡³ä»Šå…·æœ‰è¿‘20å¹´çš„æ—¶é—´ï¼Œè€Œä¸”å¼€æºå…è´¹ï¼Œå¼€æºçš„å¥½å¤„å°±æ˜¯æ°‘é—´å¤§ç¥éƒ½å¯ä»¥çœ‹ä»–çš„æºä»£ç ï¼Œåªè¦å‘ç°å®‰å…¨æ¼æ´å°±å¯ä»¥å»æäº¤è¯„è®ºåšä¿®å¤ï¼Œæ‰€ä»¥å®‰å…¨çº§åˆ«æ˜¯å¯ä»¥æ”¾å¿ƒçš„ï¼Œå¦‚æœä½ æ‹…å¿ƒæœ‰å®‰å…¨é—®é¢˜æƒ³é˜…è¯»æºç ä¹Ÿå¯ä»¥å»å®˜æ–¹æŸ¥çœ‹ã€‚ æ¥ä¸‹æ¥å°±è®©æˆ‘ä»‹ç»ä¸€ä¸‹å¦‚ä½•ç”¨KeePassæ­å»ºä¸€ä¸ªå¯ä»¥å®ç°äº‘åŒæ­¥çš„å¯†ç ç®¡ç†å·¥å…·å§ã€‚ KeePassä¸‹è½½åŠä½¿ç”¨Keepaä»‹ç»â€‹ KeePassä¸ä¼šä¸Šä¼ ä½ çš„è´¦å·å¯†ç ï¼Œä½ çš„è´¦å·å¯†ç ä¿å­˜åœ¨ä½ æœ¬åœ°(æ•°æ®åº“)ï¼Œä½ åªéœ€è¦åˆ›å»ºä¸€ä¸ªå¼€å¯è¿™ä¸ªæ•°æ®åº“çš„é’¥åŒ™ï¼Œè¿™ä¸ªé’¥åŒ™éå¸¸é‡è¦ï¼Œå®ƒæ˜¯ä½ èƒ½å¦æ‰“å¼€è½¯ä»¶çš„å…³é”®ï¼Œè¿™ä¸ªé’¥åŒ™å¯ä»¥æ˜¯ä¸€ä¸²å¯†ç ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å¯ä»¥æ˜¯ä»»ä½•æ–‡ä»¶ï¼Œä¸€éƒ¨ç”µå½±ï¼Œä¸€ä¸ªwordæ–‡æ¡£ï¼Œä¸€ä¸ªtxtæ–‡æœ¬ï¼Œä¸€é¦–æ­Œç­‰ï¼Œéƒ½å¯ä»¥å½“åšå¼€å¯æ•°æ®åº“çš„å¯†é’¥æ–‡ä»¶ï¼Œæˆ–è€…æ˜¯å¯†ç åŠ æ–‡ä»¶çš„ç»„åˆçš„æ–¹å¼æ¥è®¾ç½®ä½ çš„å¼€å¯é’¥åŒ™ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€ä¸ªå®ä½“å¯†é’¥(ç±»ä¼¼äºUç›¾)ï¼Œæœ¬äººæ¨èä½¿ç”¨å¯†ç åŠ æ–‡ä»¶çš„æ–¹å¼ä½œä¸ºæ•°æ®åº“çš„å¼€å¯é’¥åŒ™ï¼Œè¿™æ ·ï¼Œå¼€å¯å¯†ç æˆ‘ä»¬å°±ä¸ç”¨è®¾ç½®çš„å¤ªå¤æ‚ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒå¼€å¯å¯†ç æ³„éœ²å¯¼è‡´æˆ‘ä»¬çš„æ•°æ®åº“æ–‡ä»¶è¢«åˆ«äººæ‹¿åˆ°ä¹‹åè¢«åˆ«äººæ‰“å¼€ï¼Œåˆ«äººèƒ½åŒæ—¶æ‹¿åˆ°å¯†ç å’Œæ–‡ä»¶ç®€ç›´å¤ªéš¾äº†ã€‚ PCç«¯å®¢æˆ·ç«¯KeePassXCâ€‹ KeePasså®˜ç½‘ï¼Œæä¾›äº†KeePassè½¯ä»¶çš„ä¸‹è½½ï¼Œå®˜æ–¹åªæä¾›äº†PCç«¯ä¸‹è½½ï¼Œä¸è¿‡è¿˜å¥½ï¼Œå¾ˆå¤šæ°‘é—´å¤§ç¥ä¹Ÿåšäº†å¾ˆå¤šæ”¯æŒKeePassçš„å®¢æˆ·ç«¯ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œå®˜æ–¹ä¹Ÿæœ‰æ¨èåˆ—è¡¨ã€‚ç”µè„‘ç«¯ï¼ˆwindowså’ŒMacå¹³å°ï¼‰ï¼Œæˆ‘æ¨èä½¿ç”¨KeePassXCï¼Œè¿™ä¹Ÿæ˜¯æ”¯æŒKeePassçš„ç”±éå®˜æ–¹å¼€å‘çš„ä¸€æ¬¾è½¯ä»¶ï¼ŒKeePasså®˜æ–¹æ¨èåˆ—è¡¨é‡Œé¢æœ‰ï¼Œä¹‹æ‰€ä»¥æ¨èå®ƒï¼Œæ˜¯å› ä¸ºä»–ç•Œé¢ç¾è§‚ï¼Œè¿˜æœ‰å¯¹åº”çš„æµè§ˆå™¨æ’ä»¶ï¼Œå¯ä»¥å®ç°å¯†ç è‡ªåŠ¨å¡«å……ã€‚å®‰å“ç«¯æˆ‘æ¨èä½¿ç”¨KeePass2Androidï¼Œè¿™æ¬¾è½¯ä»¶ä¸‹è½½éœ€è¦ä¸Šè°·æ­Œå•†åº—ï¼Œå¯èƒ½å¾—éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼Œè¿™é‡Œæˆ‘ç»™å¤§å®¶æä¾›äº†è“å¥äº‘ä¸‹è½½ï¼Œæ–¹ä¾¿å¤§å®¶ä¸‹è½½å®‰è£…ï¼Œç”±äºæœ¬äººæ²¡æœ‰è‹¹æœæ‰‹æœºï¼Œæ‰€ä»¥IPhoneç”¨æˆ·å°±éœ€è¦å°ä¼™ä¼´è‡ªå·±å»å®˜æ–¹æ¨èçš„è½¯ä»¶é‡Œé¢å¯»æ‰¾é€‚åˆè‹¹æœæ‰‹æœºçš„å®¢æˆ·ç«¯äº†(#^.^#)~ KeePassXCä½¿ç”¨ä»‹ç»ä¸‹å›¾ä¸ºæˆ‘çš„KeePassçš„å®¢æˆ·ç«¯å®‰è£…é…ç½®ä¹‹åçš„æ•ˆæœï¼Œæ€ä¹ˆæ ·ï¼Œè¿˜ä¸é”™å§~ ä¸‹è½½å®‰è£…KeePassä¹‹åï¼Œæˆ‘ä»¬éœ€è¦è®¾ç½®ä¸€ä¸‹æˆ‘ä»¬æ•°æ®åº“å­˜æ”¾çš„æœ¬åœ°ä½ç½®ï¼Œç„¶åè®¾ç½®æ•°æ®åº“å¼€å¯å¯†ç ï¼Œå¼€å¯å¯†é’¥æ–‡ä»¶ï¼Œè¿™é‡Œæˆ‘æ¨èæ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œåç¼€åéšæ„ï¼Œç„¶åç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œåœ¨é‡Œé¢è¾“å…¥ä¸€äº›æ–‡ç« ï¼Œä¾‹å¦‚ä½ å–œæ¬¢çš„è¯—è¯ä¹‹ç±»çš„ï¼Œå­—ä¹¦ä¸è¦å¤ªå¤šï¼Œå°½é‡æ§åˆ¶åœ¨1åƒå­—ä»¥å†…å°±è¡Œï¼Œé¿å…æ–‡ä»¶è¿‡å¤§ï¼Œç„¶åå§è¿™ä¸ªå¯†é’¥æ–‡ä»¶å¥½å¥½ä¿å­˜èµ·æ¥ï¼Œæˆ‘å»ºè®®ç”¨ä½ å¸¸ç”¨çš„é‚®ç®±ç»™è‡ªå·±å‘ä¸ªé‚®ä»¶ç„¶åä»¥é™„ä»¶çš„æ–¹å¼ä¿å­˜åœ¨ä½ çš„é‚®ä»¶é‡Œé¢ï¼Œè¿™æ ·ä»–å°±æ°¸è¿œä¸ä¼šä¸¢äº†ï¼Œæˆ–è€…æ”¾åˆ°ä½ çš„äº‘ç›˜ï¼ŒNASä¸Šé¢ï¼Œä¸è¦æŠŠå®ƒå’Œæ•°æ®åº“æ”¾åœ¨ä¸€èµ·ï¼ï¼ï¼å¦‚æœæ˜¯Macæœ¬æ”¯æŒæŒ‡çº¹è¯†åˆ«ï¼Œè¾“å…¥ä¸€æ¬¡å¯†ç å’Œå¯†é’¥æ–‡ä»¶ä¹‹åï¼Œä¸‹æ¬¡å°±å¯ä»¥é€šè¿‡æŒ‡çº¹æ‰“å¼€ä½ çš„æ•°æ®åº“äº†ï¼Œä½†æ˜¯è¿™ä¸ä»£è¡¨ä½ çš„å¯†ç å’Œå¯†é’¥æ–‡ä»¶å°±æ²¡ç”¨äº†ï¼ŒæŒ‡çº¹æ‰“å¼€æ•°æ®åº“çš„åŸç†å…¶å®å°±æ˜¯é€šè¿‡æŒ‡çº¹æ˜ å°„åˆ°ä½ çš„å¯†ç å’Œå¯†é’¥æ–‡ä»¶ï¼Œæ‰€ä»¥è¯´ï¼Œæ•°æ®åº“å¼€å¯å¯†ç å’Œå¯†é’¥æ–‡ä»¶å¾ˆé‡è¦ï¼Œè¿™ä¸ªä¸€å®šä¸èƒ½ä¸¢~ è¿›å…¥ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ·»åŠ åˆ†ç±»ï¼Œç„¶åæ·»åŠ è´¦å·å¯†ç ç­‰ç­‰ï¼Œå…·ä½“çš„ä½¿ç”¨æ–¹æ³•æˆ‘ä¼šå‡ºè§†é¢‘è®²è§£ï¼Œæ¬¢è¿æœ‹å‹æ¥Bç«™å…³æ³¨æˆ‘ã€‚ æµè§ˆå™¨æ’ä»¶ä½¿ç”¨(è°·æ­Œä¸ºä¾‹)æœ¬åœ°è½¯ä»¶å¼€å¯ç›¸åº”åŠŸèƒ½â€‹ åœ¨KeePassXCæ‰“å¼€è®¾ç½®-æµè§ˆå™¨é›†æˆ-å¯ç”¨æµè§ˆå™¨é›†æˆ-ç„¶åä¸ºä½ ç”¨çš„æµè§ˆå™¨å¼€å¯é›†æˆï¼ˆè§ä¸‹å›¾ï¼‰ï¼Œè¿™é‡Œå¢™è£‚å»ºè®®ä½¿ç”¨è°·æ­Œæµè§ˆå™¨ï¼Œè¿™æ˜¯æµè§ˆå™¨ä¸­çš„ç¥ã€‚å½“ç„¶ï¼Œæƒ³æˆä¸ºç¥ï¼Œéœ€è¦ç§‘å­¦ä¸Šç½‘å®‰è£…å¿…è¦çš„æ’ä»¶æ‰èƒ½å¤Ÿç»™è°·æ­Œæµè§ˆå™¨æ³¨å…¥ç¥ä¹‹çµé­‚ï¼Œä¸è¦ä¸‹è½½ä¸‹æ¥ä¹‹åè¿ä¸ªæ’ä»¶éƒ½æ²¡è£…å°±è¯´æµè§ˆå™¨ä¸è¡Œï¼Œè¡Œä¸è¡Œå¾—çœ‹ç”¨çš„äººä¼šä¸ä¼šç”¨ã€‚æ€»ä¹‹ï¼Œç§‘æŠ€å†œæ°‘å·¥é‡Œé¢åº”è¯¥æ²¡æœ‰å‡ ä¸ªäººä¸ç”¨è°·æ­Œå§~ æµè§ˆå™¨æ’ä»¶ä¸‹è½½ä½¿ç”¨â€‹ æ‰“å¼€è°·æ­Œåº”ç”¨å•†åº—ï¼ˆæ³¨ï¼šè¿™é‡Œå¯èƒ½éœ€è¦ç§‘å­¦ä¸Šç½‘ï¼‰ï¼Œæ‰¾åˆ°KeePassXCè¿™ä¸ªæ’ä»¶ï¼Œå®‰è£…ä¹‹â€¦. å®‰è£…ä¹‹åç”¨æµè§ˆå™¨æ’ä»¶é“¾æ¥æœ¬åœ°KeePassXCè½¯ä»¶ï¼Œé“¾æ¥ä¹‹åï¼Œå°±å¯ä»¥å®ç°ç½‘ç«™è´¦å·å¯†ç è‡ªåŠ¨å¡«å……äº†ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè‡ªåŠ¨å¡«å……çš„æ—¶å€™ï¼Œä¸€å®šè¦æ˜¯ä½ æœ¬åœ°æ•°æ®åº“æ‰“å¼€çš„æƒ…å†µä¸‹ï¼Œè¿™æ ·ä½ å°±å¯ä»¥å§æµè§ˆå™¨çš„è®°ä½å¯†ç åŠŸèƒ½å…³é—­äº†ï¼Œä¸è¿‡è¿™ä¸ªè‡ªåŠ¨å¡«å……åŠŸèƒ½å¹¶ä¸ä¸€å®šæ‰€æœ‰ç½‘ç«™éƒ½å¯ä»¥ï¼Œå¤§æ¦‚ç™¾åˆ†ä¹‹80çš„ç½‘ç«™éƒ½æ²¡é—®é¢˜ï¼Œè¿˜æœ‰å°±æ˜¯æƒ³è¦èƒ½å…³è”åˆ°å¡«å……é¡¹ç›®ï¼Œéœ€è¦ä½ åœ¨ä½ æ·»åŠ å¯†ç çš„æ—¶å€™ï¼ŒæŠŠå¯¹åº”çš„URLå¡«å†™æˆä¸ºç½‘ç«™çš„ç™»å½•åœ°å€æˆ–è€…ç½‘ç«™çš„å®˜ç½‘ã€‚ å®ç°æ•°æ®åº“äº‘åŒæ­¥æˆ‘ä»¬çš„æ•°æ®åº“åªå­˜åœ¨äºæˆ‘ä»¬æœ¬åœ°è‚¯å®šæ˜¯ä¸è¡Œçš„ï¼Œè¿™è·Ÿæˆ‘ç›´æ¥åœ¨æœ¬åœ°æä¸€ä¸ªè®°äº‹æœ¬ä¿å­˜å¯†ç ä¹Ÿå·®ä¸äº†å¤šå°‘ï¼Œé‡è£…ç³»ç»Ÿä¹‹åï¼Œæ•°æ®åº“ä¸¢äº†ï¼Œå°±ç›´æ¥å›åˆ°è§£æ”¾å‰äº†ï¼Œè¿™é‡Œæˆ‘å»ºè®®ä½¿ç”¨ä¸¤ç§å·¥å…·å®ç°æ•°æ®åº“äº‘åŒæ­¥åŠŸèƒ½ï¼Œç¬¬ä¸€æ¬¾æ˜¯å¾®è½¯å‡ºå“çš„OneDriveï¼Œè¿™æ¬¾äº‘ç›˜å¯ä»¥å®ç°äº‘ç›˜æ˜ å°„åˆ°æœ¬åœ°æŒ‡å®šè·¯å¾„ï¼Œè·¯å¾„ä¸­çš„æ–‡ä»¶å‘ç”Ÿæ”¹å˜ï¼Œä¼šè‡ªåŠ¨åŒæ­¥åˆ°äº‘ç«¯ï¼Œè¿™æ ·æˆ‘ä»¬æ·»åŠ æˆ–è€…ä¿®æ”¹äº†è´¦å·å¯†ç ä¹‹åï¼Œæ•°æ®åº“éƒ½ä¼šè‡ªåŠ¨åŒæ­¥åˆ°å¾®è½¯çš„OneDriveäº‘ç›˜ï¼Œè¿™æ ·æˆ‘ä»¬å°±å®ç°äº†ç”µè„‘ç«¯çš„æ•°æ®åº“äº‘åŒæ­¥ï¼Œæ‰‹æœºç«¯Keepass2Androidï¼Œä¹Ÿæ˜¯æ”¯æŒè¯»å–OneDriveäº‘ç›˜æ–‡ä»¶çš„åŠŸèƒ½çš„ï¼›ç¬¬äºŒæ¬¾åŒæ­¥å·¥å…·æ˜¯åšæœäº‘ï¼ŒåŸç†å’ŒOneDriveä¸€æ ·ï¼Œä¸è¿‡åšæœäº‘è¦å®ç°æ‰‹æœºåŒæ­¥ï¼Œéœ€è¦é€šè¿‡WebDavåŠŸèƒ½å®ç°ï¼Œåšæœäº‘æ˜¯æ”¯æŒäº‘æ–‡ä»¶è®¾ç½®æˆä¸ºWebDavæœåŠ¡çš„ï¼Œè€Œä¸”åšæœäº‘å·ç§°æ˜¯å›½å†…æœ€å®‰å…¨çš„äº‘ç›˜ï¼Œå†›å·¥çº§çš„åŠ å¯†æ–¹æ¡ˆï¼Œä½ çš„æ•°æ®åº“æ”¾åœ¨åšæœäº‘æ˜¯å®‰å…¨çš„ï¼Œå°±ç®—æœ‰äººèƒ½æ‹¿åˆ°ä½ çš„æ•°æ®åº“ï¼Œæ²¡æœ‰å¯†ç å’Œå¯†é’¥æ–‡ä»¶ï¼Œä¹Ÿæ˜¯æ‰“ä¸å¼€çš„â€¦ å°¾å£°â€‹ æ— è®ºä½¿ç”¨å“ªç§åŒæ­¥æ–¹æ¡ˆï¼Œè¿™ç§åŒæ­¥çš„æ€è·¯æ˜ç™½äº†ï¼Œä¹Ÿå¯ä»¥è¯•è¯•å…¶ä»–çš„KeePass çš„å®¢æˆ·ç«¯è½¯ä»¶ï¼Œæ–‡ç« ä¸­ä»‹ç»çš„éƒ½æ˜¯æœ¬äººè®¤ä¸ºæœ€å¥½çš„æ–¹æ¡ˆï¼Œä¹Ÿæ˜¯çˆ±æŠ˜è…¾çš„æˆ‘åœ¨å·¥ä½œä¹‹ä½™è‚äº†å¥½å‡ ä¸ªæ™šä¸Šå®šä¸‹çš„æœ€ç»ˆæ–¹æ¡ˆï¼Œä¹Ÿè¯·å¤§å®¶å¤šå¤šå…³æ³¨æˆ‘çš„ä¸ªäººåšå®¢å’ŒBç«™ï¼Œæœ‰ä»€ä¹ˆé—®é¢˜å¯ä»¥åŠ æˆ‘QQæˆ–è€…Bç«™ç•™è¨€ç§ä¿¡ç»™æˆ‘â€¦è°¢è°¢å¤§å®¶ï¼","categories":[{"name":"è½¯ä»¶åˆ†äº«","slug":"è½¯ä»¶åˆ†äº«","permalink":"https://zhangyong3214.github.io/categories/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"åè¡€æ•´ç†IDEAå¿…å¤‡æ’ä»¶(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§ï¼Œè®©æ’¸ç æ•ˆç‡æå‡1000%","slug":"è½¯ä»¶å·¥å…·/åè¡€æ•´ç†IDEAå¿…å¤‡æ’ä»¶","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.128Z","comments":true,"path":"2022/01/27/è½¯ä»¶å·¥å…·/åè¡€æ•´ç†IDEAå¿…å¤‡æ’ä»¶/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/%E5%90%90%E8%A1%80%E6%95%B4%E7%90%86IDEA%E5%BF%85%E5%A4%87%E6%8F%92%E4%BB%B6/","excerpt":"","text":"ä¿—è¯è¯´ï¼šâ€œå·¥æ¬²å–„å…¶äº‹ï¼Œå¿…å…ˆåˆ©å…¶å™¨â€ï¼Œå¥½çš„å¼€å‘å·¥å…·èƒ½è®©æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡ç¿»å€ï¼Œè€Œå¥½çš„å¼€å‘å·¥å…·åŠ ä¸Šä¼˜ç§€çš„æ’ä»¶ï¼Œèƒ½è®©æˆ‘ä»¬çš„å·¥ä½œæ•ˆç‡æå‡åå€ï¼ˆ(@^_^@)æˆ‘è¦æ‰“åä¸ªï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬åŒºåˆ«äºå…¶ä»–ç¨‹åºçŒ¿çš„å¿…å¤‡å·¥å…·ï¼Œä¸‹é¢å°±æ˜¯æˆ‘ä»åä½™å¹´å·¥ä½œä¸­æ€»ç»“å‡ºæ¥çš„å¥½ç”¨çš„ideaæ’ä»¶ï¼ˆå¥½åƒå·¥ä½œçš„å‰äº”å¹´æˆ‘ç”¨çš„éƒ½æ˜¯eclipseï¼Œå“ˆå“ˆ(â•¯&gt;Ğ´&lt;)â•¯â½Ë™Â³Ë™â¾ï¼Œè¿™ä¸é‡è¦ï¼ï¼‰ã€‚æ’ä»¶ä¸»è¦åˆ†ä¸ºï¼šä»£ç ç”Ÿæˆç±»ï¼Œæ—¥å¸¸å¼€å‘ç±»ï¼Œä¸»é¢˜ç¾åŒ–ç±»ï¼Œä»¥ä¸‹æ’ä»¶å¤§éƒ½å¯ä»¥é€šè¿‡ IDEA è‡ªå¸¦çš„æ’ä»¶ç®¡ç†ä¸­å¿ƒå®‰è£…ï¼Œå¦‚æœæœä¸åˆ°å¯ä»¥å» IDEA æ’ä»¶å®˜ç½‘ä¸‹è½½æœ¬åœ°å¯¼å…¥ã€‚æ˜Ÿå·ä»£è¡¨æˆ‘ä¸ªäººçš„æ¨èæŒ‡æ•° ã€‚ ä»£ç ç”ŸæˆLombok æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… è‡ªåŠ¨ç”Ÿæˆgetã€setæ–¹æ³• EasyCode æ¨èæŒ‡æ•°ï¼šâ˜…â˜… æ•°æ®åº“é€†å‘å·¥ç¨‹ GsonFormat æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… é€šè¿‡jsonç”Ÿæˆå®ä½“ç±» Codota æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… ä»£ç æç¤º è¯¥æ’ä»¶çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼š æ”¯æŒæ™ºèƒ½ä»£ç è‡ªåŠ¨æç¤ºï¼Œè¯¥åŠŸèƒ½å¯ä»¥å¢å¼º IDEA çš„ä»£ç æç¤ºåŠŸèƒ½ï¼› æ”¯æŒ JDK å’ŒçŸ¥åç¬¬ä¸‰æ–¹åº“çš„å‡½æ•°çš„ä½¿ç”¨æ–¹æ³•æœç´¢ï¼Œå¯ä»¥çœ‹åˆ°å…¶ä»–çŸ¥åå¼€æºé¡¹ç›®å¯¹è¯¥å‡½æ•°çš„ç”¨æ³•ã€‚ å½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡ä½¿ç”¨æŸä¸ªç±»ï¼Œå¯¹æŸä¸ªå‡½æ•°ä¸å¤Ÿç†Ÿæ‚‰æ—¶ï¼Œå¯ä»¥é€šè¿‡è¯¥æ’ä»¶æœç´¢ç›¸å…³ç”¨æ³•ï¼Œå¿«é€Ÿæ¨¡ä»¿å­¦ä¹ ï¼Œä½¿ç”¨æ–¹æ³•ï¼šå³é”®è¦æœç´¢çš„ç±»ï¼Œé€‰æ‹© Get relevant exanples GenerateAllSetter æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… å˜é‡è‡ªåŠ¨ç”Ÿæˆsetæ–¹æ³• æ’ä»¶å®˜ç½‘åœ°å€ ã€‚æˆ‘ä»¬å®šä¹‰å¥½ä» A ç±»è½¬æ¢åˆ° B ç±»çš„å‡½æ•°è½¬æ¢å‡½æ•°åï¼Œä½¿ç”¨è¿™ä¸¤ä¸ªæ’ä»¶å¯ä»¥è‡ªåŠ¨è°ƒç”¨ Getter å’Œ Setter å‡½æ•°å®è¡Œè‡ªåŠ¨è½¬æ¢ã€‚å®é™…å¼€å‘ä¸­è¿˜æœ‰ä¸€ä¸ªéå¸¸å¸¸è§çš„åœºæ™¯ï¼šæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå¯¹è±¡åï¼Œæƒ³ä¾æ¬¡è°ƒç”¨ Setter å‡½æ•°å¯¹å±æ€§èµ‹å€¼ï¼Œå¦‚æœå±æ€§è¾ƒå¤šå¾ˆå®¹æ˜“é—æ¼æˆ–è€…é‡å¤ã€‚å¯ä»¥ä½¿ç”¨GenerateAllSetter æä¾›çš„åŠŸèƒ½ï¼Œè‡ªåŠ¨è°ƒç”¨æ‰€æœ‰ Setter å‡½æ•°ï¼ˆå¯å¡«å……é»˜è®¤å€¼ï¼‰ï¼Œç„¶åè‡ªå·±å†è·Ÿè¿›å®é™…éœ€æ±‚è®¾ç½®å±æ€§å€¼ã€‚ .ignore æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… gitæäº¤æ—¶è¿‡æ»¤æ‰ä¸éœ€è¦æäº¤çš„æ–‡ä»¶ï¼Œå¾ˆæ–¹ä¾¿ï¼Œæœ‰äº›æœ¬åœ°æ–‡ä»¶æ˜¯ä¸éœ€è¦æäº¤åˆ°Gitä¸Šçš„ï¼Œæ’ä»¶ï¼šProjectViewæ¶µç›–äº†æ­¤åŠŸèƒ½ CamelCase æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… å°†ä¸æ˜¯é©¼å³°æ ¼å¼çš„åç§°ï¼Œå¿«é€Ÿè½¬æˆé©¼å³°æ ¼å¼ï¼Œå®‰è£…å¥½åï¼Œé€‰ä¸­è¦ä¿®æ”¹çš„åç§°ï¼ŒæŒ‰å¿«æ·é”®shift+alt+uã€‚ ä»£ç è§„èŒƒAlibaba Java Coding Guidelines æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šä»£ç è§„èŒƒæ’ä»¶ jclasslib bytecode viewer æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šå¯è§†åŒ–çš„å­—èŠ‚ç æŸ¥çœ‹æ’ä»¶ ä½¿ç”¨æ–¹æ³•ï¼š åœ¨ IDEA æ‰“å¼€æƒ³ç ”ç©¶çš„ç±»ï¼› ç¼–è¯‘è¯¥ç±»æˆ–è€…ç›´æ¥ç¼–è¯‘æ•´ä¸ªé¡¹ç›®ï¼ˆ å¦‚æœæƒ³ç ”ç©¶çš„ç±»åœ¨ jar åŒ…ä¸­ï¼Œæ­¤æ­¥å¯ç•¥è¿‡ï¼‰ï¼› æ‰“å¼€â€œviewâ€ èœå•ï¼Œé€‰æ‹©â€œShow Bytecode With jclasslibâ€ é€‰é¡¹ï¼› é€‰æ‹©ä¸Šè¿°èœå•é¡¹å IDEA ä¸­ä¼šå¼¹å‡º jclasslib å·¥å…·çª—å£ã€‚ é‚£ä¹ˆæœ‰è‡ªå¸¦çš„å¼ºå¤§çš„åæ±‡ç¼–å·¥å…· javap è¿˜æœ‰å¿…è¦ç”¨è¿™ä¸ªæ’ä»¶å—ï¼Ÿ è¿™ä¸ªæ’ä»¶çš„å¼ºå¤§ä¹‹å¤„åœ¨äºï¼š ä¸éœ€è¦æ•²å‘½ä»¤ï¼Œç®€å•ç›´æ¥ï¼Œåœ¨å³ä¾§æ–¹ä¾¿å’Œæºä»£ç è¿›è¡Œå¯¹æ¯”å­¦ä¹ ï¼› å­—èŠ‚ç å‘½ä»¤æ”¯æŒè¶…é“¾æ¥ï¼Œç‚¹å‡»å…¶ä¸­çš„è™šæ‹ŸæœºæŒ‡ä»¤å³å¯è·³è½¬åˆ° jvms ç›¸å…³ç« èŠ‚ï¼Œè¶…çº§æ–¹ä¾¿ã€‚ è¯¥æ’ä»¶å¯¹æˆ‘ä»¬å­¦ä¹ è™šæ‹ŸæœºæŒ‡ä»¤æœ‰æå¤§çš„å¸®åŠ©ã€‚ FindBugs æ¨èæŒ‡æ•°ï¼šâ˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šæŸ¥æ‰¾ä»£ç bug ç¨‹åºå‘˜æ€»æ˜¯æƒ³å°½å¯èƒ½åœ°é¿å…å†™ BUGï¼Œ FindBugs ä½œä¸ºé™æ€ä»£ç æ£€æŸ¥æ’ä»¶ï¼Œå¯ä»¥æ£€æŸ¥ä½ ä»£ç ä¸­çš„éšæ‚£ï¼Œå¹¶ç»™å‡ºåŸå› ã€‚ SonarLine æ¨èæŒ‡æ•°ï¼šâ˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šä»£ç è´¨é‡ç®¡ç†å·¥å…· æ—¥å¸¸å¼€å‘Translation æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šç¿»è¯‘ Jrebel æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šçƒ­éƒ¨ç½² Key Promoter X æ¨èæŒ‡æ•°ï¼šâ˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šå¿«æ·é”®æç¤º MyBatis Log Plugin æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šæ‰“å°sql MyBatisX æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šMapperè·³è½¬Dao Maven Search æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šæŸ¥è¯¢maven Maven Helper æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šä¾èµ–å…³ç³»å›¾ å®‰è£…å IDEA ä¸­æ‰“å¼€ pom.xml æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå¤šå‡ºä¸€ä¸ª â€œDependency Analyzerâ€ é€‰é¡¹å¡ã€‚ SequenceDiagram æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šæ—¶åºå›¾ SequenceDiagram å¯ä»¥æ ¹æ®ä»£ç è°ƒç”¨é“¾è·¯è‡ªåŠ¨ç”Ÿæˆæ—¶åºå›¾ï¼Œè¶…çº§èµï¼Œè¶…çº§æ¨èï¼è¿™å¯¹ç ”ç©¶æºç ï¼Œæ¢³ç†å·¥ä½œä¸­çš„ä¸šåŠ¡ä»£ç æœ‰æå¤§çš„å¸®åŠ©ï¼Œå ªç§°ç¥å™¨ã€‚å®‰è£…å®Œæˆåï¼Œåœ¨æŸä¸ªç±»çš„æŸä¸ªå‡½æ•°ä¸­ï¼Œå³é”® â€“&gt; Sequence Diagaram å³å¯è°ƒå‡ºã€‚ ä¸»é¢˜ç¾åŒ–Active power mode æ¨èæŒ‡æ•°ï¼šâ˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šæ‰“å­—ç‰¹æ•ˆ Rainbow Branckets æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šå½©è™¹æ‰©å· æ’ä»¶githubåœ°å€ ã€‚ç”±äºå¾ˆå¤šäººæ²¡æœ‰å…»æˆå¥½çš„ç¼–ç é£æ ¼ï¼Œæ²¡æœ‰éšæ‰‹ format ä»£ç çš„ä¹ æƒ¯ï¼Œç”šè‡³æœ‰äº›åŒäº‹ä¼šå†™ä»£ç è¶…è¿‡å‡ ç™¾è¡Œï¼Œé˜…è¯»èµ·æ¥å°†éå¸¸ç—›è‹¦ã€‚ç—›è‹¦çš„åŸå› ä¹‹ä¸€å°±æ˜¯æ‰¾åˆ°ä¸Šä¸‹æ–‡ï¼Œç”±äºæ‹¬å·å¤ªå¤šï¼Œä¸ç¡®å®šå½“å‰ä»£ç è¡Œæ˜¯å¦å±äºæŸä¸ªä»£ç å—ï¼Œæ­¤æ—¶è¿™ä¸ªæ’ä»¶å°±ä¼šå¸®ä¸Šå¤§å¿™ã€‚åŒå‡»é¡¶éƒ¨çš„ç±»åå¯ä»¥è·³è½¬åˆ°å¯¹åº”ç±»çš„æºç ä¸­ï¼ŒåŒå‡»è°ƒç”¨çš„å‡½æ•°åå¯ä»¥ç›´æ¥è°ƒå…¥æŸä¸ªå‡½æ•°çš„æºç ï¼Œæ€»ä¹‹éå¸¸å¼ºå¤§ã€‚ CodeGlance æ¨èæŒ‡æ•°ï¼šâ˜…â˜…â˜… æ’ä»¶åŠŸèƒ½ï¼šä»£ç è¿·ä½ å°åœ°å›¾ ç±»ä¼¼äºsublimeçš„å³ä¾§ä»£ç å°åœ°å›¾ï¼ŒCodeGlance2ä¸ºåŸç‰ˆåŠ å¼º Xcode Drak theme æ¨èæŒ‡æ•°ï¼šâ˜… æ’ä»¶åŠŸèƒ½ï¼šä¸»é¢˜ Material Theme UI æ¨èæŒ‡æ•°ï¼šâ˜… æ’ä»¶åŠŸèƒ½ï¼šå¤šç§ä¸»é¢˜ å¯¹äºå¾ˆå¤šäººè€Œè¨€ï¼Œå†™ä»£ç æ—¶ç•¥æ˜¾æ¯ç‡¥çš„ï¼Œå¦‚æœèƒ½å¤Ÿå®‰è£…è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜å°†ä¸ºå¼€å‘å·¥ä½œå¸¦æ¥äº›è®¸ä¹è¶£ã€‚IDEA æ”¯æŒå„ç§ä¸»é¢˜æ’ä»¶ï¼Œå…¶ä¸­æœ€å‡ºåçš„å½“å± Material Theme UIã€‚å®‰è£…åï¼Œå¯ä»¥ä»è¯¥æ’ä»¶å†…ç½®çš„å„ç§é£æ ¼ä¸ªé€‰æ‹©è‡ªå·±æœ€å–œæ¬¢çš„ä¸€ç§ã€‚","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"}]},{"title":"é¢è¯•çŸ¥è¯†ç‚¹æ€»ç»“","slug":"é¢è¯•åŸºåœ°/å¸¸è§é¢è¯•é¢˜","date":"2022-01-27T08:31:13.128Z","updated":"2022-01-27T08:31:13.129Z","comments":true,"path":"2022/01/27/é¢è¯•åŸºåœ°/å¸¸è§é¢è¯•é¢˜/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E9%9D%A2%E8%AF%95%E5%9F%BA%E5%9C%B0/%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98/","excerpt":"","text":"åŸºç¡€çŸ¥è¯†é¢å‘å¯¹è±¡çš„ç‰¹å¾?é¢å‘å¯¹è±¡çš„ç‰¹å¾:å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€æŠ½è±¡ã€‚ å°è£…:å°±æ˜¯æŠŠå¯¹è±¡çš„å±æ€§å’Œè¡Œä¸º(æ•°æ®)ç»“åˆä¸ºä¸€ä¸ªç‹¬ç«‹çš„æ•´ä½“ï¼Œå¹¶å°½å¯èƒ½éšè—å¯¹è±¡çš„å†… éƒ¨å®ç°ç»†èŠ‚ï¼Œå°±æ˜¯æŠŠä¸æƒ³å‘Šè¯‰æˆ–è€…ä¸è¯¥å‘Šè¯‰åˆ«äººçš„ä¸œè¥¿éšè—èµ·æ¥ï¼ŒæŠŠå¯ä»¥å‘Šè¯‰åˆ«äººçš„å…¬å¼€ï¼Œåˆ«äººåªèƒ½ç”¨æˆ‘æä¾›çš„åŠŸèƒ½å®ç°éœ€æ±‚ï¼Œè€Œä¸çŸ¥é“æ˜¯å¦‚ä½•å®ç°çš„ã€‚å¢åŠ å®‰å…¨æ€§ã€‚ ç»§æ‰¿:å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ•°æ®å±æ€§å’Œè¡Œä¸ºï¼Œå¹¶èƒ½æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ‰©å±•å‡ºæ–°çš„è¡Œä¸ºï¼Œæé«˜äº†ä»£ ç çš„å¤ç”¨æ€§ã€‚ å¤šæ€:æŒ‡å…è®¸ä¸åŒçš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯åšå‡ºç›¸åº”ã€‚å³åŒä¸€æ¶ˆæ¯å¯ä»¥æ ¹æ®å‘é€å¯¹è±¡çš„ä¸åŒè€Œé‡‡ ç”¨å¤šç§ä¸åŒçš„è¡Œä¸ºæ–¹å¼(å‘é€æ¶ˆæ¯å°±æ˜¯å‡½æ•°è°ƒç”¨)ã€‚å°è£…å’Œç»§æ‰¿å‡ ä¹éƒ½æ˜¯ä¸ºå¤šæ€è€Œå‡†å¤‡ çš„ï¼Œåœ¨æ‰§è¡ŒæœŸé—´åˆ¤æ–­å¼•ç”¨å¯¹è±¡çš„å®é™…ç±»å‹ï¼Œæ ¹æ®å…¶å®é™…çš„ç±»å‹è°ƒç”¨å…¶ç›¸åº”çš„æ–¹æ³•ã€‚ æŠ½è±¡:è¡¨ç¤ºå¯¹é—®é¢˜é¢†åŸŸè¿›è¡Œåˆ†æã€è®¾è®¡ä¸­å¾—å‡ºçš„æŠ½è±¡çš„æ¦‚å¿µï¼Œæ˜¯å¯¹ä¸€ç³»åˆ—çœ‹ä¸Šå»ä¸åŒï¼Œä½†æ˜¯æœ¬è´¨ä¸Šç›¸åŒçš„å…·ä½“æ¦‚å¿µçš„æŠ½è±¡ã€‚åœ¨ Java ä¸­æŠ½è±¡ç”¨ abstract å…³é”®å­—æ¥ä¿®é¥°ï¼Œç”¨abstractä¿®é¥°ç±»æ—¶ï¼Œæ­¤ç±»å°±ä¸èƒ½è¢«å®ä¾‹åŒ–ï¼Œä»è¿™é‡Œå¯ä»¥çœ‹å‡ºï¼ŒæŠ½è±¡ç±»(æ¥å£)å°±æ˜¯ä¸ºäº†ç»§æ‰¿è€Œå­˜åœ¨çš„ã€‚ å¸¸è§çš„RuntimeException java.lang.NullPointerException ç©ºæŒ‡é’ˆå¼‚å¸¸;å‡ºç°åŸå› :è°ƒç”¨äº†æœªç»åˆå§‹åŒ–çš„å¯¹è±¡æˆ–è€…æ˜¯ä¸å­˜åœ¨ çš„å¯¹è±¡ã€‚ java.lang.ClassNotFoundException æŒ‡å®šçš„ç±»æ‰¾ä¸åˆ°;å‡ºç°åŸå› :ç±»çš„åç§°å’Œè·¯å¾„åŠ è½½é”™è¯¯;é€šå¸¸ éƒ½æ˜¯ç¨‹åºè¯•å›¾é€šè¿‡å­—ç¬¦ä¸²æ¥åŠ è½½æŸä¸ªç±»æ—¶å¯èƒ½å¼•å‘å¼‚å¸¸ã€‚ java.lang.NumberFormatException å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å­—å¼‚å¸¸;å‡ºç°åŸå› :å­—ç¬¦å‹æ•°æ®ä¸­åŒ…å«éæ•° å­—å‹å­—ç¬¦ã€‚ java.lang.IndexOutOfBoundsException æ•°ç»„è§’æ ‡è¶Šç•Œå¼‚å¸¸ï¼Œå¸¸è§äºæ“ä½œæ•°ç»„å¯¹è±¡æ—¶å‘ç”Ÿã€‚ java.lang.IllegalArgumentException æ–¹æ³•ä¼ é€’å‚æ•°é”™è¯¯ã€‚ java.lang.ClassCastException æ•°æ®ç±»å‹è½¬æ¢å¼‚å¸¸ã€‚ java.lang.NoClassDefFoundException æœªæ‰¾åˆ°ç±»å®šä¹‰é”™è¯¯ã€‚ SQLException SQL å¼‚å¸¸ï¼Œå¸¸è§äºæ“ä½œæ•°æ®åº“æ—¶çš„ SQL è¯­å¥é”™è¯¯ã€‚ java.lang.InstantiationExceptionå®ä¾‹åŒ–å¼‚å¸¸ã€‚ java.lang.NoSuchMethodExceptionæ–¹æ³•ä¸å­˜åœ¨å¼‚å¸¸ã€‚ å¸¸è§çš„å¼•ç”¨ç±»å‹javaçš„å¼•ç”¨ç±»å‹ä¸€èˆ¬åˆ†ä¸ºå››ç§ï¼šå¼ºå¼•ç”¨ã€è½¯å¼•ç”¨ã€å¼±å¼•ç”¨ã€è™šå¼•ç”¨ å¼ºå¼•ç”¨ï¼šæ™®é€šçš„å˜é‡å¼•ç”¨ è½¯å¼•ç”¨ï¼šå°†å¯¹è±¡ç”¨SoftReferenceè½¯å¼•ç”¨ç±»å‹çš„å¯¹è±¡åŒ…è£¹ï¼Œæ­£å¸¸æƒ…å†µä¸ä¼šè¢«å›æ”¶ï¼Œä½†æ˜¯GCåšå®Œåå‘ç°é‡Šæ”¾ä¸å‡ºç©ºé—´å­˜æ”¾æ–°çš„å¯¹è±¡ï¼Œåˆ™ä¼šæŠŠè¿™äº›è½¯å¼•ç”¨çš„å¯¹è±¡å›æ”¶æ‰ã€‚è½¯å¼•ç”¨å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚ å¼±å¼•ç”¨ï¼šå°†å¯¹è±¡ç”¨WeakReferenceè½¯å¼•ç”¨ç±»å‹çš„å¯¹è±¡åŒ…è£¹ï¼Œå¼±å¼•ç”¨è·Ÿæ²¡å¼•ç”¨å·®ä¸å¤šï¼ŒGCä¼šç›´æ¥å›æ”¶æ‰ï¼Œå¾ˆå°‘ç”¨ è™šå¼•ç”¨ï¼šè™šå¼•ç”¨ä¹Ÿç§°ä¸ºå¹½çµå¼•ç”¨æˆ–è€…å¹»å½±å¼•ç”¨ï¼Œå®ƒæ˜¯æœ€å¼±çš„ä¸€ç§å¼•ç”¨å…³ç³»ï¼Œå‡ ä¹ä¸ç”¨ JVMjvmå†…å­˜æ¨¡å‹ å¯¹è±¡åˆ›å»ºè¿‡ç¨‹ ç±»åŠ è½½æ£€æŸ¥ï¼šè™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡newæŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆå°†å»æ£€æŸ¥è¿™ä¸ªç±»æ˜¯å¦å·²è¢«åŠ è½½ã€è§£æå’Œåˆå§‹åŒ–è¿‡ã€‚å¦‚æœæ²¡æœ‰ï¼Œé‚£å¿…é¡»å…ˆæ‰§è¡Œç›¸åº”çš„ç±»åŠ è½½è¿‡ç¨‹ï¼šç±»åŠ è½½è¿‡ç¨‹ä¸­ä¼šé€šè¿‡jvmè‡ªå¸¦çš„ä¸‰ä¸ªç±»åŠ è½½å™¨æŒ‰ç…§åŒäº²å§”æ´¾æœºåˆ¶è¿›è¡Œç±»åŠ è½½è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¸¸è§çš„ClassNotFoundExceptionå°±æ˜¯åœ¨è¿™é‡Œå‘ç”Ÿçš„ï¼Œæˆ‘ä»¬ä»£ç ä¸­çš„é™æ€ä»£ç å—é‡Œé¢çš„å†…å®¹ä¹Ÿæ˜¯åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æ‰§è¡Œçš„ã€‚ åˆ†é…å†…å­˜ï¼šåœ¨ç±»åŠ è½½æ£€æŸ¥é€šè¿‡åï¼Œè™šæ‹Ÿæœºå°†ä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ã€‚å¯¹è±¡æ‰€éœ€å†…å­˜çš„å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯å®Œå…¨ç¡®å®šï¼Œä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠ ä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä»Javaå †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚ åˆå§‹åŒ–é›¶å€¼ï¼šå†…å­˜åˆ†é…å®Œæˆåï¼Œè™šæ‹Ÿæœºéœ€è¦å°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ï¼Œè¿™ä¸€æ­¥æ“ä½œä¿è¯äº†å¯¹è±¡çš„å®ä¾‹å­—æ®µåœ¨Javaä»£ç ä¸­å¯ä»¥ä¸èµ‹åˆå§‹å€¼å°±ç›´æ¥ä½¿ç”¨ï¼Œç¨‹åºèƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼ã€‚ è®¾ç½®å¯¹è±¡å¤´ï¼šåˆå§‹åŒ–é›¶å€¼ä¹‹åï¼Œè™šæ‹Ÿæœºè¦å¯¹å¯¹è±¡è¿›è¡Œå¿…è¦çš„è®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€å¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯(å³å¯¹è±¡æŒ‡å‘å®ƒçš„ç±»å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œè™šæ‹Ÿæœºé€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹)ã€å¯¹è±¡çš„å“ˆå¸Œç ï¼ˆHashCodeï¼‰ã€å¯¹è±¡çš„GCåˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡çš„å¯¹è±¡å¤´Object Headerä¹‹ä¸­ã€‚ æ‰§è¡Œæ–¹æ³•ï¼šæ‰§è¡Œæ–¹æ³•ï¼Œå³å¯¹è±¡æŒ‰ç…§ç¨‹åºå‘˜çš„æ„æ„¿è¿›è¡Œåˆå§‹åŒ–ã€‚å¯¹åº”åˆ°è¯­è¨€å±‚é¢ä¸Šè®²ï¼Œå°±æ˜¯ä¸ºå±æ€§èµ‹å€¼ï¼ˆæ³¨æ„ï¼Œè¿™ä¸ä¸Šé¢çš„èµ‹é›¶å€¼ä¸åŒï¼Œè¿™æ˜¯ç”±ç¨‹åºå‘˜èµ‹çš„å€¼ï¼‰ï¼Œå’Œæ‰§è¡Œæ„é€ æ–¹æ³•ã€‚ åƒåœ¾å›æ”¶ç®—æ³• å¼•ç”¨è®¡æ•°æ³• å¯è¾¾æ€§åˆ†ææ³• å¯¹äºå¯è¾¾æ€§åˆ†ææ³•ï¼Œæˆ‘ä»¬çŸ¥é“éœ€è¦å­˜åœ¨ä¸€ä¸ªGC Rootçš„å¯¹è±¡ä½œä¸ºèµ·ç‚¹ï¼Œä»è¿™ä¸ªèŠ‚ç‚¹å¼€å§‹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨é“¾ï¼Œå½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆå°±æ˜¯ä»GC Rootsåˆ°å¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œåˆ™è¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚ GC Rootæœ‰å“ªäº›ï¼Ÿ è™šæ‹Ÿæœºæ ˆä¸­çš„å¼•ç”¨å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIå¼•ç”¨å¯¹è±¡ åƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›ï¼Ÿ Serialæ”¶é›†å™¨(-XX:+UseSerialGC -XX:+UseSerialOldGC)ï¼šSerialï¼ˆä¸²è¡Œï¼‰æ”¶é›†å™¨æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•ï¼Œè€å¹´ä»£é‡‡ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ã€‚ Parallel Scavengeæ”¶é›†å™¨(-XX:+UseParallelGC(å¹´è½»ä»£),-XX:+UseParallelOldGC(è€å¹´ä»£)) ï¼šParallelæ”¶é›†å™¨å…¶å®å°±æ˜¯Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œé™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†å¤–ï¼Œå…¶ä½™è¡Œä¸ºï¼ˆæ§åˆ¶å‚æ•°ã€æ”¶é›†ç®—æ³•ã€å›æ”¶ç­–ç•¥ç­‰ç­‰ï¼‰å’ŒSerialæ”¶é›†å™¨ç±»ä¼¼ã€‚é»˜è®¤çš„æ”¶é›†çº¿ç¨‹æ•°è·Ÿcpuæ ¸æ•°ç›¸åŒ ParNewæ”¶é›†å™¨(-XX:+UseParNewGC)ï¼šåªæœ‰å®ƒèƒ½ä¸CMSæ”¶é›†å™¨ï¼ˆçœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘æ”¶é›†å™¨ï¼Œåé¢ä¼šä»‹ç»åˆ°ï¼‰é…åˆå·¥ä½œ CMSæ”¶é›†å™¨(-XX:+UseConcMarkSweepGC(old))ï¼šæ”¶é›†å™¨æ˜¯ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨CMSæ”¶é›†å™¨æ˜¯ä¸€ç§ â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•å®ç°çš„ã€‚CMSç­‰åƒåœ¾æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ›´å¤šçš„æ˜¯ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼ˆæé«˜ç”¨æˆ·ä½“éªŒï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯CPUä¸­ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸CPUæ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ã€‚ G1æ”¶é›†å™¨(-XX:+UseG1GC)ï¼šG1 (Garbage-First)æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡å™¨çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä¸»è¦é’ˆå¯¹é…å¤‡å¤šé¢—å¤„ç†å™¨åŠå¤§å®¹é‡å†…å­˜çš„æœºå™¨. ä»¥æé«˜æ¦‚ç‡æ»¡è¶³GCåœé¡¿æ—¶é—´è¦æ±‚çš„åŒæ—¶,è¿˜å…·å¤‡é«˜ååé‡æ€§èƒ½ç‰¹å¾ã€‚G1å°†Javaå †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼ŒJVMæœ€å¤šå¯ä»¥æœ‰2048ä¸ªRegionã€‚ä¸€èˆ¬Regionå¤§å°ç­‰äºå †å¤§å°é™¤ä»¥2048ï¼Œæ¯”å¦‚å †å¤§å°ä¸º4096Mï¼Œåˆ™Regionå¤§å°ä¸º2M Shenandoahï¼šå¯ä»¥çœ‹æˆæ˜¯G1å‡çº§ç‰ˆ ZGCæ”¶é›†å™¨ï¼šZGCæ˜¯ä¸€æ¬¾JDK 11ä¸­æ–°åŠ å…¥çš„å…·æœ‰å®éªŒæ€§è´¨çš„ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨ã€‚1ã€æ”¯æŒTBé‡çº§çš„å †ï¼›2ã€æœ€å¤§GCåœé¡¿æ—¶é—´ä¸è¶…10msï¼›3ã€å¥ å®šæœªæ¥GCç‰¹æ€§çš„åŸºç¡€ï¼›4ã€æœ€ç³Ÿç³•çš„æƒ…å†µä¸‹ååé‡ä¼šé™ä½15% CMSè¿è¡Œè¿‡ç¨‹ï¼Œç¼ºç‚¹ï¼Ÿæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ åˆå§‹æ ‡è®°(STW)ï¼š æš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹(STW)ï¼Œå¹¶è®°å½•ä¸‹gc rootsç›´æ¥èƒ½å¼•ç”¨çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« å¹¶å‘æ ‡è®°ï¼š å¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯ä»GC Rootsçš„ç›´æ¥å…³è”å¯¹è±¡å¼€å§‹éå†æ•´ä¸ªå¯¹è±¡å›¾çš„è¿‡ç¨‹ï¼Œ è¿™ä¸ªè¿‡ç¨‹è€—æ—¶è¾ƒé•¿ä½†æ˜¯ä¸éœ€è¦åœé¡¿ç”¨æˆ·çº¿ç¨‹ï¼Œå› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œï¼Œå¯èƒ½ä¼šæœ‰å¯¼è‡´å·²ç»æ ‡è®°è¿‡çš„å¯¹è±¡çŠ¶æ€å‘ç”Ÿæ”¹å˜ã€‚ é‡æ–°æ ‡è®°(STW)ï¼š é‡æ–°æ ‡è®°é˜¶æ®µå°±æ˜¯ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ä¸ºç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µçš„æ—¶é—´ç¨é•¿ï¼Œè¿œè¿œæ¯”å¹¶å‘æ ‡è®°é˜¶æ®µæ—¶é—´çŸ­ã€‚ å¹¶å‘æ¸…ç†ï¼š å¼€å¯ç”¨æˆ·çº¿ç¨‹ï¼ŒåŒæ—¶GCçº¿ç¨‹å¼€å§‹å¯¹æœªæ ‡è®°çš„åŒºåŸŸåšæ¸…æ‰«ã€‚ å¹¶å‘é‡ç½®ï¼šé‡ç½®æœ¬æ¬¡GCè¿‡ç¨‹ä¸­çš„æ ‡è®°æ•°æ®ã€‚ ç¼ºç‚¹ï¼š å¯¹CPUèµ„æºæ•æ„Ÿï¼ˆä¼šå’ŒæœåŠ¡æŠ¢èµ„æºï¼‰ æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾(åœ¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…ç†é˜¶æ®µåˆäº§ç”Ÿåƒåœ¾ï¼Œè¿™ç§æµ®åŠ¨åƒåœ¾åªèƒ½ç­‰åˆ°ä¸‹ä¸€æ¬¡gcå†æ¸…ç†äº†)ï¼› å®ƒä½¿ç”¨çš„å›æ”¶ç®—æ³•-â€œæ ‡è®°-æ¸…é™¤â€ç®—æ³•ä¼šå¯¼è‡´æ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿï¼Œå½“ç„¶é€šè¿‡å‚æ•°-XX:+UseCMSCompactAtFullCollectionå¯ä»¥è®©jvmåœ¨æ‰§è¡Œå®Œæ ‡è®°æ¸…é™¤åå†åšæ•´ç† å¹¶å‘æ¨¡å¼å¤±è´¥(æœ€å¤§é—®é¢˜)ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸ç¡®å®šæ€§ï¼Œä¼šå­˜åœ¨ä¸Šä¸€æ¬¡åƒåœ¾å›æ”¶è¿˜æ²¡æ‰§è¡Œå®Œï¼Œç„¶ååƒåœ¾å›æ”¶åˆè¢«è§¦å‘çš„æƒ…å†µï¼Œç‰¹åˆ«æ˜¯åœ¨å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…ç†é˜¶æ®µä¼šå‡ºç°ï¼Œä¸€è¾¹å›æ”¶ï¼Œç³»ç»Ÿä¸€è¾¹è¿è¡Œï¼Œä¹Ÿè®¸æ²¡å›æ”¶å®Œå°±å†æ¬¡è§¦å‘full gcï¼Œä¹Ÿå°±æ˜¯â€concurrent mode failureâ€ï¼Œæ­¤æ—¶ä¼šè¿›å…¥stop the worldï¼Œç”¨serial oldåƒåœ¾æ”¶é›†å™¨æ¥å›æ”¶ G1è¿è¡Œè¿‡ç¨‹G1æ”¶é›†å™¨ä¸€æ¬¡GCçš„è¿ä½œè¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š åˆå§‹æ ‡è®°ï¼ˆinitial markï¼ŒSTWï¼‰ï¼šæš‚åœæ‰€æœ‰çš„å…¶ä»–çº¿ç¨‹ï¼Œå¹¶è®°å½•ä¸‹gc rootsç›´æ¥èƒ½å¼•ç”¨çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿« ï¼› å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰ï¼šåŒCMSçš„å¹¶å‘æ ‡è®° æœ€ç»ˆæ ‡è®°ï¼ˆRemarkï¼ŒSTWï¼‰ï¼šåŒCMSçš„é‡æ–°æ ‡è®° ç­›é€‰å›æ”¶ï¼ˆCleanupï¼ŒSTWï¼‰ï¼šG1é‡‡ç”¨å¤åˆ¶ç®—æ³•å›æ”¶å‡ ä¹ä¸ä¼šæœ‰å¤ªå¤šå†…å­˜ç¢ç‰‡ G1é€‚åˆä»€ä¹ˆåœºæ™¯ 50%ä»¥ä¸Šçš„å †è¢«å­˜æ´»å¯¹è±¡å ç”¨ å¯¹è±¡åˆ†é…å’Œæ™‹å‡çš„é€Ÿåº¦å˜åŒ–éå¸¸å¤§ åƒåœ¾å›æ”¶æ—¶é—´ç‰¹åˆ«é•¿ï¼Œè¶…è¿‡1ç§’ 8GBä»¥ä¸Šçš„å †å†…å­˜(å»ºè®®å€¼) åœé¡¿æ—¶é—´æ˜¯500msä»¥å†… åˆ¤æ–­å…ƒç©ºé—´æ˜¯æ— ç”¨çš„ç±»æ³•åŒºï¼ˆå…ƒç©ºé—´ï¼‰ä¸»è¦å›æ”¶çš„æ˜¯æ— ç”¨çš„ç±»ï¼Œé‚£ä¹ˆå¦‚ä½•åˆ¤æ–­ä¸€ä¸ªç±»æ˜¯æ— ç”¨çš„ç±»å‘¢ï¼Ÿç±»éœ€è¦åŒæ—¶æ»¡è¶³ä¸‹é¢3ä¸ªæ¡ä»¶æ‰èƒ½ç®—æ˜¯ â€œæ— ç”¨çš„ç±»â€ ï¼š è¯¥ç±»æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œä¹Ÿå°±æ˜¯ Java å †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚ åŠ è½½è¯¥ç±»çš„ ClassLoader å·²ç»è¢«å›æ”¶ã€‚ï¼ˆæ¡ä»¶è‹›åˆ»ï¼Œè‡ªå®šä¹‰ç±»åŠ è½½å™¨ä¼šè¢«å›æ”¶æ‰ï¼‰ è¯¥ç±»å¯¹åº”çš„ java.lang.Class å¯¹è±¡æ²¡æœ‰åœ¨ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•ã€‚ å®‰å…¨ç‚¹å’Œå®‰å…¨åŒºåŸŸå®‰å…¨ç‚¹ï¼šå°±æ˜¯æŒ‡ä»£ç ä¸­ä¸€äº›ç‰¹å®šçš„ä½ç½®,å½“çº¿ç¨‹è¿è¡Œåˆ°è¿™äº›ä½ç½®æ—¶å®ƒçš„çŠ¶æ€æ˜¯ç¡®å®šçš„,è¿™æ ·JVMå°±å¯ä»¥å®‰å…¨çš„è¿›è¡Œä¸€äº›æ“ä½œ,æ¯”å¦‚GCç­‰ï¼Œæ‰€ä»¥GCä¸æ˜¯æƒ³ä»€ä¹ˆæ—¶å€™åšå°±ç«‹å³è§¦å‘çš„ï¼Œæ˜¯éœ€è¦ç­‰å¾…æ‰€æœ‰çº¿ç¨‹è¿è¡Œåˆ°å®‰å…¨ç‚¹åæ‰èƒ½è§¦å‘ã€‚è¿™äº›ç‰¹å®šçš„å®‰å…¨ç‚¹ä½ç½®ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§: æ–¹æ³•è¿”å›ä¹‹å‰ è°ƒç”¨æŸä¸ªæ–¹æ³•ä¹‹å æŠ›å‡ºå¼‚å¸¸çš„ä½ç½® å¾ªç¯çš„æœ«å°¾ å®‰å…¨åŒºåŸŸï¼šå¦‚æœä¸€ä¸ªçº¿ç¨‹å¤„äº Sleep æˆ–ä¸­æ–­çŠ¶æ€ï¼Œå®ƒå°±ä¸èƒ½å“åº” JVM çš„ä¸­æ–­è¯·æ±‚ï¼Œå¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚åœ¨è¿™ä¸ªåŒºåŸŸå†…çš„ä»»æ„åœ°æ–¹å¼€å§‹ GC éƒ½æ˜¯å®‰å…¨çš„ã€‚ ç±»åŠ è½½å™¨ï¼ŸåŒäº²å§”æ´¾ï¼Œå¥½å¤„ï¼ŸJDKè‡ªå¸¦æœ‰ä¸‰ä¸ªç±»åŠ è½½å™¨ï¼šbootstrapClassLoader(å¼•å¯¼ç±»åŠ è½½å™¨)ã€ExtClassLoader(æ‰©å±•ç±»åŠ è½½å™¨)ã€AppClassLoader(ç³»ç»Ÿç±»åŠ è½½å™¨)ï¼ŒbootstrapClassLoaderæ˜¯ExtClassLoaderçš„çˆ¶ç±»åŠ è½½å™¨(å¹¶ä¸æ˜¯é›†æˆå…³ç³»ï¼Œæ˜¯å±æ€§å…³ç³»)é»˜è®¤åŠ è½½%JAVA_HOME%/libä¸‹çš„jaråŒ…å’Œclassæ–‡ä»¶ExtClassLoaderæ˜¯AppClassLoaderçš„çˆ¶ç±»åŠ è½½å™¨ï¼Œé»˜è®¤åŠ è½½%JAVA_HOME%/lib/extæ–‡ä»¶å¤¹ä¸‹çš„jaråŒ…å’Œclassæ–‡ä»¶AppClassLoaderæ˜¯è‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œè´Ÿè´£åŠ è½½classpathä¸‹çš„ç±»æ–‡ä»¶ åŒäº²å§”æ´¾ï¼šåˆ†ä¸ºå‘ä¸Šå§”æ´¾å’Œå‘ä¸‹æŸ¥æ‰¾ï¼Œæ¯ä¸€ä¸ªç±»åŠ è½½å™¨éƒ½æœ‰å„è‡ªçš„ç¼“å­˜ï¼Œéƒ½ä¼šè®°å½•è‡ªå·±åŠ è½½è¿‡çš„ç±»ï¼Œå½“ä¸€ä¸ªç±»éœ€è¦åŠ è½½ï¼ŒAppClassLoaderå…ˆæŸ¥æ‰¾è‡ªå·±çš„ç¼“å­˜æœ‰æ²¡æœ‰åŠ è½½è¿‡è¿™ä¸ªç±»ï¼Œæ²¡æœ‰åŠ è½½è¿‡å°±ä¼šè°ƒç”¨ExtClassLoaderå»æŸ¥æ‰¾ï¼ŒExtClassLoaderæ²¡æœ‰åŠ è½½è¿‡ï¼Œå°±ä¼šè°ƒç”¨bootstrapClassLoaderç±»å»åŠ è½½ï¼Œå¦‚æœbootstrapClassLoaderæ²¡æœ‰åŠ è½½è¿‡ï¼Œå°±ä¼šå»ä»–çš„ç±»åŠ è½½è·¯å¾„æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ExtClassLoaderå°±ä¼šæŸ¥æ‰¾ä»–çš„ç±»åŠ è½½è·¯å¾„ï¼Œå‘ä¸Šå§”æ´¾å°±æ˜¯æŸ¥æ‰¾ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°bootstrapClassLoaderä½ç½®ï¼Œå‘ä¸‹æŸ¥æ‰¾å°±æ˜¯æŸ¥æ‰¾ç±»åŠ è½½è·¯å¾„ï¼ŒæŸ¥æ‰¾åˆ°å‘èµ·çš„ç±»åŠ è½½å™¨ä¸ºæ­¢ã€‚ å¥½å¤„ï¼š1ã€å®‰å…¨æ€§ï¼Œé¿å…è‡ªå·±å†™çš„ç±»æ›¿æ¢æ‰javaæ ¸å¿ƒç±»ï¼›2ã€é¿å…ç±»é‡å¤åŠ è½½ï¼Œç›¸åŒclassæ–‡ä»¶ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½çš„ä¹Ÿæ˜¯ä¸¤ä¸ªç±»ã€‚ YGCå’ŒFGCå‘ç”Ÿçš„åœºæ™¯YGCï¼šå¯¹æ–°ç”Ÿä»£å †è¿›è¡Œgcã€‚é¢‘ç‡æ¯”è¾ƒé«˜ï¼Œå› ä¸ºå¤§éƒ¨åˆ†å¯¹è±¡çš„å­˜æ´»å¯¿å‘½è¾ƒçŸ­ï¼Œåœ¨æ–°ç”Ÿä»£é‡Œè¢«å›æ”¶ã€‚æ€§èƒ½è€—è´¹è¾ƒå°ã€‚ednç©ºé—´ä¸è¶³,æ‰§è¡Œ FGCï¼šå…¨å †èŒƒå›´çš„gcã€‚é»˜è®¤å †ç©ºé—´ä½¿ç”¨åˆ°è¾¾80%(å¯è°ƒæ•´)çš„æ—¶å€™ä¼šè§¦å‘fgcã€‚ç”Ÿäº§ç¯å¢ƒï¼Œä¸€èˆ¬æ¯”è¾ƒå°‘ä¼šè§¦å‘fgcï¼Œæœ‰æ—¶10å¤©æˆ–ä¸€å‘¨å·¦å³ä¼šæœ‰ä¸€æ¬¡ã€‚ è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œæ°¸ä¹…åŒºç©ºé—´ä¸è¶³ï¼Œè°ƒç”¨æ–¹æ³•System.gc() ï¼Œygcæ—¶çš„æ‚²è§‚ç­–ç•¥, dump liveçš„å†…å­˜ä¿¡æ¯æ—¶(jmap â€“dump:live)ï¼Œéƒ½ä¼šæ‰§è¡Œfull gc jstackï¼Œjmapï¼ŒJstatä½œç”¨jmapï¼šå¯ä»¥ç”¨æ¥æŸ¥çœ‹å†…å­˜ä¿¡æ¯ï¼Œå®ä¾‹ä¸ªæ•°ä»¥åŠå ç”¨å†…å­˜å¤§å° jmap -heap è¿›ç¨‹å·ï¼šæŸ¥çœ‹å †å†…å­˜ä¿¡æ¯ jmap â€dump:format=b,file=eureka.hprof è¿›ç¨‹å·ï¼š å †å†…å­˜çš„å¿«ç…§ä¿¡æ¯ï¼Œæ·»åŠ jvmå‚æ•°ä¹Ÿå¯ä»¥è®¾ç½®å†…å­˜æº¢å‡ºè‡ªåŠ¨å¯¼å‡ºdumpæ–‡ä»¶ jstack: å¯ä»¥è·å¾—javaçº¿ç¨‹çš„è¿è¡Œæƒ…å†µï¼Œå¯ä»¥æŸ¥çœ‹æ­»é”ï¼Œé˜»å¡ï¼Œç­‰å¾… Jstack -l PID &gt;&gt; 123.txt æ‰“å°æŸä¸ªjavaè¿›ç¨‹çš„å †æ ˆä¿¡æ¯ Jstatï¼šjstatå‘½ä»¤å¯ä»¥æŸ¥çœ‹å †å†…å­˜å„éƒ¨åˆ†çš„ä½¿ç”¨é‡ï¼Œä»¥åŠåŠ è½½ç±»çš„æ•°é‡ jstat -gc pid æœ€å¸¸ç”¨ï¼Œå¯ä»¥è¯„ä¼°ç¨‹åºå†…å­˜ä½¿ç”¨åŠGCå‹åŠ›æ•´ä½“æƒ…å†µ å¤šçº¿ç¨‹æ­»é” æ­»é”ï¼šæ˜¯æŒ‡ä¸€ç»„äº’ç›¸ç«äº‰èµ„æºçš„çº¿ç¨‹ï¼Œå› ä¸ºäº’ç›¸ç­‰å¾…ï¼Œå¯¼è‡´æ°¸ä¹…é˜»å¡çš„ç°è±¡ã€‚ åŸå› ï¼šå¿…é¡»åŒæ—¶æ»¡è¶³ä»¥ä¸‹å››ä¸ªæ¡ä»¶ å…±äº«äº’æ–¥æ¡ä»¶ï¼šå…±äº«èµ„æºxå’Œyåªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨ å æœ‰ä¸”ç­‰å¾…ï¼šçº¿ç¨‹t1å·²ç»å æœ‰å…±äº«èµ„æºxï¼Œåœ¨ç­‰å¾…å…±äº«èµ„æºyçš„æ—¶å€™ä¸é‡Šæ”¾å…±äº«èµ„æºx ä¸å¯æŠ¢å ï¼šå…¶ä»–çº¿ç¨‹ä¸èƒ½å¼ºè¡ŒæŠ¢å çº¿ç¨‹t1å æœ‰çš„èµ„æº å¾ªç¯ç­‰å¾…ï¼šçº¿ç¨‹t1ç­‰å¾…çº¿ç¨‹t2å æœ‰çš„èµ„æºï¼Œçº¿ç¨‹t2ç­‰å¾…çº¿ç¨‹t1å æœ‰çš„èµ„æº å¦‚ä½•é¿å…æ­»é”ï¼š æ—¢ç„¶äº§ç”Ÿæ­»é”å¿…ç„¶æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼Œé‚£æˆ‘ä»¬åªè¦æ‰“ç ´å››ä¸ªæ¡ä»¶ä¸­çš„ä¸€ä¸ªå°±å¯ä»¥é¿å…ï¼Œç¬¬ä¸€ä¸ªäº’æ–¥æ¡ä»¶æ˜¯æ— æ³•è¢«ç ´åçš„ï¼Œå› ä¸ºé”æœ¬èº«å°±æ˜¯é€šè¿‡äº’æ–¥æ¥è§£å†³çº¿ç¨‹å®‰å…¨çš„ é’ˆå¯¹åä¸‰ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬é€ä¸€åˆ†æï¼Œå æœ‰ä¸”ç­‰å¾…è¿™ä¸ªæ¡ä»¶æˆ‘ä»¬å¯ä»¥ä¸€æ¬¡æ€§ç”³è¯·æ‰€æœ‰èµ„æºï¼Œä¸å­˜åœ¨ç­‰å¾…ï¼› ä¸å¯æŠ¢å è¿™ä¸ªæ¡ä»¶ï¼šå æœ‰éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºçš„æ—¶å€™å¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å·²å æœ‰çš„èµ„æºï¼Œè¿™æ ·ä¸å¯æŠ¢å è¿™æ¡ä»¶å°±ç ´åäº†ï¼› å¾ªç¯ç­‰å¾…è¿™ä¸ªæ¡ä»¶ï¼šå¯ä»¥æŒ‰ç…§é¡ºåºå»ç”³è¯·èµ„æºè¿›è¡Œé¢„é˜²ï¼Œå°±æ˜¯è¯´èµ„æºæ˜¯æœ‰çº¿æ€§é¡ºåºçš„ï¼Œç”³è¯·çš„æ—¶å€™å¯ä»¥å…ˆç”³è¯·èµ„æºåºå·å°çš„ï¼Œå†ç”³è¯·èµ„æºåºå·å¤§çš„ï¼Œçº¿æ€§åŒ–ä¹‹åï¼Œå°±ä¸å­˜åœ¨å¾ªç¯ç­‰å¾…äº† sleepå’ŒwaitåŒºåˆ« sleep æ˜¯ Thread ç±»çš„é™æ€æœ¬åœ°æ–¹æ³•ï¼Œwait åˆ™æ˜¯ Object ç±»çš„æœ¬åœ°æ–¹æ³• sleepæ–¹æ³•ä¸ä¼šé‡Šæ”¾é”ï¼Œä½†æ˜¯waitä¼šé‡Šæ”¾ï¼Œè€Œä¸”ä¼šåŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ sleepæ–¹æ³•ä¸ä¾èµ–äºåŒæ­¥å™¨synchronizedï¼Œä½†æ˜¯waitéœ€è¦ä¾èµ–synchronizedå…³é”®å­— sleepä¸éœ€è¦è¢«å”¤é†’ï¼ˆä¼‘çœ ä¹‹åæ¨å‡ºé˜»å¡ï¼‰ï¼Œä½†æ˜¯waitéœ€è¦ï¼ˆä¸æŒ‡å®šæ—¶é—´éœ€è¦è¢«åˆ«äººä¸­æ–­ï¼‰ sleep ä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæˆ–è€…è½®å¾ªæš‚åœæ“ä½œï¼Œwait åˆ™å¤šç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ sleep ä¼šè®©å‡º CPU æ‰§è¡Œæ—¶é—´ä¸”å¼ºåˆ¶ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œ wait åˆ™ä¸ä¸€å®šï¼Œwait åå¯èƒ½è¿˜æ˜¯æœ‰æœºä¼šé‡æ–°ç«äº‰åˆ°é”ç»§ç»­æ‰§è¡Œçš„ã€‚ sleepå°±æ˜¯æŠŠcpuçš„æ‰§è¡Œèµ„æ ¼å’Œæ‰§è¡Œæƒé‡Šæ”¾å‡ºå»ï¼Œä¸å†è¿è¡Œæ­¤çº¿ç¨‹ï¼Œå½“å®šæ—¶æ—¶é—´ç»“æŸå†å–å›cpuèµ„æºï¼Œå‚ä¸cpuçš„è°ƒåº¦ï¼Œè·å–åˆ°cpuèµ„æºåå°±å¯ä»¥ç»§ç»­è¿è¡Œäº†ã€‚è€Œå¦‚æœsleepæ—¶è¯¥çº¿ç¨‹æœ‰é”ï¼Œé‚£ä¹ˆsleepä¸ä¼šé‡Šæ”¾è¿™ä¸ªé”ï¼Œè€Œæ˜¯æŠŠé”å¸¦ç€è¿›å…¥äº†å†»ç»“çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´å…¶ä»–éœ€è¦è¿™ä¸ªé”çš„çº¿ç¨‹æ ¹æœ¬ä¸å¯èƒ½è·å–åˆ°è¿™ä¸ªé”ã€‚ä¹Ÿå°±æ˜¯è¯´æ— æ³•æ‰§è¡Œç¨‹åºã€‚å¦‚æœåœ¨ç¡çœ æœŸé—´å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†è¿™ä¸ªçº¿ç¨‹çš„interruptæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹ä¹Ÿä¼šæŠ›å‡ºinterruptexceptionå¼‚å¸¸è¿”å›ï¼Œè¿™ç‚¹å’Œwaitæ˜¯ä¸€æ ·çš„ã€‚ å½“æˆ‘ä»¬è°ƒç”¨waitï¼ˆï¼‰æ–¹æ³•åï¼Œçº¿ç¨‹ä¼šæ”¾åˆ°ç­‰å¾…æ± å½“ä¸­ï¼Œç­‰å¾…æ± çš„çº¿ç¨‹æ˜¯ä¸ä¼šå»ç«äº‰åŒæ­¥é”ã€‚åªæœ‰è°ƒç”¨äº†notifyï¼ˆï¼‰æˆ–notifyAll()åç­‰å¾…æ± çš„çº¿ç¨‹æ‰ä¼šå¼€å§‹å»ç«äº‰é”ï¼Œnotifyï¼ˆï¼‰æ˜¯éšæœºä»ç­‰å¾…æ± é€‰å‡ºä¸€ä¸ªçº¿ç¨‹æ”¾åˆ°é”æ± ï¼Œè€ŒnotifyAll()æ˜¯å°†ç­‰å¾…æ± çš„æ‰€æœ‰çº¿ç¨‹æ”¾åˆ°é”æ± å½“ä¸­ Volitileä½œç”¨ å¯è§æ€§ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„è¯»ï¼Œæ€»æ˜¯èƒ½çœ‹åˆ°ï¼ˆä»»æ„çº¿ç¨‹ï¼‰å¯¹è¿™ä¸ªvolatileå˜é‡æœ€åçš„å†™å…¥ã€‚å†…å­˜å±éšœ-&gt;æ±‡ç¼–Lockå…³é”®å­—-&gt;ç¼“å­˜ä¸€è‡´æ€§åè®® åŸå­æ€§ï¼šå¯¹ä»»æ„å•ä¸ªvolatileå˜é‡çš„è¯»/å†™å…·æœ‰åŸå­æ€§ï¼Œä½†ç±»ä¼¼äºvolatile++è¿™ç§å¤åˆæ“ä½œä¸å…·æœ‰åŸå­æ€§ æœ‰åºæ€§ï¼šå¯¹volatileä¿®é¥°çš„å˜é‡çš„è¯»å†™æ“ä½œå‰ååŠ ä¸Šå„ç§ç‰¹å®šçš„å†…å­˜å±éšœæ¥ç¦æ­¢æŒ‡ä»¤é‡æ’åºæ¥ä¿éšœæœ‰åºæ€§ Volitileå¦‚ä½•ä¿è¯å¯è§æ€§ ç¼“å­˜ä¸€è‡´æ€§ï¼šåœ¨å…±äº«å†…å­˜å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤„ç†å™¨éƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„ç¼“å­˜å†…å­˜ï¼Œå…±äº«æ•°æ®åœ¨ä¸»å†…å­˜å’Œå„å¤„ç†å™¨ç§æœ‰ç¼“å­˜åŒæ—¶å­˜åœ¨ã€‚å½“æ•°æ®çš„ä¸€ä¸ªå‰¯æœ¬å‘ç”Ÿæ›´æ”¹ï¼Œå…¶ä»–å‰¯æœ¬éœ€è¦æ„ŸçŸ¥åˆ°æœ€æ–°ä¿®æ”¹æ•°æ®ã€‚ç¼“å­˜ä¸€è‡´æ€§çš„æ‰‹æ®µä¸»è¦æœ‰ï¼š æ€»çº¿é”å®šï¼šæ€»çº¿é”å®šå°±æ˜¯ä½¿ç”¨å¤„ç†å™¨æä¾›çš„ä¸€ä¸ª LOCKï¼ƒä¿¡å·ï¼Œå½“å…¶ä¸­ä¸€ä¸ªå¤„ç†å™¨åœ¨æ€»çº¿ä¸Šè¾“å‡ºæ­¤ä¿¡å·æ—¶ï¼Œå…¶å®ƒå¤„ç†å™¨çš„è¯·æ±‚å°†è¢«é˜»å¡ï¼Œé‚£ä¹ˆè¯¥å¤„ç†å™¨å¯ä»¥ç‹¬å å…±äº«å†…å­˜ã€‚ æ€»çº¿çª¥æ¢(Bus snooping)ï¼šæ˜¯ç¼“å­˜ä¸­çš„ä¸€è‡´æ€§æ§åˆ¶å™¨çª¥æ¢æ€»çº¿äº‹åŠ¡çš„ä¸€ç§æ–¹æ¡ˆï¼ˆè¯¥æ–¹æ¡ˆç”±Ravishankarå’ŒGoodmanäº1983å¹´æå‡ºï¼‰å½“æ•°æ®è¢«å¤šä¸ªç¼“å­˜å…±äº«æ—¶ï¼Œä¸€ä¸ªå¤„ç†å™¨ä¿®æ”¹äº†å…±äº«æ•°æ®çš„å€¼ï¼Œå¯ä»¥æ˜¯åˆ·æ–°ç¼“å­˜å—æˆ–ä½¿ç¼“å­˜å—å¤±æ•ˆè¿˜å¯ä»¥é€šè¿‡ç¼“å­˜å—çŠ¶æ€çš„æ”¹å˜ï¼Œæ¥è¾¾åˆ°ç¼“å­˜ä¸€è‡´æ€§çš„ç›®çš„ï¼Œä¸»è¦å–å†³äºçª¥æ¢åè®®ç±»å‹ï¼š å†™å¤±æ•ˆï¼ˆWrite-invalidateï¼‰ ï¼šå½“ä¸€ä¸ªå¤„ç†å™¨å†™å…¥å…±äº«ç¼“å­˜æ—¶ï¼Œå…¶ä»–ç¼“å­˜ä¸­çš„æ‰€æœ‰å…±äº«å‰¯æœ¬éƒ½ä¼šé€šè¿‡æ€»çº¿çª¥æ¢å¤±æ•ˆã€‚ç¡®ä¿å¤„ç†å™¨åªèƒ½è¯»å†™ä¸€ä¸ªæ•°æ®å‰¯æœ¬ï¼Œå…¶ä»–ç¼“å­˜ä¸­çš„æ‰€æœ‰å…¶ä»–å‰¯æœ¬éƒ½æ— æ•ˆã€‚è¿™æ˜¯æœ€å¸¸ç”¨çš„çª¥æ¢åè®®ã€‚MSIã€MESIã€MOSIã€MOESIå’ŒMESIFåè®®å±äºè¯¥ç±»å‹ã€‚ å†™æ›´æ–°ï¼ˆWrite-updateï¼‰ï¼šå½“å¤„ç†å™¨å†™å…¥ä¸€ä¸ªå…±äº«ç¼“å­˜å—æ—¶ï¼Œå…¶ä»–ç¼“å­˜çš„æ‰€æœ‰å…±äº«å‰¯æœ¬éƒ½ä¼šé€šè¿‡æ€»çº¿çª¥æ¢æ›´æ–°ã€‚è¿™ä¸ªæ–¹æ³•å°†å†™æ•°æ®å¹¿æ’­åˆ°æ€»çº¿ä¸Šçš„æ‰€æœ‰ç¼“å­˜ä¸­ã€‚å®ƒæ¯”å†™å¤±æ•ˆåè®®å¼•èµ·æ›´å¤§çš„æ€»çº¿æµé‡ï¼Œå› æ­¤è¿™ç§æ–¹æ³•ä¸å¸¸è§ã€‚Dragonå’Œfireflyåè®®å±äºæ­¤ç±»åˆ«ã€‚ æŒ‡ä»¤é‡æ’åºJavaè¯­è¨€è§„èŒƒè§„å®šJVMçº¿ç¨‹å†…éƒ¨ç»´æŒé¡ºåºåŒ–è¯­ä¹‰ï¼Œå³åªè¦ç¨‹åºçš„æœ€ç»ˆç»“æœä¸å®ƒé¡ºåºåŒ–æƒ…å†µçš„ç»“æœç›¸ç­‰ï¼Œé‚£ä¹ˆæŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºå¯ä»¥ä¸ä»£ç é¡ºåºä¸ä¸€è‡´ï¼Œæ­¤è¿‡ç¨‹å«æŒ‡ä»¤çš„é‡æ’åºã€‚æŒ‡ä»¤é‡æ’åºçš„æ„ä¹‰ï¼šï¼šJVMèƒ½æ ¹æ®å¤„ç†å™¨ç‰¹æ€§ï¼ˆCPUå¤šçº§ç¼“å­˜ç³»ç»Ÿã€å¤šæ ¸å¤„ç†å™¨ç­‰ï¼‰é€‚å½“çš„å¯¹æœºå™¨æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œä½¿æœºå™¨æŒ‡ä»¤èƒ½æ›´ç¬¦åˆCPUçš„æ‰§è¡Œç‰¹æ€§ï¼Œæœ€å¤§é™åº¦çš„å‘æŒ¥æœºå™¨æ€§èƒ½ã€‚ Javaçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ NEWï¼ˆåˆå§‹åŒ–çŠ¶æ€ï¼‰ RUNNABLEï¼ˆå¯è¿è¡ŒçŠ¶æ€+è¿è¡ŒçŠ¶æ€ï¼‰ BLOCKEDï¼ˆé˜»å¡çŠ¶æ€ï¼‰ WAITINGï¼ˆæ— æ—¶é™ç­‰å¾…ï¼‰ TIMED_WAITINGï¼ˆæœ‰æ—¶é™ç­‰å¾…ï¼‰ TERMINATEDï¼ˆç»ˆæ­¢çŠ¶æ€ï¼‰ åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œæœ‰äº”ç§çŠ¶æ€ï¼ŒJava çº¿ç¨‹ä¸­çš„ BLOCKEDã€WAITINGã€TIMED_WAITING æ˜¯ä¸€ç§çŠ¶æ€ï¼Œå³å‰é¢æˆ‘ä»¬æåˆ°çš„ä¼‘çœ çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦ Java çº¿ç¨‹å¤„äºè¿™ä¸‰ç§çŠ¶æ€ä¹‹ä¸€ï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±æ°¸è¿œæ²¡æœ‰ CPU çš„ä½¿ç”¨æƒã€‚ linuxæŸ¥çœ‹çº¿ç¨‹å‘½ä»¤ ps - fe æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹ ps - fT - p æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ï¼ˆ PID ï¼‰çš„æ‰€æœ‰çº¿ç¨‹ kill æ€æ­»è¿›ç¨‹ top æŒ‰å¤§å†™ H åˆ‡æ¢æ˜¯å¦æ˜¾ç¤ºçº¿ç¨‹ top - H - p æŸ¥çœ‹æŸä¸ªè¿›ç¨‹ï¼ˆ PID ï¼‰çš„æ‰€æœ‰çº¿ç¨‹ jps å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰ Java è¿›ç¨‹ jstack æŸ¥çœ‹æŸä¸ª Java è¿›ç¨‹ï¼ˆ PID ï¼‰çš„æ‰€æœ‰çº¿ç¨‹çŠ¶æ€ jconsole æ¥æŸ¥çœ‹æŸä¸ª Java è¿›ç¨‹ä¸­çº¿ç¨‹çš„è¿è¡Œæƒ…å†µï¼ˆå›¾å½¢ç•Œé¢ï¼‰ Javaçº¿ç¨‹çš„å®ç°æ–¹å¼ æ–¹å¼1ï¼šä½¿ç”¨ Threadç±»æˆ–ç»§æ‰¿Threadç±» å®ç° Runnable æ¥å£é…åˆThread ä½¿ç”¨æœ‰è¿”å›å€¼çš„ Callableï¼Œå€ŸåŠ©çº¿ç¨‹æ± ä½¿ç”¨ ä½¿ç”¨ lambda æœ¬è´¨ä¸ŠJavaä¸­å®ç°çº¿ç¨‹åªæœ‰ä¸€ç§æ–¹å¼ï¼Œéƒ½æ˜¯é€šè¿‡new Thread()åˆ›å»ºçº¿ç¨‹ï¼Œè°ƒç”¨Thread#startå¯åŠ¨çº¿ç¨‹æœ€ç»ˆéƒ½ä¼šè°ƒç”¨Thread#runæ–¹æ³• Threadå¸¸ç”¨æ–¹æ³•sleepæ–¹æ³• è°ƒç”¨ sleep ä¼šè®©å½“å‰çº¿ç¨‹ä» Running è¿›å…¥TIMED_WAITINGçŠ¶æ€ï¼Œä¸ä¼šé‡Šæ”¾å¯¹è±¡é” å…¶å®ƒçº¿ç¨‹å¯ä»¥ä½¿ç”¨ interrupt æ–¹æ³•æ‰“æ–­æ­£åœ¨ç¡çœ çš„çº¿ç¨‹ï¼Œè¿™æ—¶ sleep æ–¹æ³•ä¼šæŠ›å‡ºInterruptedExceptionï¼Œå¹¶ä¸”ä¼šæ¸…é™¤ä¸­æ–­æ ‡å¿— ç¡çœ ç»“æŸåçš„çº¿ç¨‹æœªå¿…ä¼šç«‹åˆ»å¾—åˆ°æ‰§è¡Œ sleepå½“ä¼ å…¥å‚æ•°ä¸º0æ—¶ï¼Œå’Œyieldç›¸åŒ yieldæ–¹æ³• yieldä¼šé‡Šæ”¾CPUèµ„æºï¼Œè®©å½“å‰çº¿ç¨‹ä» Running è¿›å…¥ RunnableçŠ¶æ€ï¼Œè®©ä¼˜å…ˆçº§æ›´é«˜ï¼ˆè‡³å°‘æ˜¯ç›¸åŒï¼‰çš„çº¿ç¨‹è·å¾—æ‰§è¡Œæœºä¼šï¼Œä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ï¼› å‡è®¾å½“å‰è¿›ç¨‹åªæœ‰mainçº¿ç¨‹ï¼Œå½“è°ƒç”¨yieldä¹‹åï¼Œmainçº¿ç¨‹ä¼šç»§ç»­è¿è¡Œï¼Œå› ä¸ºæ²¡æœ‰æ¯”å®ƒä¼˜å…ˆçº§æ›´é«˜çš„çº¿ç¨‹ï¼› å…·ä½“çš„å®ç°ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„ä»»åŠ¡è°ƒåº¦å™¨ ThreadLocalçš„å®ç°åŸç†ThreadLocalçš„å®ç°åŸç†ï¼Œæ¯ä¸€ä¸ªThreadç»´æŠ¤ä¸€ä¸ªThreadLocalMapï¼Œkeyä¸ºä½¿ç”¨å¼±å¼•ç”¨çš„ThreadLocalå®ä¾‹ï¼Œvalueä¸ºçº¿ç¨‹å˜é‡çš„å‰¯æœ¬ ThreadLocalåº”ç”¨åœºæ™¯ åœ¨è¿›è¡Œå¯¹è±¡è·¨å±‚ä¼ é€’çš„æ—¶å€™ï¼Œä½¿ç”¨ThreadLocalå¯ä»¥é¿å…å¤šæ¬¡ä¼ é€’ï¼Œæ‰“ç ´å±‚æ¬¡é—´çš„çº¦æŸã€‚ çº¿ç¨‹é—´æ•°æ®éš”ç¦» è¿›è¡Œäº‹åŠ¡æ“ä½œï¼Œç”¨äºå­˜å‚¨çº¿ç¨‹äº‹åŠ¡ä¿¡æ¯ã€‚ æ•°æ®åº“è¿æ¥ï¼ŒSessionä¼šè¯ç®¡ç†ã€‚ Springæ¡†æ¶åœ¨äº‹åŠ¡å¼€å§‹æ—¶ä¼šç»™å½“å‰çº¿ç¨‹ç»‘å®šä¸€ä¸ªJdbc Connection,åœ¨æ•´ä¸ªäº‹åŠ¡è¿‡ç¨‹éƒ½æ˜¯ä½¿ç”¨è¯¥çº¿ç¨‹ç»‘å®šçš„connectionæ¥æ‰§è¡Œæ•°æ®åº“æ“ä½œï¼Œå®ç°äº†äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚Springæ¡†æ¶é‡Œé¢å°±æ˜¯ç”¨çš„ThreadLocalæ¥å®ç°è¿™ç§éš”ç¦» ThreadLocalå†…å­˜æ³„éœ²åŸå› ï¼Œå¦‚ä½•é¿å… å¼ºå¼•ç”¨ï¼šä½¿ç”¨æœ€æ™®éçš„å¼•ç”¨(new)ï¼Œä¸€ä¸ªå¯¹è±¡å…·æœ‰å¼ºå¼•ç”¨ï¼Œä¸ä¼šè¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚å½“å†…å­˜ç©ºé—´ä¸è¶³ï¼ŒJavaè™šæ‹Ÿæœºå®æ„¿æŠ›å‡ºOutOfMemoryErroré”™è¯¯ï¼Œä½¿ç¨‹åºå¼‚å¸¸ç»ˆæ­¢ï¼Œä¹Ÿä¸å›æ”¶è¿™ç§å¯¹è±¡ã€‚ å¼±å¼•ç”¨ï¼šJVMè¿›è¡Œåƒåœ¾å›æ”¶æ—¶ï¼Œæ— è®ºå†…å­˜æ˜¯å¦å……è¶³ï¼Œéƒ½ä¼šå›æ”¶è¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚åœ¨javaä¸­ï¼Œç”¨java.lang.ref.WeakReferenceç±»æ¥è¡¨ç¤ºã€‚å¯ä»¥åœ¨ç¼“å­˜ä¸­ä½¿ç”¨å¼±å¼•ç”¨ã€‚ ThreadLocalæ­£ç¡®çš„ä½¿ç”¨æ–¹æ³• æ¯æ¬¡ä½¿ç”¨å®ŒThreadLocaléƒ½è°ƒç”¨å®ƒçš„remove()æ–¹æ³•æ¸…é™¤æ•°æ® å°†ThreadLocalå˜é‡å®šä¹‰æˆprivate staticï¼Œè¿™æ ·å°±ä¸€ç›´å­˜åœ¨ThreadLocalçš„å¼ºå¼•ç”¨ï¼Œä¹Ÿå°±èƒ½ä¿è¯ä»»ä½•æ—¶å€™éƒ½èƒ½é€šè¿‡ThreadLocalçš„å¼±å¼•ç”¨è®¿é—®åˆ°Entryçš„valueå€¼ï¼Œè¿›è€Œæ¸…é™¤æ‰ ã€‚ synchronizedå’ŒReentranLockåŒºåˆ«ï¼Ÿsynchronizedæ˜¯jvmå±‚é¢çš„å…³é”®å­—ï¼Œåº•å±‚æ˜¯é€šè¿‡monitorå¯¹è±¡æ¥å®Œæˆï¼Œmonitorå¯¹è±¡åº•å±‚ä¾èµ–äºæ“ä½œç³»ç»Ÿçš„Mutexäº’æ–¥é‡ï¼Œåº•å±‚è°ƒç”¨çš„æ˜¯æ“ä½œç³»ç»Ÿçš„Pthreadåº“ï¼Œæ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥ç»´æŠ¤çš„ï¼Œè€Œæ“ä½œç³»ç»Ÿåˆ†ä¸ºç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´çš„ï¼ŒJVMè¿è¡Œåœ¨ç”¨æˆ·ç©ºé—´ï¼Œè°ƒç”¨åº•å±‚æ“ä½œç³»ç»Ÿcpuä¼šè¿›è¡Œä¸€è½®çŠ¶æ€åˆ‡æ¢ï¼Œè¿™ä¸ªçŠ¶æ€åˆ‡æ¢æ˜¯æ¯”è¾ƒé‡å‹æ“ä½œï¼Œwait/notifyç­‰æ–¹æ³•ä¹Ÿä¾èµ–monitorå¯¹è±¡åªæœ‰åœ¨åŒæ­¥å—æˆ–æ–¹æ³•ä¸­æ‰èƒ½è°ƒwait/notifyç­‰æ–¹æ³•ã€‚ Lockæ˜¯å…·ä½“ç±»ï¼ˆjava.util.concurrent.Locks.Lock)æ˜¯apiå±‚é¢çš„é”ï¼Œæ˜¯ä»jdk1.5å¼€å§‹å¼•å…¥çš„ï¼Œé‚£ä¸ªæ—¶å€™synchronizedæ€§èƒ½è¿˜æ¯”è¾ƒå·®ï¼ŒReentranLockçš„å‡ºç°æ˜¯ä¸ºäº†è§£å†³å½“æ—¶æ€§èƒ½å·®çš„é—®é¢˜ ä½¿ç”¨æ–¹æ³•ï¼šsynchronizedä¸éœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼ŒReentranLockåˆ™éœ€è¦ç”¨æˆ·æ‰‹åŠ¨é‡Šæ”¾é”(éœ€è¦lock()å’Œunlock()é…åˆtry/finallyä½¿ç”¨) ç­‰å¾…æ˜¯å¦å¯ä¸­æ–­ï¼šsynchronizedä¸å¯ä¸­æ–­ï¼Œé™¤éæŠ›å‡ºå¼‚å¸¸æˆ–è€…æ‰§è¡Œå®Œæˆï¼ŒReentranLockå¯ä¸­æ–­ è®¾ç½®è¶…æ—¶æ–¹æ³•tryLock(long timeout, timeUnit unit) lockInterruptibly()æ”¾ä»£ç å—å¿ ï¼Œè°ƒç”¨interrupt()æ–¹æ³•å¯ä¸­æ–­ åŠ é”æ˜¯å¦å…¬å¹³ï¼šsynchronizedéå…¬å¹³é”ï¼›ReentranLock ä¸¤è€…éƒ½å¯ä»¥ï¼Œé»˜è®¤éå…¬å¹³é”ï¼Œæ„é€ æ–¹æ³•ä¼ å…¥trueä¸ºå…¬å¹³é”ï¼Œfalseä¸ºéå…¬å¹³é” é”ç»‘å®šå¤šä¸ªæ¡ä»¶Conditionï¼šsynchronized æ²¡æœ‰ï¼›ReentranLock ç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ï¼Œå¯ä»¥ç²¾ç¡®å”¤é†’ï¼Œä¸åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œè¦ä¹ˆå…¨éƒ¨å”¤é†’ çº¿ç¨‹æ± å‚æ•°æœ‰ï¼Œæ ¸å¿ƒçº¿ç¨‹é…ç½®ï¼ŒåŸå› ï¼Ÿ corePoolSizeï¼šçº¿ç¨‹æ± ä¸­çš„æ ¸å¿ƒçº¿ç¨‹æ•° maximumPoolSizeï¼šçº¿ç¨‹æ± ä¸­å…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°ã€‚å¦‚æœå½“å‰é˜»å¡é˜Ÿåˆ—æ»¡äº†ï¼Œä¸”ç»§ç»­æäº¤ä»»åŠ¡ï¼Œåˆ™åˆ›å»ºæ–°çš„çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ keepAliveTimeï¼šæ ¸å¿ƒçº¿ç¨‹å¤–çš„çº¿ç¨‹å­˜æ´»è¶…æ—¶æ—¶é—´ unitï¼šæ—¶é—´å•ä½ workQueueï¼šç”¨æ¥ä¿å­˜ç­‰å¾…è¢«æ‰§è¡Œçš„ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—ï¼Œä¸”ä»»åŠ¡å¿…é¡»å®ç°Runableæ¥å£ threadFactoryï¼šç”¨æ¥åˆ›å»ºæ–°çº¿ç¨‹ çº¿ç¨‹æ± çš„é¥±å’Œç­–ç•¥ï¼š( AbortPolicyï¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé»˜è®¤ç­–ç•¥ï¼›CallerRunsPolicyï¼šç”¨è°ƒç”¨è€…æ‰€åœ¨çš„çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼›DiscardOldestPolicyï¼šä¸¢å¼ƒé˜»å¡é˜Ÿåˆ—ä¸­é æœ€å‰çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ï¼›DiscardPolicyï¼šç›´æ¥ä¸¢å¼ƒä»»åŠ¡) CPUå¯†é›†å‹ï¼ˆCPU-boundï¼‰ CPUå¯†é›†å‹ä¹Ÿå«è®¡ç®—å¯†é›†å‹ï¼Œåœ¨å¤šé‡ç¨‹åºç³»ç»Ÿä¸­ï¼Œå¤§éƒ¨ä»½æ—¶é—´ç”¨æ¥åšè®¡ç®—ã€é€»è¾‘åˆ¤æ–­ç­‰CPUåŠ¨ä½œçš„ç¨‹åºç§°ä¹‹CPU boundã€‚ä¾‹å¦‚ä¸€ä¸ªè®¡ç®—åœ†å‘¨ç‡è‡³å°æ•°ç‚¹ä¸€åƒä½ä»¥ä¸‹çš„ç¨‹åºï¼Œåœ¨æ‰§è¡Œçš„è¿‡ç¨‹å½“ä¸­ç»å¤§éƒ¨ä»½æ—¶é—´ç”¨åœ¨ä¸‰è§’å‡½æ•°å’Œå¼€æ ¹å·çš„è®¡ç®—ï¼Œä¾¿æ˜¯å±äºCPU boundçš„ç¨‹åºã€‚ çº¿ç¨‹æ•° = CPUæ ¸æ•°+1 (ç°ä»£CPUæ”¯æŒè¶…çº¿ç¨‹) IOå¯†é›†å‹ï¼ˆI/O boundï¼‰ IOå¯†é›†å‹æŒ‡çš„æ˜¯ç³»ç»Ÿçš„CPUæ€§èƒ½ç›¸å¯¹ç¡¬ç›˜ã€å†…å­˜è¦å¥½å¾ˆå¤šï¼Œæ­¤æ—¶ï¼Œç³»ç»Ÿè¿ä½œï¼Œå¤§éƒ¨åˆ†çš„çŠ¶å†µæ˜¯CPUåœ¨ç­‰I/O (ç¡¬ç›˜/å†…å­˜) çš„è¯»/å†™æ“ä½œ çº¿ç¨‹æ•° = ï¼ˆï¼ˆçº¿ç¨‹ç­‰å¾…æ—¶é—´+çº¿ç¨‹CPUæ—¶é—´ï¼‰/çº¿ç¨‹CPUæ—¶é—´ ï¼‰* CPUæ•°ç›® é›†åˆSet,List,Mapæœ‰ä»€ä¹ˆåŒºåˆ« ç»“æ„ç‰¹ç‚¹ List å’Œ Set æ˜¯å­˜å‚¨å•åˆ—æ•°æ®çš„é›†åˆï¼Œ Map æ˜¯å­˜å‚¨é”®å’Œå€¼è¿™æ ·çš„åŒåˆ—æ•°æ®çš„é›†åˆ; Listä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æœ‰é¡ºåºï¼Œå¹¶ä¸”å…è®¸é‡å¤; Map ä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æ²¡æœ‰é¡ºåºçš„ï¼Œå…¶é”®æ˜¯ä¸èƒ½é‡å¤çš„ï¼Œå®ƒçš„å€¼æ˜¯å¯ä»¥æœ‰é‡å¤çš„ï¼Œ Set ä¸­å­˜å‚¨çš„æ•°æ®æ˜¯æ— åºçš„ï¼Œä¸”ä¸å…è®¸æœ‰é‡å¤ï¼Œä½†å…ƒç´ åœ¨é›†åˆä¸­çš„ä½ç½®ç”±å…ƒç´ çš„hashcodeå†³å®šï¼Œä½ç½®æ˜¯å›ºå®šçš„(Seté›†åˆæ ¹æ® hashcode æ¥è¿›è¡Œæ•°æ®çš„å­˜å‚¨ï¼Œæ‰€ä»¥ä½ç½®æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯ä½ç½®ä¸æ˜¯ç”¨æˆ·å¯ä»¥æ§åˆ¶çš„ï¼Œæ‰€ä»¥å¯¹äºç”¨æˆ·æ¥è¯´ set ä¸­çš„å…ƒç´ è¿˜æ˜¯æ— åºçš„); HashMapå’ŒHashTableæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸåŒºåˆ«ï¼š HashMapæ–¹æ³•æ²¡æœ‰synchronizedä¿®é¥°ï¼Œçº¿ç¨‹éå®‰å…¨ï¼ŒHashTableçº¿ç¨‹å®‰å…¨ï¼› HashMapå…è®¸keyå’Œvalueä¸ºnullï¼Œè€ŒHashTableä¸å…è®¸ HashMapåº•å±‚å®ç° jdk1.7åº•å±‚é‡‡ç”¨çš„æ˜¯æ•°ç»„+é“¾è¡¨å®ç°ï¼›jdk1.8åº•å±‚é‡‡ç”¨æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å®ç°ï¼Œç›¸å¯¹äº1.7æå‡äº†æŸ¥è¯¢çš„æ€§èƒ½ é“¾è¡¨è¿‡åº¦åˆ°çº¢é»‘æ ‘çš„é˜ˆå€¼ä¸º8ï¼Œçº¢é»‘æ ‘é€€åŒ–ä¸ºé“¾è¡¨çš„é˜ˆå€¼æ˜¯6ï¼ŒåŸå› åœ¨æºç ä¸­332è¡Œç»™äº†æ˜ç¡®è§£é‡Š(Poisson distribution)æ³Šæ¾åˆ†å¸ƒï¼Œè¿™æ˜¯æ•°å­¦é‡Œé¢ç±»ä¼¼äºæ­£æ€åˆ†å¸ƒçš„ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ç»Ÿè®¡å­¦é‡Œé¢çš„ä¸€äº›ä¸œè¥¿ HashMapåˆå§‹åŒ–çš„æ•°ç»„é•¿åº¦ä¸º16(ç®—æ³•å¯¼è®ºä¸­çš„é™¤æ³•æ•£åˆ—æ³•è®²åˆ° Kå–æ¨¡må¾—åˆ°ä¸€ä¸ªå¯¹åº”çš„ä½ç½®ï¼Œæ ¹æ®å…·ä½“ä½ç½®æ’å…¥ä¸€ä¸ªæ•°æ®å€¼ï¼Œå‡å¦‚é•¿åº¦æ˜¯16ï¼Œé•¿åº¦èŒƒå›´å°±æ˜¯015ï¼Œå–æ¨¡ä¹‹åæˆ‘çš„ä½™æ•°ä¸º015ä¹‹é—´ï¼Œè€Œç®—æ³•å¯¼è®ºä¸­æŒ‡å‡ºï¼Œä¸€ä¸ªä¸å¤ªæ¥è¿‘2çš„æ•´æ•°å¹‚çš„ç´ æ•°ï¼ˆè´¨æ•°ï¼šåªèƒ½è¢«1å’Œå®ƒæœ¬èº«æ•´å‡ºçš„æ•°ï¼‰ï¼Œå¸¸å¸¸æ˜¯mçš„æœ€å¥½é€‰æ‹©ã€‚ä½†æ˜¯hashMapä¸­æœªé‡‡ç”¨ç´ æ•°ï¼Œè€Œæ˜¯é‡‡ç”¨2çš„næ¬¡æ–¹(åˆæ•°)ä½œä¸ºæ•°ç»„é•¿åº¦)ï¼ŒåŸå› ä¸ºï¼š1ã€æ›´ä¾¿äºä½ç½®è®¡ç®—ï¼›2ã€æ–¹ä¾¿åšæ•°æ®è¿ç§»ã€‚ ä¸ºäº†ä¿è¯å­˜å…¥çš„æ•°æ®å‡åŒ€çš„æ•£åˆ—åˆ†å¸ƒåœ¨æ•°ç»„ä¸­ï¼Œéœ€è¦è®¾è®¡è‰¯å¥½çš„hashæ•£åˆ—ç®—æ³•(hashMapä¸­é‡‡ç”¨æ‰°åŠ¨å‡½æ•°æ¥åšçš„ï¼šç§»ä½å’Œå¼‚æˆ–ç›¸å…³æ“ä½œConcurrentHashMapæºç ä¸­684è¡Œspreadæ–¹æ³•ï¼Œå³ï¼šè®©intçš„é«˜16ä½å¼‚æˆ–å®ƒæœ¬èº«)ï¼Œå°½å¯èƒ½çš„é¿å…hashå†²çª(æ¦‚ç‡é—®é¢˜)ï¼Œå…·ä½“è½åˆ°æ•°ç»„å“ªä¸ªèŠ‚ç‚¹å¹¶éæ˜¯é€šè¿‡å–æ¨¡è¿ç®—å¾—å‡ºï¼Œè€Œæ˜¯é€šè¿‡ä¸ä¸Šæ•°ç»„é•¿åº¦-1å³å¯(åªéœ€è¦intç±»å‹æ•°32ä½çš„åå››ä½å‚ä¸è¿ç®—)ï¼Œå³å¯å¾—åˆ°0~15ä¹‹é—´çš„æ•°ï¼Œå› ä¸ºå–æ¨¡è¿ç®—æ•ˆç‡è¿œä½äºä½è¿ç®—ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯hashMapè¦æ±‚åº•å±‚æ•°ç»„é•¿åº¦å¿…é¡»ä¸º2çš„næ¬¡æ–¹çš„åŸå› ä¹‹ä¸€ï¼ˆConcurrentHashMapæºç ä¸­514è¡Œè§„å®šï¼‰ã€‚ HashMap putæµç¨‹ HashMap/ConcurrentHashMap å¹¶ä¸æ˜¯é€šè¿‡æ„é€ å‡½æ•°åˆ›å»ºé»˜è®¤ç©ºé—´çš„ï¼Œè€Œæ˜¯é€šè¿‡putæ•°æ®çš„æ—¶å€™è·å–åˆ°å¯¹åº”çš„æ•°æ®ç©ºé—´çš„ï¼Œå¦‚æœæ•°ç»„é•¿åº¦æ˜¯0ï¼Œåˆ™é€šè¿‡CASæ“ä½œååˆå§‹åŒ–æ•°ç»„ï¼Œå¦‚æœæœ‰çº¿ç¨‹æ­£åœ¨åšåˆå§‹åŒ–æ•°ç»„æ“ä½œï¼Œå…¶ä»–çº¿ç¨‹åˆ™è®©å‡ºæ—¶é—´ç‰‡ HashMapæ‰©å®¹æµç¨‹ hashMapè§„å®šäº†å½“æˆ‘çš„æ•°ç»„å¿«æ”¾æ»¡çš„æ—¶å€™å°±è¦å¼€å§‹æ‰©å®¹äº†ï¼Œä»€ä¹ˆæ—¶å€™ç®—æ˜¯å¿«æ”¾æ»¡ï¼ŸHashMapæ˜¯é€šè¿‡æ‰©å®¹å› å­æ¥è§„å®šçš„ HashMapè§„å®šæ‰©å®¹å› å­æ˜¯0.75ï¼Œå¦‚æœé»˜è®¤é•¿åº¦æ˜¯16ï¼Œä¹Ÿå°±æ˜¯è¯´å½“HashMapåº•å±‚æ•°ç»„çš„å®¹é‡è¾¾åˆ°12çš„æ—¶å€™è¿›è¡Œæ‰©å®¹æ“ä½œã€‚0.75åˆ™æ˜¯æ ¹æ®ç»Ÿè®¡å­¦å¾—æ¥çš„ã€‚private static final float LOAD_FACTOR = 0.75f; æ‰©å®¹é¦–å…ˆè¦åˆ›å»ºæ–°çš„æ•°ç»„ï¼ˆåŸæ¥å¤§å°å·¦ç§»1ä½ï¼‰ConcurrentHaspMapæºç 2367è¡Œå¼€å§‹æ‰©å®¹æ“ä½œ è½¬ç§»æ—§æ•°æ®åˆ°æ–°çš„æ•°ç»„ä¸­å»ï¼ˆæ€ä¹ˆè®¡ç®—æ‰©å®¹åæ•°æ®ä¸‹æ ‡ä½ç½®ï¼Ÿï¼‰åŸæ¥ï¼šh&amp;(n-1)è®¡ç®—ä¸‹æ ‡ä½ç½®ï¼Œæ‰©å®¹å h$(31)ï¼ŒåŸæ¥å ç”¨4ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ‰©å®¹åå ç”¨5ä¸ªäºŒè¿›åˆ¶ä½ï¼Œæ‰€ä»¥åªéœ€è¦çœ‹ç¬¬äº”ä½å³å¯ï¼Œå¦‚æœç¬¬äº”ä½æ˜¯0ï¼Œæ‰©å®¹åçš„çš„ä¸‹æ ‡è·ŸåŸä½ç½®ä¸€æ ·ï¼Œå¦‚æœæ˜¯1ï¼Œæ–°ä¸‹æ ‡ä½ç½®åœ¨åŸæ•°ç»„çš„ä½ç½®çš„åŸºç¡€ä¸ŠåŠ ä¸ŠåŸæ¥æ•°ç»„é•¿åº¦å³å¯ï¼Œè¿™ä¹Ÿæ˜¯æ•°ç»„é•¿åº¦é‡‡ç”¨2çš„Næ¬¡æ–¹æ‰©å®¹çš„ç¬¬äºŒä¸ªåŸå›  å‡è®¾åŸæ¥é•¿åº¦æ˜¯128ï¼Œæ‰©å®¹åæ˜¯256ï¼Œæ•´ä½“æ‰©å®¹æ–¹å¼æ˜¯é€šè¿‡å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œçš„ï¼Œä½†æ˜¯è¦ä¿è¯æ•°æ®ä¸èƒ½ä¹±ï¼Œå°†åŸæ¥æ•°ç»„åˆ†æ®µï¼Œè§„å®šæ¯ä¸ªçº¿ç¨‹æœ€å°‘è´Ÿè´£16ä¸ªæ¡¶çš„è¿ç§»å·¥ä½œï¼Œ8ä¸ªçº¿ç¨‹å¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼Œå¦‚æœå°äº16ä¸ªæ¡¶ï¼Œç›´æ¥å•çº¿ç¨‹æ‰§è¡Œ ä¸ºä»€ä¹ˆé€‰æ‹©ç”¨çº¢é»‘æ ‘äºŒå‰æ ‘åœ¨æç«¯æƒ…å†µä¸‹ä¼šé€€åŒ–ä¸ºé“¾è¡¨ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦è·Ÿé“¾è¡¨ç›¸ä¼¼ï¼Œè€ŒAVLæ ‘ï¼ŒSBæ ‘ï¼Œçº¢é»‘æ ‘ï¼Œéƒ½å±äºå¹³è¡¡äºŒå‰æ ‘ï¼Œå°½é‡ä¿æŒå·¦å­æ ‘å’Œå³å­æ ‘çš„é«˜åº¦å·®ä¸è¦ç›¸å·®å¤ªå¤§ï¼Œè€Œè¿™ä¸‰ç§æ ‘çš„å·®åˆ«å°±åœ¨äºå·¦æ ‘å’Œå³æ ‘çš„é«˜åº¦è§„åˆ™ä¸åŒã€‚ AVLæ ‘ï¼šä¸¥æ ¼æ„ä¹‰å¹³è¡¡æ ‘ï¼Œçš„è¦æ±‚å·¦å­æ ‘å’Œå³å­æ ‘çš„é«˜åº¦å·®ä¸èƒ½è¶…è¿‡1ï¼ŒæŸå¤±äº†éƒ¨åˆ†æ’å…¥æ€§èƒ½ï¼Œå¸¦æ¥äº†é«˜æ•ˆçš„æŸ¥è¯¢ SBæ ‘ï¼š çº¢é»‘æ ‘ï¼šè¦æ±‚æœ€é•¿å­æ ‘ä¸èƒ½è¶…è¿‡æœ€çŸ­å­æ ‘çš„2å€å³å¯ï¼ŒæŸå¤±äº†éƒ¨åˆ†æŸ¥è¯¢æ€§èƒ½ï¼Œä½¿å¾—æŸ¥è¯¢æ•ˆç‡é«˜äºé“¾è¡¨çš„åŒæ—¶ï¼Œç›¸æ¯”äºå…¶ä»–æ ‘æå‡äº†æ’å…¥æ€§èƒ½ï¼Œå°½é‡åšåˆ°äº†æ’å…¥å’ŒæŸ¥è¯¢çš„ä¸€ä¸ªå¹³è¡¡ç‚¹ï¼Œè€ŒHashMapåˆ™æ˜¯æŸ¥å¤šï¼Œæ’å…¥å°‘(è¿™é‡Œçš„æ’å…¥æŒ‡çš„æ˜¯äº§ç”ŸHashå†²çªä¸‹çš„æ’å…¥)ï¼Œæ‰€ä»¥çº¢é»‘æ ‘æ›´é€‚åˆHashMapæ¥åšåº•å±‚çš„å­˜å‚¨ç»“æ„ã€‚ ConcurrentHaspMap ConcurrentHaspMapæ˜¯çº¿ç¨‹å®‰å…¨çš„HashMapï¼Œå®ƒåº•å±‚é‡‡ç”¨å¤§é‡çš„CASæ“ä½œ springspringæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œæ›´åƒæ˜¯ä¸€ä¸ªç”Ÿæ€ç¯å¢ƒï¼Œåœ¨æˆ‘ä»¬çš„å¼€å‘æµç¨‹ä¸­ï¼Œæ‰€æœ‰çš„æ¡†æ¶åŸºæœ¬ä¸Šéƒ½ä¾èµ–äºspringï¼Œspringèµ·åˆ°äº†ä¸€ä¸ªIOCå®¹å™¨çš„ä½œç”¨ï¼Œç”¨æ¥æ‰¿è½½æˆ‘ä»¬æ•´ä½“çš„beanå¯¹è±¡ï¼Œå®ƒå¸®æˆ‘ä»¬å¤„ç†äº†beanå¯¹è±¡ä»åˆ›å»ºåˆ°é”€æ¯çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨springçš„æ—¶å€™ï¼Œå¯ä»¥ä½¿ç”¨é…ç½®æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨æ³¨è§£çš„æ–¹å¼è¿›è¡Œç›¸å…³å¼€å‘ã€‚springæ¡†æ¶çš„å·¥ä½œä¸»è¦æµç¨‹æ˜¯ï¼Œå½“æˆ‘ä»¬ç¨‹åºå¼€å§‹å¯åŠ¨ä¹‹åï¼ŒspringæŠŠæ³¨è§£æˆ–è€…é…ç½®æ–‡ä»¶å®šä¹‰å¥½çš„beanå¯¹è±¡è½¬åŒ–æˆä¸ºBeanDefinitionranï¼Œç„¶åé€šBeanFactoryPostProcessorå®Œæˆæ•´ä¸ªçš„BeanDefinitionrançš„è§£æå’ŒåŠ è½½è¿‡ç¨‹ï¼Œç„¶åæ ¹æ®BeanDefinitionrané€šè¿‡åå°„çš„æ–¹å¼åˆ›å»ºbeanå¯¹è±¡ï¼Œç„¶åè¿›è¡Œå¯¹è±¡åˆå§‹åŒ–ï¼ŒåŒ…æ‹¬ï¼šawareæ¥å£ç›¸å…³æ“ä½œï¼ŒBeanPostProcessoræ“ä½œï¼ŒInit-methordæ“ä½œå®Œæˆæ•´ä¸ªbeançš„åˆ›å»ºè¿‡ç¨‹ï¼Œä¹‹åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨äº†ã€‚ Beançš„åˆå§‹åŒ–è¿‡ç¨‹ Beançš„ç”Ÿå‘½å‘¨æœŸ å¾ªç¯ä¾èµ–AOPçš„é¡ºåº spring4å’Œspring5æ˜¯ä¸ä¸€æ ·çš„ springMVCå¤„ç†è¯·æ±‚æµç¨‹ springäº‹åŠ¡çš„ä¼ æ’­æœºåˆ¶ TransactionDefinition.PROPAGATION_REQUIREDï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ TransactionDefinition.PROPAGATION_SUPPORTSï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡çš„è¯ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œ TransactionDefinition.PROPAGATION_MANDATORYï¼šæ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰äº‹åŠ¡æŠ›å‡ºå¼‚å¸¸ TransactionDefinition.PROPAGATION_REQUIRES_NEWï¼šåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡å¹¶æŒ‚èµ·å½“å‰äº‹åŠ¡ TransactionDefinition.PROPAGATION_NOT_SUPPORTEDï¼šä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡åˆ™å°†å½“å‰äº‹åŠ¡æŒ‚èµ· TransactionDefinition.PROPAGATION_NEVERï¼šä»¥éäº‹åŠ¡æ–¹å¼è¿›è¡Œï¼Œå¦‚æœå­˜åœ¨äº‹åŠ¡åˆ™æŠ›å‡ºå¼‚å¸¸ TransactionDefinition.PROPAGATION_NESTEDï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åœ¨åµŒå¥—äº‹åŠ¡å†…æ‰§è¡Œã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™è¿›è¡Œä¸PROPAGATION_REQUIREDç±»ä¼¼çš„æ“ä½œã€‚ RPCæ¡†æ¶ä½ çŸ¥é“çš„jsonåºåˆ—åŒ–æ–¹å¼ï¼Ÿ è°·æ­Œçš„Gson json-smartï¼šå·ç§°æ˜¯é€Ÿåº¦æœ€å¿«çš„JSONè§£æå™¨ Common Lang3(3.1)çš„SerializationUtils é˜¿é‡Œå·´å·´çš„ FastJsonã€ä»¥åŠ Jackson ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´æ€ä¹ˆäº¤äº’çš„ï¼Ÿ å¥—æ¥å­—ï¼ˆsocketï¼‰ï¼šè¿™æ˜¯ä¸€ç§æ›´ä¸ºä¸€èˆ¬å¾—è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå®ƒå¯ç”¨äºç½‘ç»œä¸­ä¸åŒæœºå™¨ä¹‹é—´çš„è¿›ç¨‹é—´é€šä¿¡ï¼Œåº”ç”¨éå¸¸å¹¿æ³›ã€‚ å¯ä»¥é€šè¿‡RPCæ¡†æ¶ï¼ˆdubboã€feignç­‰ï¼‰è¿›è¡Œè¿œç¨‹è°ƒç”¨ ä¹Ÿå¯ä»¥å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ç­‰æ¶ˆæ¯ä¸­é—´ä»¶ä½œä¸ºç³»ç»Ÿä¹‹é—´ä¿¡æ¯äº¤äº’çš„æ¡¥æ¢ å…±äº«å†…å­˜ï¼ˆshared memoryï¼‰ï¼šå¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚å®ƒä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®å¾—æ›´ dubboçš„åºåˆ—åŒ–ï¼Ÿdubbo æ”¯æŒ hessionã€Java äºŒè¿›åˆ¶åºåˆ—åŒ–ã€jsonã€SOAP æ–‡æœ¬åºåˆ—åŒ–å¤šç§åºåˆ—åŒ–åè®®ã€‚ hessian æ˜¯å…¶é»˜è®¤çš„åºåˆ—åŒ–åè®® ç½‘ç»œç½‘ç»œä¸ƒå±‚æ¨¡å‹ ç¬¬ä¸€å±‚ï¼šç‰©ç†å±‚ ç¬¬äºŒå±‚ï¼šæ•°æ®é“¾è·¯å±‚ 802.2ã€802.3ATMã€HDLCã€FRAME RELAY ç¬¬ä¸‰å±‚ï¼šç½‘ç»œå±‚ IPã€IPXã€ARPã€APPLETALKã€ICMP ç¬¬å››å±‚ï¼šä¼ è¾“å±‚ TCPã€UDPã€SPX ç¬¬äº”å±‚ï¼šä¼šè¯å±‚ RPCã€SQLã€NFS ã€X WINDOWSã€ASP ç¬¬å…­å±‚ï¼šè¡¨ç¤ºå±‚ ASCLLã€PICTã€TIFFã€JPEGã€ MIDIã€MPEG ç¬¬ä¸ƒå±‚ï¼šåº”ç”¨å±‚ HTTP,FTP,SNMPç­‰ ç‰©ç†å±‚ï¼šç‰©ç†å±‚è´Ÿè´£æœ€åå°†ä¿¡æ¯ç¼–ç æˆç”µæµè„‰å†²æˆ–å…¶å®ƒä¿¡å·ç”¨äºç½‘ä¸Šä¼ è¾“ï¼› æ•°æ®é“¾è·¯å±‚ï¼šæ•°æ®é“¾è·¯å±‚é€šè¿‡ç‰©ç†ç½‘ç»œé“¾è·¯ô°ä¾›æ•°æ®ä¼ è¾“ã€‚ä¸åŒçš„æ•°æ®é“¾è·¯å±‚å®šä¹‰äº†ä¸åŒçš„ç½‘ç»œå’Œå è®®ç‰¹å¾,å…¶ä¸­åŒ…æ‹¬ç‰©ç†ç¼–å€ã€ç½‘ç»œæ‹“æ‰‘ç»“æ„ã€é”™è¯¯æ ¡éªŒã€æ•°æ®å¸§åºåˆ—ä»¥åŠæµæ§ã€‚å¯ä»¥ç®€å•çš„ç†è§£ä¸ºï¼šè§„å®šäº†0å’Œ1çš„åˆ†åŒ…å½¢å¼ï¼Œç¡®å®šäº†ç½‘ç»œæ•°æ®åŒ…çš„å½¢å¼ï¼› ç½‘ç»œå±‚ï¼šç½‘ç»œå±‚è´Ÿè´£åœ¨æºå’Œç»ˆç‚¹ä¹‹é—´å»ºç«‹è¿æ¥ã€‚å¯ä»¥ç†è§£ä¸ºï¼Œæ­¤å¤„éœ€è¦ç¡®å®šè®¡ç®—æœºçš„ä½ç½®ï¼Œæ€ä¹ˆç¡®å®šï¼ŸIPv4ï¼ŒIPv6ï¼ ä¼ è¾“å±‚ï¼šä¼ è¾“å±‚å‘é«˜å±‚æä¾›å¯é çš„ç«¯åˆ°ç«¯çš„ç½‘ç»œæ•°æ®æµæœåŠ¡ã€‚å¯ä»¥ç†è§£ä¸ºï¼šæ¯ä¸€ä¸ªåº”ç”¨ç¨‹åºéƒ½ä¼šåœ¨ç½‘å¡æ³¨å†Œä¸€ä¸ªç«¯å£å·ï¼Œè¯¥å±‚å°±æ˜¯ç«¯å£ä¸ç«¯å£çš„é€šä¿¡ï¼å¸¸ç”¨çš„ï¼ˆTCPï¼IPï¼‰åè®®ï¼› ä¼šè¯å±‚ï¼šä¼šè¯å±‚å»ºç«‹ã€ç®¡ç†å’Œç»ˆæ­¢è¡¨ç¤ºå±‚ä¸å®ä½“ä¹‹é—´çš„é€šä¿¡ä¼šè¯ï¼›å»ºç«‹ä¸€ä¸ªè¿æ¥ï¼ˆè‡ªåŠ¨çš„æ‰‹æœºä¿¡æ¯ã€è‡ªåŠ¨çš„ç½‘ç»œå¯»å€ï¼‰; è¡¨ç¤ºå±‚ï¼šè¡¨ç¤ºå±‚æä¾›å¤šç§åŠŸèƒ½ç”¨äºåº”ç”¨å±‚æ•°æ®ç¼–ç å’Œè½¬åŒ–,ä»¥ç¡®ä¿ä»¥ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚å‘é€çš„ä¿¡æ¯ å¯ä»¥è¢«å¦ä¸€ä¸ªç³»ç»Ÿåº”ç”¨å±‚è¯†åˆ«;å¯ä»¥ç†è§£ä¸ºï¼šè§£å†³ä¸åŒç³»ç»Ÿä¹‹é—´çš„é€šä¿¡ï¼Œegï¼šLinuxä¸‹çš„QQå’ŒWindowsä¸‹çš„QQå¯ä»¥é€šä¿¡ï¼› åº”ç”¨å±‚ï¼šOSI çš„åº”ç”¨å±‚åè®®åŒ…æ‹¬æ–‡ä»¶çš„ä¼ è¾“ã€è®¿é—®åŠç®¡ç†åè®®(FTAM) ,ä»¥åŠæ–‡ä»¶è™šæ‹Ÿç»ˆç«¯åè®®(VIP)å’Œå…¬ç”¨ç®¡ç†ç³»ç»Ÿä¿¡æ¯(CMIP)ç­‰; http1.0å’Œhttp1.1åŒºåˆ«HTTP1.0æœ€æ—©åœ¨ç½‘é¡µä¸­ä½¿ç”¨æ˜¯åœ¨1996å¹´ï¼Œé‚£ä¸ªæ—¶å€™åªæ˜¯ä½¿ç”¨ä¸€äº›è¾ƒä¸ºç®€å•çš„ç½‘é¡µä¸Šå’Œç½‘ç»œè¯·æ±‚ä¸Šï¼Œè€ŒHTTP1.1åˆ™åœ¨1999å¹´æ‰å¼€å§‹å¹¿æ³›åº”ç”¨äºç°åœ¨çš„å„å¤§æµè§ˆå™¨ç½‘ç»œè¯·æ±‚ä¸­ï¼ŒåŒæ—¶HTTP1.1ä¹Ÿæ˜¯å½“å‰ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„HTTPåè®®ã€‚ ä¸»è¦åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ï¼š ç¼“å­˜å¤„ç†ï¼Œåœ¨HTTP1.0ä¸­ä¸»è¦ä½¿ç”¨headeré‡Œçš„If-Modified-Since,Expiresæ¥åšä¸ºç¼“å­˜åˆ¤æ–­çš„æ ‡å‡†ï¼ŒHTTP1.1åˆ™å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Matchç­‰æ›´å¤šå¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´æ¥æ§åˆ¶ç¼“å­˜ç­–ç•¥ã€‚ å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨ï¼ŒHTTP1.0ä¸­ï¼Œå­˜åœ¨ä¸€äº›æµªè´¹å¸¦å®½çš„ç°è±¡ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åªæ˜¯éœ€è¦æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒæœåŠ¡å™¨å´å°†æ•´ä¸ªå¯¹è±¡é€è¿‡æ¥äº†ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ åŠŸèƒ½ï¼ŒHTTP1.1åˆ™åœ¨è¯·æ±‚å¤´å¼•å…¥äº†rangeå¤´åŸŸï¼Œå®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚ é”™è¯¯é€šçŸ¥çš„ç®¡ç†ï¼Œåœ¨HTTP1.1ä¸­æ–°å¢äº†24ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ï¼Œå¦‚409ï¼ˆConflictï¼‰è¡¨ç¤ºè¯·æ±‚çš„èµ„æºä¸èµ„æºçš„å½“å‰çŠ¶æ€å‘ç”Ÿå†²çªï¼›410ï¼ˆGoneï¼‰è¡¨ç¤ºæœåŠ¡å™¨ä¸Šçš„æŸä¸ªèµ„æºè¢«æ°¸ä¹…æ€§çš„åˆ é™¤ã€‚ Hostå¤´å¤„ç†ï¼Œåœ¨HTTP1.0ä¸­è®¤ä¸ºæ¯å°æœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œå› æ­¤ï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­çš„URLå¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰ã€‚ä½†éšç€è™šæ‹Ÿä¸»æœºæŠ€æœ¯çš„å‘å±•ï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼ˆMulti-homed Web Serversï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚HTTP1.1çš„è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½åº”æ”¯æŒHostå¤´åŸŸï¼Œä¸”è¯·æ±‚æ¶ˆæ¯ä¸­å¦‚æœæ²¡æœ‰Hostå¤´åŸŸä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ï¼ˆ400 Bad Requestï¼‰ã€‚ é•¿è¿æ¥ï¼ŒHTTP 1.1æ”¯æŒé•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªHTTPè¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯Connectionï¼š keep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†HTTP1.0æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚ HTTPSä¸HTTPçš„ä¸€äº›åŒºåˆ« HTTPSåè®®éœ€è¦åˆ°CAç”³è¯·è¯ä¹¦ï¼Œä¸€èˆ¬å…è´¹è¯ä¹¦å¾ˆå°‘ï¼Œéœ€è¦äº¤è´¹ã€‚ HTTPåè®®è¿è¡Œåœ¨TCPä¹‹ä¸Šï¼Œæ‰€æœ‰ä¼ è¾“çš„å†…å®¹éƒ½æ˜¯æ˜æ–‡ï¼ŒHTTPSè¿è¡Œåœ¨SSL/TLSä¹‹ä¸Šï¼ŒSSL/TLSè¿è¡Œåœ¨TCPä¹‹ä¸Šï¼Œæ‰€æœ‰ä¼ è¾“çš„å†…å®¹éƒ½ç»è¿‡åŠ å¯†çš„ã€‚ HTTPå’ŒHTTPSä½¿ç”¨çš„æ˜¯å®Œå…¨ä¸åŒçš„è¿æ¥æ–¹å¼ï¼Œç”¨çš„ç«¯å£ä¹Ÿä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯80ï¼Œåè€…æ˜¯443ã€‚ HTTPSå¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢è¿è¥å•†åŠ«æŒï¼Œè§£å†³äº†é˜²åŠ«æŒçš„ä¸€ä¸ªå¤§é—®é¢˜ã€‚ httpä¸‰æ¬¡æ¡æ‰‹å››æ¬¡æŒ¥æ‰‹å…¶å®è¿™ä¹ˆè¯´æ˜¯ä¸å¤ªå‡†ç¡®çš„ï¼Œåº”è¯¥è¯´æ˜¯tcpåè®®å»ºç«‹è¿æ¥è¦3æ¬¡æ¡æ‰‹ï¼Œæ–­å¼€è¿æ¥è¦4æ¬¡æŒ¥æ‰‹ï¼Œè€Œhttpæ˜¯åŸºäºtcpåè®®çš„ï¼Œæ‰€ä»¥é€šå¸¸æˆ‘ä»¬ä¹Ÿè¿™ä¹ˆè¯´ï¼Œtcpå¯ä»¥æä¾›å…¨åŒå·¥çš„æ•°æ®æµä¼ è¾“æœåŠ¡ ä¸‰æ¬¡æ¡æ‰‹ TCPæœåŠ¡å™¨è¿›ç¨‹å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œæ—¶åˆ»å‡†å¤‡æ¥å—å®¢æˆ·è¿›ç¨‹çš„è¿æ¥è¯·æ±‚ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±è¿›å…¥äº†LISTENï¼ˆç›‘å¬ï¼‰çŠ¶æ€ï¼› TCPå®¢æˆ·è¿›ç¨‹ä¹Ÿæ˜¯å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œç„¶åå‘æœåŠ¡å™¨å‘å‡ºè¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼Œè¿™æ˜¯æŠ¥æ–‡é¦–éƒ¨ä¸­çš„åŒéƒ¨ä½SYN=1ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºåˆ—å· seq=x ï¼Œæ­¤æ—¶ï¼ŒTCPå®¢æˆ·ç«¯è¿›ç¨‹è¿›å…¥äº† SYN-SENTï¼ˆåŒæ­¥å·²å‘é€çŠ¶æ€ï¼‰çŠ¶æ€ã€‚TCPè§„å®šï¼ŒSYNæŠ¥æ–‡æ®µï¼ˆSYN=1çš„æŠ¥æ–‡æ®µï¼‰ä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†éœ€è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚ TCPæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚æŠ¥æ–‡åï¼Œå¦‚æœåŒæ„è¿æ¥ï¼Œåˆ™å‘å‡ºç¡®è®¤æŠ¥æ–‡ã€‚ç¡®è®¤æŠ¥æ–‡ä¸­åº”è¯¥ ACK=1ï¼ŒSYN=1ï¼Œç¡®è®¤å·æ˜¯ack=x+1ï¼ŒåŒæ—¶ä¹Ÿè¦ä¸ºè‡ªå·±åˆå§‹åŒ–ä¸€ä¸ªåºåˆ—å· seq=yï¼Œæ­¤æ—¶ï¼ŒTCPæœåŠ¡å™¨è¿›ç¨‹è¿›å…¥äº†SYN-RCVDï¼ˆåŒæ­¥æ”¶åˆ°ï¼‰çŠ¶æ€ã€‚è¿™ä¸ªæŠ¥æ–‡ä¹Ÿä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†æ˜¯åŒæ ·è¦æ¶ˆè€—ä¸€ä¸ªåºå·ã€‚ TCPå®¢æˆ·è¿›ç¨‹æ”¶åˆ°ç¡®è®¤åï¼Œè¿˜è¦å‘æœåŠ¡å™¨ç»™å‡ºç¡®è®¤ã€‚ç¡®è®¤æŠ¥æ–‡çš„ACK=1ï¼Œack=y+1ï¼Œè‡ªå·±çš„åºåˆ—å·seq=x+1ï¼Œæ­¤æ—¶ï¼ŒTCPè¿æ¥å»ºç«‹ï¼Œå®¢æˆ·ç«¯è¿›å…¥ESTABLISHEDï¼ˆå·²å»ºç«‹è¿æ¥ï¼‰çŠ¶æ€ã€‚TCPè§„å®šï¼ŒACKæŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä½†æ˜¯å¦‚æœä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·ã€‚ å½“æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¡®è®¤åä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€ï¼Œæ­¤ååŒæ–¹å°±å¯ä»¥å¼€å§‹é€šä¿¡äº†ã€‚ å››æ¬¡æŒ¥æ‰‹Dubbo æä¾›è€…(Provider)å¯åŠ¨æ—¶ï¼Œä¼šå‘æ³¨å†Œä¸­å¿ƒå†™å…¥è‡ªå·±çš„å…ƒæ•°æ®ä¿¡æ¯(è°ƒç”¨æ–¹å¼)ã€‚ æ¶ˆè´¹è€…(Consumer)å¯åŠ¨æ—¶ï¼Œä¹Ÿä¼šåœ¨æ³¨å†Œä¸­å¿ƒå†™å…¥è‡ªå·±çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¹¶ä¸”è®¢é˜…æœåŠ¡æä¾›è€…ï¼Œè·¯ç”±å’Œé…ç½®å…ƒæ•°æ®çš„ä¿¡æ¯ã€‚ æœåŠ¡æ²»ç†ä¸­å¿ƒ(duubo-admin)å¯åŠ¨æ—¶ï¼Œä¼šåŒæ—¶è®¢é˜…æ‰€æœ‰æ¶ˆè´¹è€…ï¼Œæä¾›è€…ï¼Œè·¯ç”±å’Œé…ç½®å…ƒæ•°æ®çš„ä¿¡æ¯ã€‚ å½“æä¾›è€…ç¦»å¼€æˆ–è€…æ–°æä¾›è€…åŠ å…¥æ—¶ï¼Œæ³¨å†Œä¸­å¿ƒå‘ç°å˜åŒ–ä¼šé€šçŸ¥æ¶ˆè´¹è€…å’ŒæœåŠ¡æ²»ç†ä¸­å¿ƒã€‚ NettyNIOä¸‰å¤§æ ¸å¿ƒç»„ä»¶ Channel(é€šé“)ï¼Œ Buffer(ç¼“å†²åŒº)ï¼ŒSelector(å¤šè·¯å¤ç”¨å™¨) channel ç±»ä¼¼äºæµï¼Œæ¯ä¸ª channel å¯¹åº”ä¸€ä¸ª bufferç¼“å†²åŒºï¼Œbuffer åº•å±‚å°±æ˜¯ä¸ªæ•°ç»„ channel ä¼šæ³¨å†Œåˆ° selector ä¸Šï¼Œç”± selector æ ¹æ® channel è¯»å†™äº‹ä»¶çš„å‘ç”Ÿå°†å…¶äº¤ç”±æŸä¸ªç©ºé—²çš„çº¿ç¨‹å¤„ç† NIO çš„ Buffer å’Œ channel éƒ½æ˜¯æ—¢å¯ä»¥è¯»ä¹Ÿå¯ä»¥å†™ Nettyçº¿ç¨‹æ¨¡å‹Nettyé€šè¿‡Reactoræ¨¡å‹åŸºäºå¤šè·¯å¤ç”¨å™¨æ¥æ”¶å¹¶å¤„ç†ç”¨æˆ·è¯·æ±‚ï¼Œå†…éƒ¨å®ç°bosså’Œworkä¸¤ä¸ªçº¿ç¨‹æ± ï¼Œå…¶ä¸­bossçš„çº¿ç¨‹è´Ÿè´£å¤„ç†è¯·æ±‚çš„acceptäº‹ä»¶ï¼Œå½“æ¥æ”¶åˆ°acceptäº‹ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæŠŠå¯¹åº”çš„socketå°è£…åˆ°ä¸€ä¸ªNioSocketChannelä¸­ï¼Œå¹¶äº¤ç»™workçº¿ç¨‹æ± ï¼Œå…¶ä¸­workçº¿ç¨‹æ± è´Ÿè´£è¯·æ±‚çš„readå’Œwriteäº‹ä»¶ï¼Œäº¤ç”±å¯¹åº”çš„Handlerå¤„ç†ã€‚ Netty æŠ½è±¡å‡ºä¸¤ç»„çº¿ç¨‹æ± BossGroupå’ŒWorkerGroupï¼ŒBossGroupä¸“é—¨è´Ÿè´£æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥, WorkerGroupä¸“é—¨è´Ÿè´£ç½‘ç»œçš„è¯»å†™ BossGroupå’ŒWorkerGroupç±»å‹éƒ½æ˜¯NioEventLoopGroup NioEventLoopGroup ç›¸å½“äºä¸€ä¸ªäº‹ä»¶å¾ªç¯çº¿ç¨‹ç»„, è¿™ä¸ªç»„ä¸­å«æœ‰å¤šä¸ªäº‹ä»¶å¾ªç¯çº¿ç¨‹ ï¼Œ æ¯ä¸€ä¸ªäº‹ä»¶å¾ªç¯çº¿ç¨‹æ˜¯NioEventLoop æ¯ä¸ªNioEventLoopéƒ½æœ‰ä¸€ä¸ªselector , ç”¨äºç›‘å¬æ³¨å†Œåœ¨å…¶ä¸Šçš„socketChannelçš„ç½‘ç»œé€šè®¯ æ¯ä¸ªBossNioEventLoopçº¿ç¨‹å†…éƒ¨å¾ªç¯æ‰§è¡Œçš„æ­¥éª¤æœ‰ 3 æ­¥ å¤„ç†acceptäº‹ä»¶ , ä¸client å»ºç«‹è¿æ¥ , ç”Ÿæˆ NioSocketChannel å°†NioSocketChannelæ³¨å†Œåˆ°æŸä¸ªworker NIOEventLoopä¸Šçš„selector å¤„ç†ä»»åŠ¡é˜Ÿåˆ—çš„ä»»åŠ¡ ï¼Œ å³runAllTasks æ¯ä¸ªworkerNIOEventLoopçº¿ç¨‹å¾ªç¯æ‰§è¡Œçš„æ­¥éª¤ è½®è¯¢æ³¨å†Œåˆ°è‡ªå·±selectorä¸Šçš„æ‰€æœ‰NioSocketChannel çš„read, writeäº‹ä»¶ å¤„ç† I/O äº‹ä»¶ï¼Œ å³read , write äº‹ä»¶ï¼Œ åœ¨å¯¹åº”NioSocketChannel å¤„ç†ä¸šåŠ¡ runAllTaskså¤„ç†ä»»åŠ¡é˜Ÿåˆ—TaskQueueçš„ä»»åŠ¡ ï¼Œä¸€äº›è€—æ—¶çš„ä¸šåŠ¡å¤„ç†ä¸€èˆ¬å¯ä»¥æ”¾å…¥TaskQueueä¸­æ…¢æ…¢å¤„ç†ï¼Œè¿™æ ·ä¸å½±å“æ•°æ®åœ¨ pipeline ä¸­çš„æµåŠ¨å¤„ç† Nettyæ¨¡å—ç»„ä»¶ Bootstrapã€ServerBootstrapï¼šBootstrap æ„æ€æ˜¯å¼•å¯¼ï¼Œä¸€ä¸ª Netty åº”ç”¨é€šå¸¸ç”±ä¸€ä¸ª Bootstrap å¼€å§‹ï¼Œä¸»è¦ä½œç”¨æ˜¯é…ç½®æ•´ä¸ª Netty ç¨‹åºï¼Œä¸²è”å„ä¸ªç»„ä»¶ï¼ŒNetty ä¸­ Bootstrap ç±»æ˜¯å®¢æˆ·ç«¯ç¨‹åºçš„å¯åŠ¨å¼•å¯¼ç±»ï¼ŒServerBootstrap æ˜¯æœåŠ¡ç«¯å¯åŠ¨å¼•å¯¼ç±»ã€‚ Futureã€ChannelFutureï¼šæ­£å¦‚å‰é¢ä»‹ç»ï¼Œåœ¨ Netty ä¸­æ‰€æœ‰çš„ IO æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„ï¼Œä¸èƒ½ç«‹åˆ»å¾—çŸ¥æ¶ˆæ¯æ˜¯å¦è¢«æ­£ç¡®å¤„ç†ã€‚ä½†æ˜¯å¯ä»¥è¿‡ä¸€ä¼šç­‰å®ƒæ‰§è¡Œå®Œæˆæˆ–è€…ç›´æ¥æ³¨å†Œä¸€ä¸ªç›‘å¬ï¼Œå…·ä½“çš„å®ç°å°±æ˜¯é€šè¿‡ Future å’Œ ChannelFuturesï¼Œä»–ä»¬å¯ä»¥æ³¨å†Œä¸€ä¸ªç›‘å¬ï¼Œå½“æ“ä½œæ‰§è¡ŒæˆåŠŸæˆ–å¤±è´¥æ—¶ç›‘å¬ä¼šè‡ªåŠ¨è§¦å‘æ³¨å†Œçš„ç›‘å¬äº‹ä»¶ã€‚ Channelï¼šNetty ç½‘ç»œé€šä¿¡çš„ç»„ä»¶ï¼Œèƒ½å¤Ÿç”¨äºæ‰§è¡Œç½‘ç»œ I/O æ“ä½œã€‚Channel ä¸ºç”¨æˆ·æä¾›ï¼š å½“å‰ç½‘ç»œè¿æ¥çš„é€šé“çš„çŠ¶æ€ï¼ˆä¾‹å¦‚æ˜¯å¦æ‰“å¼€ï¼Ÿæ˜¯å¦å·²è¿æ¥ï¼Ÿï¼‰ ç½‘ç»œè¿æ¥çš„é…ç½®å‚æ•° ï¼ˆä¾‹å¦‚æ¥æ”¶ç¼“å†²åŒºå¤§å°ï¼‰ æä¾›å¼‚æ­¥çš„ç½‘ç»œ I/O æ“ä½œ(å¦‚å»ºç«‹è¿æ¥ï¼Œè¯»å†™ï¼Œç»‘å®šç«¯å£)ï¼Œå¼‚æ­¥è°ƒç”¨æ„å‘³ç€ä»»ä½• I/O è°ƒç”¨éƒ½å°†ç«‹å³è¿”å›ï¼Œå¹¶ä¸”ä¸ä¿è¯åœ¨è°ƒç”¨ç»“æŸæ—¶æ‰€è¯·æ±‚çš„ I/O æ“ä½œå·²å®Œæˆã€‚ è°ƒç”¨ç«‹å³è¿”å›ä¸€ä¸ª ChannelFuture å®ä¾‹ï¼Œé€šè¿‡æ³¨å†Œç›‘å¬å™¨åˆ° ChannelFuture ä¸Šï¼Œå¯ä»¥ I/O æ“ä½œæˆåŠŸã€å¤±è´¥æˆ–å–æ¶ˆæ—¶å›è°ƒé€šçŸ¥è°ƒç”¨æ–¹ã€‚ æ”¯æŒå…³è” I/O æ“ä½œä¸å¯¹åº”çš„å¤„ç†ç¨‹åºã€‚ ä¸åŒåè®®ã€ä¸åŒçš„é˜»å¡ç±»å‹çš„è¿æ¥éƒ½æœ‰ä¸åŒçš„ Channel ç±»å‹ä¸ä¹‹å¯¹åº”ã€‚ NioSocketChannelï¼Œå¼‚æ­¥çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥ã€‚ NioServerSocketChannelï¼Œå¼‚æ­¥çš„æœåŠ¡å™¨ç«¯ TCP Socket è¿æ¥ã€‚ NioDatagramChannelï¼Œå¼‚æ­¥çš„ UDP è¿æ¥ã€‚ NioSctpChannelï¼Œå¼‚æ­¥çš„å®¢æˆ·ç«¯ Sctp è¿æ¥ã€‚ NioSctpServerChannelï¼Œå¼‚æ­¥çš„ Sctp æœåŠ¡å™¨ç«¯è¿æ¥ã€‚ è¿™äº›é€šé“æ¶µç›–äº† UDP å’Œ TCP ç½‘ç»œ IO ä»¥åŠæ–‡ä»¶ IOã€‚ Selectorï¼šNetty åŸºäº Selector å¯¹è±¡å®ç° I/O å¤šè·¯å¤ç”¨ï¼Œé€šè¿‡ Selector ä¸€ä¸ªçº¿ç¨‹å¯ä»¥ç›‘å¬å¤šä¸ªè¿æ¥çš„ Channel äº‹ä»¶ã€‚å½“å‘ä¸€ä¸ª Selector ä¸­æ³¨å†Œ Channel åï¼ŒSelector å†…éƒ¨çš„æœºåˆ¶å°±å¯ä»¥è‡ªåŠ¨ä¸æ–­åœ°æŸ¥è¯¢(Select) è¿™äº›æ³¨å†Œçš„ Channel æ˜¯å¦æœ‰å·²å°±ç»ªçš„ I/O äº‹ä»¶ï¼ˆä¾‹å¦‚å¯è¯»ï¼Œå¯å†™ï¼Œç½‘ç»œè¿æ¥å®Œæˆç­‰ï¼‰ï¼Œè¿™æ ·ç¨‹åºå°±å¯ä»¥å¾ˆç®€å•åœ°ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹é«˜æ•ˆåœ°ç®¡ç†å¤šä¸ª Channel ã€‚ NioEventLoopï¼šNioEventLoop ä¸­ç»´æŠ¤äº†ä¸€ä¸ªçº¿ç¨‹å’Œä»»åŠ¡é˜Ÿåˆ—ï¼Œæ”¯æŒå¼‚æ­¥æäº¤æ‰§è¡Œä»»åŠ¡ï¼Œçº¿ç¨‹å¯åŠ¨æ—¶ä¼šè°ƒç”¨ NioEventLoop çš„ run æ–¹æ³•ï¼Œæ‰§è¡Œ I/O ä»»åŠ¡å’Œé I/O ä»»åŠ¡ï¼šI/O ä»»åŠ¡ï¼Œå³ selectionKey ä¸­ ready çš„äº‹ä»¶ï¼Œå¦‚ acceptã€connectã€readã€write ç­‰ï¼Œç”± processSelectedKeys æ–¹æ³•è§¦å‘ã€‚é IO ä»»åŠ¡ï¼Œæ·»åŠ åˆ° taskQueue ä¸­çš„ä»»åŠ¡ï¼Œå¦‚ register0ã€bind0 ç­‰ä»»åŠ¡ï¼Œç”± runAllTasks æ–¹æ³•è§¦å‘ã€‚ NioEventLoopGroupï¼šNioEventLoopGroupï¼Œä¸»è¦ç®¡ç† eventLoop çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå†…éƒ¨ç»´æŠ¤äº†ä¸€ç»„çº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹(NioEventLoop)è´Ÿè´£å¤„ç†å¤šä¸ª Channel ä¸Šçš„äº‹ä»¶ï¼Œè€Œä¸€ä¸ª Channel åªå¯¹åº”äºä¸€ä¸ªçº¿ç¨‹ã€‚ ChannelHandlerï¼šChannelHandler æ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¤„ç† I/O äº‹ä»¶æˆ–æ‹¦æˆª I/O æ“ä½œï¼Œå¹¶å°†å…¶è½¬å‘åˆ°å…¶ ChannelPipeline(ä¸šåŠ¡å¤„ç†é“¾)ä¸­çš„ä¸‹ä¸€ä¸ªå¤„ç†ç¨‹åºã€‚ ChannelHandlerContextï¼šä¿å­˜ Channel ç›¸å…³çš„æ‰€æœ‰ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼ŒåŒæ—¶å…³è”ä¸€ä¸ª ChannelHandler å¯¹è±¡ã€‚ ChannelPiplineï¼šä¿å­˜ ChannelHandler çš„ Listï¼Œç”¨äºå¤„ç†æˆ–æ‹¦æˆª Channel çš„å…¥ç«™äº‹ä»¶å’Œå‡ºç«™æ“ä½œã€‚ChannelPipeline å®ç°äº†ä¸€ç§é«˜çº§å½¢å¼çš„æ‹¦æˆªè¿‡æ»¤å™¨æ¨¡å¼ï¼Œä½¿ç”¨æˆ·å¯ä»¥å®Œå…¨æ§åˆ¶äº‹ä»¶çš„å¤„ç†æ–¹å¼ï¼Œä»¥åŠ Channel ä¸­å„ä¸ªçš„ ChannelHandler å¦‚ä½•ç›¸äº’äº¤äº’ã€‚åœ¨ Netty ä¸­æ¯ä¸ª Channel éƒ½æœ‰ä¸”ä»…æœ‰ä¸€ä¸ª ChannelPipeline ä¸ä¹‹å¯¹åº”ï¼Œå®ƒä»¬çš„ç»„æˆå…³ç³»å¦‚ä¸‹ï¼š ä¸€ä¸ª Channel åŒ…å«äº†ä¸€ä¸ª ChannelPipelineï¼Œè€Œ ChannelPipeline ä¸­åˆç»´æŠ¤äº†ä¸€ä¸ªç”± ChannelHandlerContext ç»„æˆçš„åŒå‘é“¾è¡¨ï¼Œå¹¶ä¸”æ¯ä¸ª ChannelHandlerContext ä¸­åˆå…³è”ç€ä¸€ä¸ª ChannelHandlerã€‚readäº‹ä»¶(å…¥ç«™äº‹ä»¶)å’Œwriteäº‹ä»¶(å‡ºç«™äº‹ä»¶)åœ¨ä¸€ä¸ªåŒå‘é“¾è¡¨ä¸­ï¼Œå…¥ç«™äº‹ä»¶ä¼šä»é“¾è¡¨ head å¾€åä¼ é€’åˆ°æœ€åä¸€ä¸ªå…¥ç«™çš„ handlerï¼Œå‡ºç«™äº‹ä»¶ä¼šä»é“¾è¡¨ tail å¾€å‰ä¼ é€’åˆ°æœ€å‰ä¸€ä¸ªå‡ºç«™çš„ handlerï¼Œä¸¤ç§ç±»å‹çš„ handler äº’ä¸å¹²æ‰°ã€‚ Nettyç²˜åŒ…æ‹†åŒ…TCPæ˜¯ä¸€ä¸ªæµåè®®ï¼Œå°±æ˜¯æ²¡æœ‰ç•Œé™çš„ä¸€é•¿ä¸²äºŒè¿›åˆ¶æ•°æ®ã€‚TCPä½œä¸ºä¼ è¾“å±‚åè®®å¹¶ä¸ä¸äº†è§£ä¸Šå±‚ä¸šåŠ¡æ•°æ®çš„å…·ä½“å«ä¹‰ï¼Œå®ƒä¼šæ ¹æ®TCPç¼“å†²åŒºçš„å®é™…æƒ…å†µè¿›è¡Œæ•°æ®åŒ…çš„åˆ’åˆ†ï¼Œæ‰€ä»¥åœ¨ä¸šåŠ¡ä¸Šè®¤ä¸ºæ˜¯ä¸€ä¸ªå®Œæ•´çš„åŒ…ï¼Œå¯èƒ½ä¼šè¢«TCPæ‹†åˆ†æˆå¤šä¸ªåŒ…è¿›è¡Œå‘é€ï¼Œä¹Ÿæœ‰å¯èƒ½æŠŠå¤šä¸ªå°çš„åŒ…å°è£…æˆä¸€ä¸ªå¤§çš„æ•°æ®åŒ…å‘é€ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„TCPç²˜åŒ…å’Œæ‹†åŒ…é—®é¢˜ã€‚é¢å‘æµçš„é€šä¿¡æ˜¯æ— æ¶ˆæ¯ä¿æŠ¤è¾¹ç•Œçš„ã€‚ è§£å†³æ–¹æ¡ˆ æ¶ˆæ¯å®šé•¿åº¦ï¼Œä¼ è¾“çš„æ•°æ®å¤§å°å›ºå®šé•¿åº¦ï¼Œä¾‹å¦‚æ¯æ®µçš„é•¿åº¦å›ºå®šä¸º100å­—èŠ‚ï¼Œå¦‚æœä¸å¤Ÿç©ºä½è¡¥ç©ºæ ¼ åœ¨æ•°æ®åŒ…å°¾éƒ¨æ·»åŠ ç‰¹æ®Šåˆ†éš”ç¬¦ï¼Œæ¯”å¦‚ä¸‹åˆ’çº¿ï¼Œä¸­åˆ’çº¿ç­‰ï¼Œè¿™ç§æ–¹æ³•ç®€å•æ˜“è¡Œï¼Œä½†é€‰æ‹©åˆ†éš”ç¬¦çš„æ—¶å€™ä¸€å®šè¦æ³¨æ„æ¯æ¡æ•°æ®çš„å†…éƒ¨ä¸€å®šä¸èƒ½å‡ºç°åˆ†éš”ç¬¦ã€‚ å‘é€é•¿åº¦ï¼šå‘é€æ¯æ¡æ•°æ®çš„æ—¶å€™ï¼Œå°†æ•°æ®çš„é•¿åº¦ä¸€å¹¶å‘é€ï¼Œæ¯”å¦‚å¯ä»¥é€‰æ‹©æ¯æ¡æ•°æ®çš„å‰4ä½æ˜¯æ•°æ®çš„é•¿åº¦ï¼Œåº”ç”¨å±‚å¤„ç†æ—¶å¯ä»¥æ ¹æ®é•¿åº¦æ¥åˆ¤æ–­æ¯æ¡æ•°æ®çš„å¼€å§‹å’Œç»“æŸã€‚ Nettyæä¾›äº†å¤šä¸ªè§£ç å™¨ï¼Œå¯ä»¥è¿›è¡Œåˆ†åŒ…çš„æ“ä½œï¼Œå¦‚ä¸‹ï¼š LineBasedFrameDecoder ï¼ˆå›è½¦æ¢è¡Œåˆ†åŒ…ï¼‰ DelimiterBasedFrameDecoderï¼ˆç‰¹æ®Šåˆ†éš”ç¬¦åˆ†åŒ…ï¼‰ FixedLengthFrameDecoderï¼ˆå›ºå®šé•¿åº¦æŠ¥æ–‡æ¥åˆ†åŒ…ï¼‰ æ•°æ®åº“ACIDç†è®ºâ€‹ äº‹åŠ¡å¤„ç†å‡ ä¹æ˜¯æ¯ä¸€ä¸ªä¿¡æ¯ç³»ç»Ÿä¸­éƒ½ä¼šæ¶‰åŠåˆ°çš„é—®é¢˜ï¼Œå®ƒå­˜åœ¨çš„æ„ä¹‰å°±æ˜¯ä¿è¯ç³»ç»Ÿä¸­çš„æ•°æ®æ˜¯æ­£ç¡®çš„ï¼Œä¸åŒæ•°æ®é—´ä¸ä¼šäº§ç”ŸçŸ›ç›¾ï¼Œä¹Ÿå°±æ˜¯ä¿è¯æ•°æ®çŠ¶æ€çš„ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œç†è®ºä¸Šï¼Œè¦è¾¾æˆè¿™ä¸ªç›®æ ‡éœ€è¦ä¸‰æ–¹é¢çš„å…±åŒåŠªåŠ›ï¼š åŸå­æ€§ï¼ˆAtomicï¼‰ï¼šåœ¨åŒä¸€é¡¹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡ä¿è¯äº†å¤šä¸ªå¯¹æ•°æ®çš„ä¿®æ”¹ï¼Œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆä¸€èµ·è¢«æ’¤é”€ã€‚åŸå­æ€§æ˜¯ç”±undologæ—¥å¿—æ¥ä¿è¯çš„ï¼Œå®ƒè®°å½•äº†éœ€è¦å›æ»šçš„æ—¥å¿—ä¿¡æ¯ï¼Œäº‹åŠ¡å›æ»šæ—¶ï¼Œæ’¤é”€å·²ç»æ‰§è¡ŒæˆåŠŸçš„sqlã€‚ éš”ç¦»æ€§ï¼ˆIsolationï¼‰ï¼šåœ¨ä¸åŒçš„ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ä¸­ï¼Œäº‹åŠ¡ä¿è¯äº†å„è‡ªä¸šåŠ¡æ­£åœ¨è¯»ã€å†™çš„æ•°æ®äº’ç›¸ç‹¬ç«‹ï¼Œä¸ä¼šå½¼æ­¤å½±å“ã€‚éš”ç¦»æ€§æ˜¯ç”±MVCCæ¥ä¿è¯çš„ã€‚ æŒä¹…æ€§ï¼ˆDurabilityï¼‰ï¼šäº‹åŠ¡åº”å½“ä¿è¯æ‰€æœ‰è¢«æˆåŠŸæäº¤çš„æ•°æ®ä¿®æ”¹éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°è¢«æŒä¹…åŒ–ï¼Œä¸ä¸¢å¤±æ•°æ®ã€‚æŒä¹…æ€§ç”±redologæ¥ä¿è¯çš„ï¼Œmysqlä¿®æ”¹æ•°æ®çš„æ—¶å€™ä¼šåœ¨redologä¸­è®°å½•ä¸€ä»½æ—¥å¿—æ•°æ®ï¼Œå°±ç®—æ•°æ®æ²¡æœ‰ä¿å­˜æˆåŠŸï¼Œåªè¦æ—¥å¿—ä¿å­˜æˆåŠŸäº†ï¼Œæ•°æ®ä»ç„¶ä¸ä¼šä¸¢å¤±ã€‚ ä»¥ä¸Šå°±æ˜¯äº‹åŠ¡çš„â€œACIDâ€çš„æ¦‚å¿µææ³•ã€‚æˆ‘è‡ªå·±å¯¹è¿™ç§å·²ç»å½¢æˆä¹ æƒ¯çš„â€œACIDâ€çš„ææ³•æ˜¯ä¸å¤ªè®¤åŒçš„ï¼Œå› ä¸ºè¿™å››ç§ç‰¹æ€§å¹¶ä¸æ­£äº¤ï¼ŒAã€Iã€D æ˜¯æ‰‹æ®µï¼ŒC æ˜¯ç›®çš„ï¼Œå®Œå…¨æ˜¯ä¸ºäº†æ‹¼å‡‘ä¸ªå•è¯ç¼©å†™æ‰å¼„åˆ°ä¸€å—å»ï¼Œè¯¯å¯¼çš„å¼Šç«¯å·²ç»è¶…è¿‡äº†æ˜“äºä¼ æ’­çš„å¥½å¤„ã€‚ Mysqlç´¢å¼•ç»“æ„mysqlçš„ç´¢å¼•ç»“æ„æœ‰ï¼šäºŒå‰æ ‘ã€çº¢é»‘æ ‘ã€hashè¡¨ã€BTreeã€B+Tree äºŒå‰æ ‘ Hashè¡¨ B+Tree InnoDBå’ŒMyISAMåŒºåˆ« åŒºåˆ« InnoDB MyISAM äº‹åŠ¡ æ”¯æŒ ä¸æ”¯æŒ å¤–é”® æ”¯æŒ ä¸æ”¯æŒ ç´¢å¼• èšç°‡ç´¢å¼•å’Œéèšç°‡ç´¢å¼• éèšç°‡ç´¢å¼• è¡Œé” æ”¯æŒ ä¸æ”¯æŒ è¡¨é” æ”¯æŒ æ”¯æŒ å­˜å‚¨æ–‡ä»¶ frm(è¡¨ç»“æ„)ï¼Œibd(æ•°æ®å’Œç´¢å¼•) frmï¼Œmyi(ç´¢å¼•æ–‡ä»¶)ï¼Œmyd(æ•°æ®æ–‡ä»¶) å…·ä½“è¡Œæ•° å…¨è¡¨æ‰«æç»Ÿè®¡è¡Œæ•° é€šè¿‡å˜é‡ä¿å­˜è¡Œæ•° MyISAMä¸æ”¯æŒäº‹åŠ¡ï¼Œåœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥SELECTå‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”,åœ¨æ‰§è¡Œupdateã€insertã€deleteæ“ä½œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ã€‚ InnoDBåœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥SELECTæ—¶(éä¸²è¡Œéš”ç¦»çº§åˆ«)ï¼Œ(å› ä¸ºæœ‰mvccæœºåˆ¶)ä¸ä¼šåŠ é”ã€‚ä½†æ˜¯updateã€insertã€deleteæ“ä½œä¼šåŠ è¡Œé”ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå°±æ˜¯è¯»é”ä¼šé˜»å¡å†™ï¼Œä½†æ˜¯ä¸ä¼šé˜»å¡è¯»ã€‚è€Œå†™é”åˆ™ä¼šæŠŠè¯»å’Œå†™éƒ½é˜»å¡ã€‚ Bæ ‘å’ŒB+æ•°çš„åŒºåˆ«B-Tree B+Tree(B-Treeå˜ç§) B+Treeéå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨dataï¼Œåªå­˜å‚¨å†—ä½™ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹åŒ…å«æ‰€æœ‰ç´¢å¼•å­—æ®µ ã€‚ä¼˜ç‚¹ï¼šå¯ä»¥æ”¾æ›´å¤šçš„ç´¢å¼•ï¼ŒBTreeéå¶å­èŠ‚ç‚¹ä¼šå­˜å‚¨ç´¢å¼•å’Œæ•°æ® B+Treeå¶å­èŠ‚ç‚¹ç”¨æŒ‡é’ˆè¿æ¥ã€‚ä¼˜ç‚¹ï¼šæé«˜åŒºé—´è®¿é—®çš„æ€§èƒ½ï¼ˆèŒƒå›´æŸ¥æ‰¾ï¼‰ï¼ŒBTreeå¶å­èŠ‚ç‚¹æŒ‡é’ˆä¸ºç©º äº‹åŠ¡éš”ç¦»çº§åˆ« äº‹åŠ¡éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯» è¯»æœªæäº¤ï¼ˆread-uncomm è¯»å·²æäº¤ï¼ˆread-committedï¼‰ å¦ æ˜¯ æ˜¯ å¯é‡å¤è¯»ï¼ˆrepeatable-readï¼‰ mysqlé»˜è®¤ å¦ å¦ æ˜¯ ä¸²è¡ŒåŒ–ï¼ˆserializableï¼‰ å¦ å¦ å¦ Mysqlåœ¨å¯é‡å¤åº¦éš”ç¦»çº§åˆ«ä¸‹é€šè¿‡MVCCä¿è¯äº‹åŠ¡éš”ç¦»æ€§ å¹»è¯»æ˜¯æŒ‡å½“ä¸€ä¸ªäº‹åŠ¡Aè¯»å–æŸä¸€ä¸ªèŒƒå›´çš„æ•°æ®æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡Båœ¨è¿™ä¸ªèŒƒå›´æ’å…¥è¡Œï¼ŒAäº‹åŠ¡å†æ¬¡è¯»å–è¿™ä¸ªèŒƒå›´æ•°æ®æ—¶ï¼Œä¼šäº§ç”Ÿå¹»è¯» Mysqlå¹»è¯»æ˜¯æ€ä¹ˆè§£å†³çš„é¦–å…ˆè¦ç¡®è®¤ä¸€ä¸‹å¹»è¯»æ˜¯æ€ä¹ˆäº§ç”Ÿçš„ï¼Œå…ˆå¼„æ¸…ä¸¤ä¸ªæ¦‚å¿µï¼Œé‚£å°±æ˜¯å½“å‰è¯»å’Œå¿«ç…§è¯» å½“å‰è¯» åƒselect lock in share mode(å…±äº«é”)ï¼Œselect for updateï¼Œupdateï¼Œinsertï¼Œdeleteï¼ˆæ’ä»–é”ï¼‰è¿™äº›æ“ä½œéƒ½æ˜¯ä¸€ç§å½“å‰è¯»ï¼Œä¸ºä»€ä¹ˆå«å½“å‰è¯»ï¼Ÿå°±æ˜¯ä»–è¯»å–çš„æ˜¯è®°å½•çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè¯»å–æ—¶è¿˜è¦ä¿è¯å…¶ä»–å¹¶å‘äº‹åŠ¡ä¸èƒ½ä¿®æ”¹å½“å‰è®°å½•ï¼Œä¼šå¯¹è¯»å–è®°å½•è¿›è¡ŒåŠ é” å¿«ç…§è¯» â€‹ åƒä¸åŠ é”çš„selectæ“ä½œå°±æ˜¯å¿«ç…§è¯»ï¼Œä¹Ÿå°±æ˜¯ä¸åŠ é”çš„éé˜»å¡è¯»ï¼›å¿«ç…§è¯»çš„å‰ææ˜¯éš”ç¦»çº§åˆ«ä¸æ˜¯ä¸²è¡ŒåŒ–ï¼Œä¸²è¡Œçº§åˆ«çš„å¿«ç…§è¯»ä¼šé€€åŒ–æˆå½“å‰è¯»ï¼Œå¿«ç…§è¯»çš„å®ç°æ˜¯åŸºäºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯MVCCï¼Œå¯ä»¥è®¤ä¸ºMVCCæ˜¯è¡Œé”çš„ä¸€ä¸ªå˜ç§ï¼Œä½†æ˜¯å¾ˆå¤šæƒ…å†µä¸‹é¿å…åŠ é”æ“ä½œï¼Œå¿«ç…§è¯»å¯èƒ½è¯»åˆ°çš„å¹¶ä¸ä¸€å®šæ˜¯æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè€Œæœ‰å¯èƒ½æ˜¯ä¹‹å‰çš„å†å²ç‰ˆæœ¬ å¦‚æœåªæœ‰å¿«ç…§è¯»æ˜¯ä¸ä¼šäº§ç”Ÿå¹»è¯»é—®é¢˜ï¼Œåªæœ‰å¿«ç…§è¯»å’Œå½“å‰è¯»ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™æ‰ä¼šäº§ç”Ÿå¹»è¯»ã€‚ Mysqlåœ¨å¯é‡å¤åº¦éš”ç¦»çº§åˆ«ä¸‹å¯ä»¥é€šè¿‡MVCCå’Œä¸´é”®é”ï¼ˆè®°å½•é”+é—´éš™é”ï¼‰è§£å†³å¹»è¯»é—®é¢˜ã€‚ MVCCå¯¹äºmvccçš„ç†è§£ï¼Œå¯ä»¥ä»æ•°æ®åº“ä¸‰ç§å¹¶å‘åœºæ™¯æ¥è¯´ ç¬¬ä¸€ç§æ˜¯è¯»å’Œè¯»çš„å¹¶å‘ï¼šå°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBåŒæ—¶è¿›è¡Œè¯»æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹å‘¢ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•çš„å¹¶å‘é—®é¢˜ ç¬¬äºŒç§æ˜¯è¯»å†™å¹¶å‘ï¼šå°±æ˜¯è¯´ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBåœ¨åŒä¸€æ—¶åˆ»åˆ†åˆ«è¿›è¡Œè¯»å†™æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¼šå¯¹æ•°æ®åº“çš„æ•°æ®é€ æˆä¸€äº›é—®é¢˜ï¼Œç¬¬ä¸€ã€äº‹åŠ¡éš”ç¦»æ€§é—®é¢˜ï¼›ç¬¬äºŒã€ä¼šé€ æˆè„è¯»ï¼Œå¹»è¯»ï¼Œä¸å¯é‡å¤è¯»çš„é—®é¢˜ ç¬¬ä¸‰ç§æ˜¯å†™å’Œå†™çš„å¹¶å‘ï¼šå°±æ˜¯ä¸¤ä¸ªçº¿ç¨‹Aå’ŒBåŒæ—¶è¿›è¡Œå†™æ“ä½œï¼Œè¿™ç§æƒ…å†µä¸‹å¯èƒ½ä¼šå­˜åœ¨æ•°æ®æ›´æ–°çš„ä¸¢å¤±é—®é¢˜ MVCCå°±æ˜¯ä¸ºäº†è§£å†³äº‹åŠ¡æ“ä½œä¸­å¹¶å‘å®‰å…¨é—®é¢˜çš„ï¼Œæ— é”å¹¶å‘æ§åˆ¶æŠ€æœ¯ï¼Œå…¨ç§°å°±æ˜¯ï¼šå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œä»–æ˜¯é€šè¿‡æ•°æ®åº“è®°å½•ä¸­çš„éšå¼å­—æ®µUndoæ—¥å¿—å’ŒReadViewæ¥å®ç°çš„ï¼ŒMVCCä¸»è¦è§£å†³ä¸‰ä¸ªé—®é¢˜ï¼šç¬¬ä¸€ã€é€šè¿‡MVCCå¯ä»¥è§£å†³è¯»å†™å¹¶å‘é˜»å¡é—®é¢˜ï¼Œä»è€Œæé«˜æ•°æ®åº“çš„å¹¶å‘å¤„ç†èƒ½åŠ›ï¼›ç¬¬äºŒã€MVCCé‡‡ç”¨çš„æ˜¯ä¹è§‚é”çš„æ–¹å¼å®ç°ï¼Œé™ä½äº†æ­»é”çš„æ¦‚ç‡ï¼›ç¬¬ä¸‰ã€è§£å†³äº†ä¸€è‡´æ€§è¯»çš„é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯äº‹åŠ¡å¯åŠ¨çš„æ—¶å€™ï¼Œæ ¹æ®æŸä¸ªæ¡ä»¶å»è¯»å–åˆ°çš„æ•°æ®ï¼ŒçŸ¥é“äº‹åŠ¡ç»“æŸçš„æ—¶å€™å†å»æ‰§è¡Œç›¸åŒæ¡ä»¶ï¼Œè¿˜æ˜¯è¯»åˆ°åŒä¸€ä»½æ•°æ®ï¼Œä¸ä¼šå‘ç”Ÿå˜åŒ–å˜åŒ–ï¼Œè€Œæˆ‘ä»¬åœ¨ä½¿ç”¨MVCCçš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯æ ¹æ®ä¸šåŠ¡åœºæ™¯æ¥é€‰æ‹©ç»„åˆæ­é…ï¼Œä¹è§‚é”æˆ–è€…æ‚²è§‚é”ï¼ŒMVCCç”¨æ¥è§£å†³è¯»å†™å†²çªï¼Œè€Œä¹è§‚é”æ‚²è§‚é”ç”¨æ¥è§£å†³å†™å’Œå†™çš„å†²çªï¼Œä»è€Œæœ€å¤§ç¨‹åº¦å»æé«˜æ•°æ®åº“çš„å¹¶å‘æ€§èƒ½ã€‚ ä»€ä¹ˆåœºæ™¯ä¼šå¼•å‘å¹»è¯»å¹»è¯»æ˜¯æŒ‡åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå­˜åœ¨å‰åä¸¤æ¬¡æŸ¥è¯¢åŒä¸€ä¸ªèŒƒå›´çš„æ•°æ®ï¼Œä½†æ˜¯ç¬¬äºŒæ¬¡æŸ¥è¯¢å´çœ‹åˆ°äº†ç¬¬ä¸€æ¬¡æŸ¥è¯¢æ²¡çœ‹åˆ°çš„è¡Œï¼Œä¸€èˆ¬æƒ…å†µä¸‹ç‰¹æŒ‡äº‹åŠ¡æ‰§è¡Œä¸­æ–°å¢çš„å…¶ä»–è¡Œã€‚ sqlåœ¨mysqlçš„æ‰§è¡Œè¿‡ç¨‹ äº‹åŠ¡æ€ä¹ˆä¿è¯ä¸€è‡´æ€§redo logæ˜¯InnoDBå­˜å‚¨å¼•æ“å±‚çš„æ—¥å¿—ï¼Œåˆç§°é‡åšæ—¥å¿—æ–‡ä»¶ï¼Œç”¨äºè®°å½•äº‹åŠ¡æ“ä½œçš„å˜åŒ–ï¼Œè®°å½•çš„æ˜¯æ•°æ®ä¿®æ”¹ä¹‹åçš„å€¼ï¼Œä¸ç®¡äº‹åŠ¡æ˜¯å¦æäº¤éƒ½ä¼šè®°å½•ä¸‹æ¥ã€‚å¦‚æ•°æ®åº“æ‰ç”µï¼ŒInnoDBå­˜å‚¨å¼•æ“ä¼šä½¿ç”¨redo logæ¢å¤åˆ°æ‰ç”µå‰çš„æ—¶åˆ»ï¼Œä»¥æ­¤æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ã€‚åœ¨ä¸€æ¡æ›´æ–°è¯­å¥è¿›è¡Œæ‰§è¡Œçš„æ—¶å€™ï¼ŒInnoDBå¼•æ“ä¼šæŠŠæ›´æ–°è®°å½•å†™åˆ°redo logæ—¥å¿—ä¸­ï¼Œç„¶åæ›´æ–°å†…å­˜ï¼Œæ­¤æ—¶ç®—æ˜¯è¯­å¥æ‰§è¡Œå®Œäº†ï¼Œç„¶ååœ¨ç©ºé—²çš„æ—¶å€™æˆ–è€…æ˜¯æŒ‰ç…§è®¾å®šçš„æ›´æ–°ç­–ç•¥å°†redo logä¸­çš„å†…å®¹æ›´æ–°åˆ°ç£ç›˜ä¸­ï¼Œè¿™é‡Œæ¶‰åŠåˆ°WALå³Write Ahead loggingæŠ€æœ¯ï¼Œä»–çš„å…³é”®ç‚¹æ˜¯å…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜ã€‚ binlog ã€undo ã€redo redo logé€šå¸¸æ˜¯ç‰©ç†æ—¥å¿—ï¼Œè®°å½•çš„æ˜¯æ•°æ®é¡µçš„ç‰©ç†ä¿®æ”¹ï¼Œè€Œä¸æ˜¯æŸä¸€è¡Œæˆ–æŸå‡ è¡Œä¿®æ”¹æˆæ€æ ·æ€æ ·ï¼Œå®ƒç”¨æ¥æ¢å¤æäº¤åçš„ç‰©ç†æ•°æ®é¡µ(æ¢å¤æ•°æ®é¡µï¼Œä¸”åªèƒ½æ¢å¤åˆ°æœ€åä¸€æ¬¡æäº¤çš„ä½ç½®)ã€‚ undoç”¨æ¥å›æ»šè¡Œè®°å½•åˆ°æŸä¸ªç‰ˆæœ¬ã€‚undo logä¸€èˆ¬æ˜¯é€»è¾‘æ—¥å¿—ï¼Œæ ¹æ®æ¯è¡Œè®°å½•è¿›è¡Œè®°å½•ã€‚ äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰ èšç°‡å’Œéèšç°‡ç´¢å¼• èšç°‡ç´¢å¼•ä¹Ÿå¥½ã€éèšç°‡ç´¢å¼•ä¹Ÿå¥½ï¼Œéƒ½æ˜¯ç´¢å¼•çš„ä¸€ä¸ªåŸºæœ¬åˆ†ç±»ï¼Œä»–ä»¬æœ€æœ¬è´¨çš„ç‚¹åœ¨äºå­˜å‚¨å¼•æ“ï¼Œå¦‚æœæˆ‘ä»¬ç”¨InnoDBå­˜å‚¨å¼•æ“ï¼Œä»–çš„å­˜å‚¨æ–‡ä»¶æ˜¯.frmå’Œ.ibdæ–‡ä»¶ï¼Œè¿™æ„å‘³ç€InnoDBé‡Œé¢å­˜æ”¾æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶æ˜¯åœ¨åŒä¸€ä¸ªæ–‡ä»¶.ibdæ–‡ä»¶é‡Œï¼Œæ‰€ä»¥ä»–çš„æ•°æ®å’Œç´¢å¼•æ˜¯æ”¾åœ¨ä¸€èµ·å­˜å‚¨çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼ç§°ä¹‹ä¸ºèšç°‡ç´¢å¼•ã€‚InnerDBåœ¨è¿›è¡Œæ•°æ®æ’å…¥çš„æ—¶å€™ï¼Œå¿…é¡»è¦ç»‘å®šä¸€ä¸ªç´¢å¼•åˆ—ä¸Šï¼Œé»˜è®¤æ˜¯ä¸»é”®ï¼Œå¦‚æœæ²¡æœ‰ä¸»é”®ï¼Œä¼šé€‰æ‹©å”¯ä¸€é”®ï¼Œå¦‚æœæ²¡æœ‰å”¯ä¸€é”®ï¼Œä¼šç”Ÿæˆ6å­—èŠ‚çš„rowidï¼Œè·Ÿæ•°æ®ç»‘å®šåœ¨ä¸€èµ· åƒMyISAMå­˜å‚¨å¼•æ“ï¼Œä»–å­˜å‚¨æ–‡ä»¶æ˜¯.frmï¼Œ.myi(ç´¢å¼•æ–‡ä»¶)ï¼Œ.myd(æ•°æ®æ–‡ä»¶)æ–‡ä»¶ï¼Œä»–æ˜¯æŠŠç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶åˆ†å¼€å­˜å‚¨çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼ç§°ä¸ºéèšç°‡ç´¢å¼•ï¼ŒInnoDBæ—¢æœ‰èšç°‡ç´¢å¼•ä¹Ÿæœ‰éèšç°‡ç´¢å¼•ï¼ŒMyISAMåªæœ‰éèšç°‡ç´¢å¼• æ•°æ®åº“æ…¢sqlä¼˜åŒ– å°½é‡åˆ›å»ºè”åˆç´¢å¼•, å¤šè¡¨å…³è”æŸ¥è¯¢ï¼šæ‰€æœ‰çš„joinæŸ¥è¯¢ï¼Œéƒ½æ˜¯é€šè¿‡åµŒå¥—å¾ªç¯è¿æ¥å®Œæˆçš„ï¼ŒåµŒå¥—å¾ªç¯joinæœ‰ä¸‰ä¸ªå˜ç§ï¼š Simple Nested-Loop Join ï¼šä»è¡¨ä¸­å–å‡ºåŒ¹é…æ‰€æœ‰åˆ—ï¼ŒåŒ¹é…ååˆå¹¶ï¼Œå¼€é”€å¤§ã€‚select * from t1,t2(ç¬›å¡å°”ç§¯) Index Nested-Loop Join ï¼š ç´¢å¼•åµŒå¥—è¿æ¥ï¼Œç”±äºéé©±åŠ¨è¡¨æœ‰ç´¢å¼•ï¼Œé€šè¿‡ç´¢å¼•å‡å°‘æ¯”è¾ƒï¼ŒåŠ é€ŸæŸ¥è¯¢ï¼Œæˆ‘ä»¬å†åšå…³è”æŸ¥è¯¢çš„æ—¶å€™å¿…é¡»è¦æ±‚å…³è”å­—æ®µæœ‰ç´¢å¼•ï¼›æŸ¥è¯¢è¿‡ç¨‹ï¼š1ã€æ ¹æ®å…³è”å­—æ®µç´¢å¼•è¿›è¡ŒæŸ¥æ‰¾ï¼Œåœ¨ç´¢å¼•ä¸Šæ‰¾åˆ°ç¬¦åˆçš„å€¼åå†å›è¡¨æŸ¥è¯¢ï¼Œåªæœ‰åŒ¹é…åˆ°ç´¢å¼•åæ‰ä¼šå›è¡¨ï¼Œè‡³äºé©±åŠ¨è¡¨é€‰æ‹©ï¼ŒMysqlä¼˜åŒ–å™¨ä¸€èˆ¬ä¼šé€‰æ‹©è®°å½•å°‘çš„ä½œä¸ºé©±åŠ¨è¡¨ï¼Œä½†æ˜¯å½“SQLç‰¹åˆ«å¤æ‚çš„æ—¶å€™ä¸æ’é™¤ä¼šé€‰æ‹©é”™ã€‚2ã€å¦‚æœéé©±åŠ¨è¡¨å…³è”ä¸»é”®ï¼Œæ€§èƒ½ä¼šéå¸¸é«˜ï¼Œå¦‚æœä¸æ˜¯ä¸»é”®ï¼Œå…³è”åè¿”å›è¡Œæ•°ç‰¹åˆ«å¤šçš„è¯ï¼Œæ•ˆç‡ä¹Ÿä¼šå¾ˆä½ï¼Œè¦å¤šæ¬¡å›è¡¨æ“ä½œã€‚ Block Nested-Loop Joinï¼šå½“è¿æ¥æ¡ä»¶æ²¡æœ‰ç´¢å¼•çš„æ—¶å€™ä¼šç”¨è¿™ç§æ–¹å¼å…³è”ï¼Œæ¯”Simple Nested-Loop Join å¤šäº†ä¸€ä¸ªä¸­é—´å¤„ç†è¿‡ç¨‹ï¼Œæœ‰äº›æƒ…å†µä¸‹ï¼Œå¯èƒ½joinçš„åˆ—å°±æ˜¯æ²¡æœ‰ç´¢å¼•ï¼Œé‚£ä¹ˆMySQLä¼šé€‰æ‹©Block Nested-Loop Joinç®—æ³•ï¼Œå…¶å®å°±æ˜¯ä½¿ç”¨Join bufferå°†é©±åŠ¨è¡¨çš„æŸ¥è¯¢Joinç›¸å…³åˆ—éƒ½ç¼“å­˜åˆ°Join bufferä¸­ï¼Œç„¶åæ‰¹é‡ä¸éé©±åŠ¨è¡¨è¿›è¡Œæ¯”è¾ƒï¼Œé™ä½äº†éé©±åŠ¨è¡¨çš„è®¿é—®é¢‘æ¬¡ã€‚æŸ¥çœ‹join buffer:show variables like &#39;join_buffer_size;&#39; ç´¢å¼•å¤±æ•ˆçš„æƒ…å†µè°ˆåˆ°ç´¢å¼•ä¸»è¦ä»ä¸¤æ–¹é¢æ¥åˆ†æï¼šIO å’Œæ•°æ®ç»“æ„ï¼šä¸ç®¡ç´¢å¼•æ•°æ®è¿˜æ˜¯è¡Œæ•°æ®ï¼Œéƒ½æ˜¯å­˜åœ¨ç£ç›˜é‡Œé¢çš„ï¼Œæˆ‘ä»¬å°½å¯èƒ½å°‘çš„å–å‡ºæ•°æ® IOâ€”â€“&gt;è¯»å–æ¬¡æ•°å°‘ã€é‡å°‘â€”â€”&gt;åˆ†å—è¯»å–â€”â€”&gt;å±€éƒ¨æ€§åŸç†ã€ç£ç›˜é¢„è¯» æ•°æ®ç»“æ„â€”â€”&gt;B+æ ‘â€”â€”&gt;äºŒå‰æ ‘ã€AVLæ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘ ç»„åˆç´¢å¼•ä¸éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ ç»„åˆç´¢å¼•å‰é¢ç´¢å¼•åˆ—ä½¿ç”¨èŒƒå›´æŸ¥è¯¢(&lt;,&gt;,like),ä¼šå¯¼è‡´åç»­ç´¢å¼•å¤±æ•ˆï¼› ä¸è¦åœ¨ç´¢å¼•ä¸Šåšä»»ä½•æ“ä½œï¼ˆè®¡ç®—ï¼Œå‡½æ•°ï¼Œç±»å‹è½¬æ¢ï¼‰ is nullå’Œis not null æ— æ³•ä½¿ç”¨ç´¢å¼• å°½é‡å°‘ä½¿ç”¨oræ“ä½œç¬¦ï¼Œå¦åˆ™è¿æ¥æ—¶ç´¢å¼•ä¼šå¤±æ•ˆ å­—ç¬¦ä¸²ä¸æ·»åŠ å¼•å·ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼ˆéšå¼ç±»å‹è½¬æ¢ï¼‰ ä¸¤è¡¨å…³è”ä½¿ç”¨çš„æ¡ä»¶å­—æ®µä¸­å­—æ®µçš„é•¿åº¦ï¼Œç¼–ç ä¸ä¸€è‡´ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ likeè¯­å¥ä¸­ï¼Œä»¥%å¼€å¤´çš„æ¨¡ç³ŠæŸ¥è¯¢ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ å¦‚æœmysqlä¸­ä½¿ç”¨å…¨è¡¨æ‰«ææ¯”ç´¢å¼•å¿«ï¼Œä¹Ÿä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ ï¼ˆforce index:å¼ºåˆ¶ä½¿ç”¨ç´¢å¼•ï¼‰ å¦‚ä½•åšåˆ†åº“åˆ†è¡¨â€‹ ä½¿ç”¨mycatæˆ–è€…shardingsphereä¸­é—´ä»¶åšåˆ†åº“åˆ†è¡¨ï¼Œé€‰æ‹©åˆé€‚çš„ä¸­é—´ä»¶ï¼Œæ°´å¹³åˆ†åº“ï¼Œæ°´å¹³åˆ†è¡¨ï¼Œå‚ç›´åˆ†åº“ï¼Œå‚ç›´åˆ†è¡¨ï¼Œåœ¨è¿›è¡Œåˆ†åº“åˆ†è¡¨çš„æ—¶å€™å°½é‡éµå¾ªä»¥ä¸‹åŸåˆ™ èƒ½ä¸åˆ‡åˆ†å°½é‡ä¸è¦åˆ‡åˆ† å¦‚æœè¦åˆ‡åˆ†ä¸€å®šè¦é€‰æ‹©åˆé€‚çš„åˆ‡åˆ†è§„åˆ™ï¼Œæå‰è§„åˆ’å¥½ å¦‚æœåˆ‡åˆ†å°½é‡é€šè¿‡æ•°æ®å†—ä½™æˆ–è¡¨åˆ†ç»„æ¥é™ä½è·¨åº“Joinçš„å¯èƒ½ ç”±äºæ•°æ®åº“ä¸­é—´ä»¶å¯¹æ•°æ®Joinå®ç°çš„ä¼˜åŠ£éš¾ä»¥æŠŠæ¡ï¼Œè€Œä¸”å®ç°é«˜æ€§èƒ½éš¾åº¦æå¤§ï¼Œä¸šåŠ¡å°½é‡å°‘ä½¿ç”¨å¤šè¡¨Join Mysqlä¸»ä»å¤åˆ¶ ä»åº“é€šè¿‡æ‰‹å·¥æ‰§è¡Œchange master to è¯­å¥è¿æ¥ä¸»åº“ï¼Œæä¾›è¿æ¥ç”¨æˆ·ä¿¡æ¯ï¼ˆuserNameã€passWordã€portã€ipï¼‰äºŒè¿›åˆ¶æ—¥å¿—çš„èµ·ç‚¹ä½ç½®ï¼ˆfileå positionå·ï¼‰ï¼›start slave ä»åº“çš„IOçº¿ç¨‹å’Œä¸»åº“çš„dumpçº¿ç¨‹å»ºç«‹è¿æ¥ ä»åº“æ ¹æ®change master to è¯­å¥æä¾›çš„fileåå’Œpositionå·ï¼ŒIOçº¿ç¨‹å‘ä¸»åº“å‘èµ·binlogè¯·æ±‚ ä¸»åº“dumpçº¿ç¨‹æ ¹æ®ä»åº“è¯·æ±‚ï¼Œå°†æœ¬åœ°binlogä»¥eventsçš„æ–¹å¼å‘ç»™ä»åº“IOçº¿ç¨‹ ä»åº“IOçº¿ç¨‹æ¥å—binlog eventsï¼Œå¹¶æ”¾åˆ°æœ¬åœ°relay-logä¸­(é¡ºåºIO)ï¼Œä¼ é€è¿‡æ¥çš„ä¿¡æ¯ä¼šè®°å½•åˆ°master.infoä¸­ ä»åº“SQLçº¿ç¨‹åº”ç”¨relay-log,å¹¶ä¸”æŠŠåº”ç”¨è¿‡çš„è®°å½•åˆ°relay-log.infoä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå·²ç»åº”ç”¨è¿‡çš„relayä¼šè‡ªåŠ¨è¢«æ¸…ç†purge ç¼“å­˜:Redis/ESRedisæ•°æ®ç±»å‹ String Hash Listï¼šç±»ä¼¼äºæ•°ç»„ Setï¼šæ— åºé›†åˆ ç”¨æˆ·åˆ—è¡¨ï¼Œæ±‚é›†åˆçš„äº¤é›†ï¼Œå¹¶é›†ç­‰æ“ä½œ ZSetï¼šæœ‰åºé›†åˆ 1ï¼‰ç‚¹å‡»æ–°é—»ï¼šZINCRBY hotNews:20190819 1 å®ˆæŠ¤é¦™æ¸¯ 2ï¼‰å±•ç¤ºå½“æ—¥æ’è¡Œå‰åï¼šZREVRANGE hotNews:20190819 0 9 WITHSCORES 3ï¼‰ä¸ƒæ—¥æœç´¢æ¦œå•è®¡ç®—ï¼šZUNIONSTORE hotNews:20190813-20190819 7 hotNews:20190813 hotNews:20190814â€¦ hotNews:20190819 4ï¼‰å±•ç¤ºä¸ƒæ—¥æ’è¡Œå‰åï¼šZREVRANGE hotNews:20190813-20190819 0 9 WITHSCORES Rediså•çº¿ç¨‹æ¨¡å‹RedisåŸºäºReactoræ¨¡å¼å¼€å‘çš„ç½‘ç»œäº‹ä»¶å¤„ç†å™¨ï¼Œè¿™ä¸ªæ–‡ä»¶äº‹ä»¶å¤„ç†å™¨æ˜¯å•çº¿ç¨‹çš„ï¼Œé‡‡ç”¨IOå¤šè·¯å¤ç”¨æœºåˆ¶ç›‘å¬å¤šä¸ªSockerï¼Œæ ¹æ®Sockerä¸Šçš„äº‹ä»¶ç±»å‹é€‰æ‹©å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨å¤„ç†è¿™ä¸ªäº‹ä»¶ï¼Œå¯ä»¥å®ç°é«˜æ€§èƒ½çš„ç½‘ç»œé€šä¿¡ã€‚æ–‡ä»¶äº‹ä»¶å¤„ç†å™¨åŒ…å«4ä¸ªéƒ¨åˆ†ï¼Œå¤šä¸ªSockerï¼ŒIOå¤šè·¯å¤ç”¨ç¨‹åºï¼Œæ–‡ä»¶äº‹ä»¶åˆ†æ´¾å™¨å’Œäº‹ä»¶å¤„ç†å™¨(å‘½ä»¤è¯·æ±‚å¤„ç†å™¨ï¼Œå‘½ä»¤å›å¤å¤„ç†å™¨ï¼Œé“¾æ¥åº”ç­”å¤„ç†å™¨)ï¼Œå¤šä¸ªSocketå¯èƒ½å¹¶å‘äº§ç”Ÿä¸åŒæ“ä½œï¼Œæ¯ä¸ªæ“ä½œå¯¹åº”ä¸åŒçš„æ–‡ä»¶äº‹ä»¶ï¼Œä½†æ˜¯IOå¤šè·¯å¤ç”¨ä¼šç›‘å¬å¤šä¸ªSocketï¼Œä¼šå°†Socketæ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡ä»é˜Ÿåˆ—ä¸­å–å‡ºä¸€ä¸ªSocketç»™æ—¶é—´åˆ†æ´¾å™¨ï¼Œæ—¶é—´åˆ†æ´¾å™¨æŠŠSocketç»™å¯¹åº”çš„äº‹ä»¶å¤„ç†å™¨ã€‚ å•çº¿ç¨‹å¿«çš„åŸå› ï¼š1.çº¯å†…å­˜æ“ä½œï¼›2.æ ¸å¿ƒæ˜¯åŸºäºéé˜»å¡çš„IOå¤šè·¯å¤ç”¨æœºåˆ¶ï¼›3.å•çº¿ç¨‹åè€Œé¿å…å¤šçº¿ç¨‹çš„é¢‘ç¹ä¸Šä¸‹æ–‡åˆ‡æ¢ åˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°çš„ï¼Ÿ åŸºäºæ•°æ®åº“å®ç°åˆ†å¸ƒå¼é”ï¼šå”¯ä¸€ç´¢å¼•ï¼ŒçŠ¶æ€æœºå”¯ä¸€è”åˆç´¢å¼• åŸºäºç¼“å­˜ï¼ˆRedisç­‰ï¼‰å®ç°åˆ†å¸ƒå¼é”ï¼šSET key value NX PX 30000 åŸºäºZookeeperå®ç°åˆ†å¸ƒå¼é”ï¼› setnxç”¨åˆ°çš„å‚æ•°SET key value NX PX 30000 ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæŠŠkeyã€value setåˆ°redisä¸­çš„ç­–ç•¥ nx ï¼š not exists, åªæœ‰key ä¸å­˜åœ¨æ—¶æ‰æŠŠkey value set åˆ°redis xx ï¼š is exists ï¼Œåªæœ‰ key å­˜åœ¨æ˜¯ï¼Œæ‰æŠŠkey value set åˆ°redis ç¬¬å››ä¸ªå‚æ•°ï¼šè¿‡æœŸæ—¶é—´å•ä½ ex ï¼šseconds ç§’ px : milliseconds æ¯«ç§’ ä½¿ç”¨å…¶ä»–å€¼ï¼ŒæŠ›å‡º å¼‚å¸¸ ï¼š redis.clients.jedis.exceptions.JedisDataException : ERR syntax error ç¬¬äº”ä¸ªå‚æ•°ï¼šæœ‰ä¸¤ç§å¯é€‰çš„å€¼ï¼Œ int å’Œlong çš„timeï¼Œéƒ½æ˜¯è¿‡æœŸæ—¶é—´ ï¼Œexpx å‚æ•°æ˜¯pxçš„æ—¶å€™ï¼Œä½¿ç”¨longç±»å‹çš„å‚æ•°ï¼Œå¯ä»¥è¡¨ç¤ºæ›´å¤šæ—¶é—´ ç¼“å­˜ç©¿é€ï¼Œå‡»ç©¿ï¼Œé›ªå´© ç¼“å­˜é›ªå´©ï¼šç¼“å­˜åŒä¸€æ—¶é—´å¤§é¢ç§¯å¤±æ•ˆï¼Œåé¢è¯·æ±‚éƒ½è½åˆ°æ•°æ®åº“ä¸Šï¼Œé€ æˆå¤§é‡è¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“ã€‚ è¿‡æœŸæ—¶é—´éšæœºï¼Œé˜²æ­¢åŒä¸€æ—¶é—´å¤§é‡æ•°æ®è¿‡æœŸ ç¼“å­˜é¢„çƒ­ï¼šé¡¹ç›®å¯åŠ¨åŠ è½½ç¼“å­˜åˆ°redis äº’æ–¥é”ï¼šä¿®æ”¹çš„æ—¶å€™åªå…è®¸ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹æ•°æ®åº“ï¼Œå…¶ä»–è¯»å†™çº¿ç¨‹ç­‰å¾… åŠ ç›¸åº”ç¼“å­˜æ ‡è®°ï¼Œè®°å½•ç¼“å­˜æ˜¯å¦å¤±æ•ˆï¼Œå¦‚æœå¤±æ•ˆï¼Œæ›´æ–°ç¼“å­˜(å†…å­˜æ¶ˆè€—å¤§ï¼Œä¸€èˆ¬ä¸ç”¨) ç¼“å­˜ç©¿é€ï¼šæŒ‡æ•°æ®åº“æ²¡æœ‰æ•°æ®ï¼Œå¯¼è‡´è¯·æ±‚è½åˆ°æ•°æ®åº“ä¸Š æ¥å£å±‚å¢åŠ æ ¡éªŒï¼Œå¯¹idè¿›è¡Œè§„åˆ™æ‹¦æˆª ç¼“å­˜å–ä¸åˆ°æ•°æ®ï¼Œè®¾ç½®nullå€¼åˆ°ç¼“å­˜ï¼Œè®¾ç½®çŸ­æ—¶é—´è¶…æ—¶ï¼Œé˜²æ­¢ç½‘ç»œæ”»å‡» å¸ƒéš†è¿‡æ»¤å™¨ï¼Œæ‰€æœ‰å¯èƒ½å­˜åœ¨çš„æ•°æ®å“ˆå¸Œåˆ°ä¸€ä¸ªè¶³å¤Ÿå¤§çš„bitmapä¸­ï¼Œä¸€ä¸ªä¸€å®šä¸å­˜åœ¨çš„æ•°æ®å°±ä¼šè¢«è¿™ä¸ªbitmapæ‹¦æˆª ç¼“å­˜å‡»ç©¿ï¼šç¼“å­˜æ²¡æœ‰ï¼Œæ•°æ®åº“ä¸­æœ‰æ•°æ®ï¼ˆä¸€èˆ¬æ˜¯ç¼“å­˜æ—¶é—´åˆ°æœŸï¼‰ï¼Œå¹¶å‘ç”¨æˆ·ç‰¹åˆ«å¤šï¼ŒåŒæ—¶å¤§é‡è¯·æ±‚è½åˆ°æ•°æ®åº“ï¼Œç¼“å­˜å‡»ç©¿æŒ‡å¹¶å‘æŸ¥è¯¢åŒä¸€æ¡æ•°æ®ï¼Œç¼“å­˜é›ªå´©æ˜¯ä¸åŒæ•°æ®éƒ½è¿‡æœŸ keyä¸è¿‡æœŸ åŠ äº’æ–¥é” RedisæŒä¹…åŒ– RDBå¿«ç…§(snapshot) Redis å°†å†…å­˜æ•°æ®å¿«ç…§ä¿å­˜åœ¨åå­—ä¸º dump.rdb çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚å¯ä»¥å¯¹ Redis è¿›è¡Œè®¾ç½®ï¼Œ è®©å®ƒåœ¨â€œ N ç§’å†…æ•°æ®é›†è‡³å°‘æœ‰ M ä¸ªæ”¹åŠ¨â€è¿™ä¸€æ¡ä»¶è¢«æ»¡è¶³æ—¶ï¼Œ è‡ªåŠ¨ä¿å­˜ä¸€æ¬¡æ•°æ®ï¼›**# save 60 1000 //** (60ç§’æ”¹1000æ¬¡è¿›è¡Œä¸€æ¬¡RDBæŒä¹…åŒ–)å…³é—­RDBåªéœ€è¦å°†æ‰€æœ‰çš„saveä¿å­˜ç­–ç•¥æ³¨é‡Šæ‰å³å¯ã€‚ é—®é¢˜ï¼šä¼šé˜»å¡å®¢æˆ·ç«¯å‘½ä»¤ã€‚ è¿˜å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œå‘½ä»¤ç”ŸæˆRDBå¿«ç…§ï¼Œè¿›å…¥rediså®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤saveæˆ–bgsaveå¯ä»¥ç”Ÿæˆdump.rdbæ–‡ä»¶ï¼Œæ¯æ¬¡å‘½ä»¤æ‰§è¡Œéƒ½ä¼šå°†æ‰€æœ‰rediså†…å­˜å¿«ç…§åˆ°ä¸€ä¸ªæ–°çš„rdbæ–‡ä»¶é‡Œï¼Œå¹¶è¦†ç›–åŸæœ‰rdbå¿«ç…§æ–‡ä»¶ã€‚ bgsaveçš„å†™æ—¶å¤åˆ¶(COW)æœºåˆ¶ï¼šRedis å€ŸåŠ©æ“ä½œç³»ç»Ÿæä¾›çš„å†™æ—¶å¤åˆ¶æŠ€æœ¯ï¼ˆCopy-On-Write, COWï¼‰ï¼Œåœ¨ç”Ÿæˆå¿«ç…§çš„åŒæ—¶ï¼Œä¾ç„¶å¯ä»¥æ­£å¸¸å¤„ç†å†™å‘½ä»¤ã€‚bgsave å­è¿›ç¨‹æ˜¯ç”±ä¸»çº¿ç¨‹ fork ç”Ÿæˆçš„ï¼Œå¯ä»¥å…±äº«ä¸»çº¿ç¨‹çš„æ‰€æœ‰å†…å­˜æ•°æ®ã€‚bgsave å­è¿›ç¨‹è¿è¡Œåï¼Œå¼€å§‹è¯»å–ä¸»çº¿ç¨‹çš„å†…å­˜æ•°æ®ï¼Œå¹¶æŠŠå®ƒä»¬å†™å…¥ RDB æ–‡ä»¶ã€‚æ­¤æ—¶ï¼Œå¦‚æœä¸»çº¿ç¨‹å¯¹è¿™äº›æ•°æ®ä¹Ÿéƒ½æ˜¯è¯»æ“ä½œï¼Œé‚£ä¹ˆï¼Œä¸»çº¿ç¨‹å’Œ bgsave å­è¿›ç¨‹ç›¸äº’ä¸å½±å“ã€‚ä½†æ˜¯ï¼Œå¦‚æœä¸»çº¿ç¨‹è¦ä¿®æ”¹ä¸€å—æ•°æ®ï¼Œé‚£ä¹ˆï¼Œè¿™å—æ•°æ®å°±ä¼šè¢«å¤åˆ¶ä¸€ä»½ï¼Œç”Ÿæˆè¯¥æ•°æ®çš„å‰¯æœ¬ã€‚ç„¶åï¼Œbgsave å­è¿›ç¨‹ä¼šæŠŠè¿™ä¸ªå‰¯æœ¬æ•°æ®å†™å…¥ RDB æ–‡ä»¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»çº¿ç¨‹ä»ç„¶å¯ä»¥ä¿®æ”¹åŸæ¥çš„æ•°æ®ã€‚ AOF(append-only file) å¦‚æœ Redis å› ä¸ºæŸäº›åŸå› è€Œé€ æˆæ•…éšœåœæœºï¼Œ é‚£ä¹ˆæœåŠ¡å™¨å°†ä¸¢å¤±æœ€è¿‘å†™å…¥ã€ä¸”ä»æœªä¿å­˜åˆ°å¿«ç…§ä¸­çš„é‚£äº›æ•°æ®ã€‚ä» 1.1 ç‰ˆæœ¬å¼€å§‹ï¼Œ Redis å¢åŠ äº†ä¸€ç§å®Œå…¨è€ä¹…çš„æŒä¹…åŒ–æ–¹å¼ï¼š AOF æŒä¹…åŒ–ï¼Œå°†ä¿®æ”¹çš„æ¯ä¸€æ¡æŒ‡ä»¤è®°å½•è¿›æ–‡ä»¶appendonly.aofä¸­(å…ˆå†™å…¥os cacheï¼Œæ¯éš”ä¸€æ®µæ—¶é—´fsyncåˆ°ç£ç›˜) ç¼“å­˜ä¸æ•°æ®åº“æ•°æ®ä¸€è‡´æ€§ è§£å†³æ–¹æ¡ˆï¼š å¯¹äºå¹¶å‘å‡ ç‡å¾ˆå°çš„æ•°æ®(å¦‚ä¸ªäººç»´åº¦çš„è®¢å•æ•°æ®ã€ç”¨æˆ·æ•°æ®ç­‰)ï¼Œè¿™ç§å‡ ä¹ä¸ç”¨è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå°‘ä¼šå‘ç”Ÿç¼“å­˜ä¸ä¸€è‡´ï¼Œå¯ä»¥ç»™ç¼“å­˜æ•°æ®åŠ ä¸Šè¿‡æœŸæ—¶é—´ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´è§¦å‘è¯»çš„ä¸»åŠ¨æ›´æ–°å³å¯ã€‚ å°±ç®—å¹¶å‘å¾ˆé«˜ï¼Œå¦‚æœä¸šåŠ¡ä¸Šèƒ½å®¹å¿çŸ­æ—¶é—´çš„ç¼“å­˜æ•°æ®ä¸ä¸€è‡´(å¦‚å•†å“åç§°ï¼Œå•†å“åˆ†ç±»èœå•ç­‰)ï¼Œç¼“å­˜åŠ ä¸Šè¿‡æœŸæ—¶é—´ä¾ç„¶å¯ä»¥è§£å†³å¤§éƒ¨åˆ†ä¸šåŠ¡å¯¹äºç¼“å­˜çš„è¦æ±‚ã€‚ å¦‚æœä¸èƒ½å®¹å¿ç¼“å­˜æ•°æ®ä¸ä¸€è‡´ï¼Œå¯ä»¥é€šè¿‡åŠ è¯»å†™é”ä¿è¯å¹¶å‘è¯»å†™æˆ–å†™å†™çš„æ—¶å€™æŒ‰é¡ºåºæ’å¥½é˜Ÿï¼Œè¯»è¯»çš„æ—¶å€™ç›¸å½“äºæ— é”ã€‚ ä¹Ÿå¯ä»¥ç”¨é˜¿é‡Œå¼€æºçš„canalé€šè¿‡ç›‘å¬æ•°æ®åº“çš„binlogæ—¥å¿—åŠæ—¶çš„å»ä¿®æ”¹ç¼“å­˜ï¼Œä½†æ˜¯å¼•å…¥äº†æ–°çš„ä¸­é—´ä»¶ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ã€‚ ESç®€ä»‹ESä»–æ˜¯å»ºç«‹åœ¨å…¨æ–‡æœç´¢å¼•æ“åº“ApacheLuceneåŸºç¡€ä¸Šçš„ä¸€ä¸ªå¼€æºæœç´¢å’Œåˆ†æå¼•æ“ï¼ŒESæœ¬èº«å…·æœ‰ä¸€ä¸ªåˆ†å¸ƒå¼å­˜å‚¨ï¼Œæ£€ç´¢é€Ÿåº¦å¿«çš„ç‰¹æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ç»å¸¸ç”¨å®ƒå»å®ç°å…¨æ–‡æ£€ç´¢è¿™ä¸€ç±»çš„åœºæ™¯ï¼Œæ¯”å¦‚åƒç½‘ç«™æœç´¢ï¼Œå…¬å¸å†…éƒ¨ç”¨ELKåšæ—¥å¿—èšé›†å’Œæ£€ç´¢ï¼Œæ¥å»å¿«é€ŸæŸ¥æ‰¾æœåŠ¡å™¨çš„æ—¥å¿—è®°å½•ï¼Œå»å®šä½é—®é¢˜ï¼ŒåŸºæœ¬ä¸Šæ¶‰åŠåˆ°TBçº§åˆ«çš„æ•°æ®åœºæ™¯ï¼Œç”¨ESæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹© ESæŸ¥è¯¢å¿«çš„åŸå›  ç¬¬ä¸€ã€Luceneæ˜¯æ“…é•¿ç®¡ç†å¤§é‡çš„ç´¢å¼•æ•°æ®çš„ï¼Œå¦ä¸€æ–¹é¢ä»–ä¼šå¯¹æ•°æ®è¿›è¡Œåˆ†è¯ä»¥ååœ¨ä¿å­˜ç´¢å¼•ï¼Œè¿™æ ·èƒ½ææå‡æ•°æ®çš„æ£€ç´¢æ•ˆç‡ ç¬¬äºŒã€ESé‡‡ç”¨å€’æ’ç´¢å¼•ï¼Œæ‰€è°“å€’æ’ç´¢å¼•ï¼Œå°±æ˜¯é€šè¿‡å±æ€§å€¼æ¥ç¡®å®šæ•°æ®è®°å½•çš„ä½ç½®çš„ç´¢å¼•ï¼Œæ¥é¿å…å…¨è¡¨æ‰«æè¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œ ç¬¬ä¸‰ã€ESé‡‡ç”¨åˆ†ç‰‡å­˜å‚¨æœºåˆ¶ ç¬¬å››ã€ESæ‰©å±•æ€§å¥½ï¼Œæˆ‘ä»¬å¯ä»¥æ°´å¹³æ‰©å±•å¢åŠ æœåŠ¡å™¨ï¼Œæå‡ESå¤„ç†æ€§èƒ½ï¼Œå¯ä»¥è¾¾åˆ°ç™¾å°æœåŠ¡å™¨èŠ‚ç‚¹æ‰©å±• ç¬¬äº”ã€ESå†…éƒ¨æä¾›äº†æ•°æ®æ±‡æ€»å’Œç´¢å¼•ç”Ÿå‘½å‘¨æœŸç®¡ç†çš„ä¸€äº›åŠŸèƒ½ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬æ›´åŠ é«˜æ•ˆçš„å­˜å‚¨å’Œæœç´¢æ•°æ® ä½¿ç”¨ESæ³¨æ„äº‹é¡¹ ESé‡Œé¢ä¸å»ºè®®ä½¿ç”¨å¤æ‚çš„å…³è”æŸ¥è¯¢ï¼Œä¼šå¯¹æ€§èƒ½å½±å“å¾ˆå¤§ é¿å…æ·±åº¦åˆ†é¡µæŸ¥è¯¢ï¼Œå› ä¸ºESåˆ†é¡µæ˜¯æ”¯æŒfrontå’Œsizeå‚æ•°ï¼Œåœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œæ¯ä¸ªåˆ†ç‰‡å¿…é¡»æ„é€ ä¸€ä¸ªé•¿åº¦ä¸ºfrontåŠ sizeçš„ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç„¶åå›ä¼ åˆ°ç½‘å…³èŠ‚ç‚¹ï¼Œç½‘å…³èŠ‚ç‚¹å†å¯¹è¿™äº›é˜Ÿåˆ—è¿›è¡Œæ’åºå†æ‰¾åˆ°æ­£ç¡®çš„sizeæ–‡æ¡£ã€‚è€Œå½“frontè¶³å¤Ÿå¤§çš„æ—¶å€™å®¹æ˜“é€ æˆOOMä»¥åŠç½‘ç»œä¼ è¾“æ€§èƒ½å·®çš„ä¸€äº›é—®é¢˜ ä¸­é—´ä»¶æ¶ˆæ¯é˜Ÿåˆ— Rabbitmqç”Ÿäº§é«˜å¯ç”¨æ€ä¹ˆå®ç°çš„ ç”Ÿäº§éƒ¨ç½²ä¸ºé›†ç¾¤æ¨¡å¼ï¼šé¿å…å•æœºæ¨¡å¼ä¸‹MQæœåŠ¡å™¨æŒ‚äº†å¯¼è‡´æœåŠ¡ä¸å¯ç”¨ï¼Œè¿˜å¯ä»¥æ‰¿è½½æ›´é«˜çš„å¹¶å‘é‡ï¼Œä½†æ˜¯é›†ç¾¤æ¨¡å¼æœ‰ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨å“ªä¸ªèŠ‚ç‚¹ä¸Šåˆ›å»ºé˜Ÿåˆ—ï¼Œè¯¥é˜Ÿåˆ—åªä¼šå­˜åœ¨è¯¥èŠ‚ç‚¹ä¸Šï¼Œå…¶ä»–é›†ç¾¤èŠ‚ç‚¹ä¸ä¼šå¤‡ä»½è¯¥é˜Ÿåˆ—ï¼Œä¸€æ—¦è¯¥èŠ‚ç‚¹å®•æœºï¼Œè¯¥é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å°±ä¼šä¸¢å¤±(äº²æµ‹è®¾ç½®æŒä¹…åŒ–ä¹Ÿä¸¢å¤±) ä½¿ç”¨é•œåƒé˜Ÿåˆ—ï¼šå¯ä»¥è§£å†³é›†ç¾¤æ¨¡å¼ä¸‹ï¼Œæ¯ä¸ªæœºå™¨ä¸Šåªæœ‰ä¸€ä¸ªé˜Ÿåˆ—çš„é—®é¢˜ï¼Œè®©æ¶ˆæ¯åœ¨å…¶ä»–èŠ‚ç‚¹å†å¤‡ä»½ä¸€ä»½ã€‚å¼€å¯æ–¹å¼ï¼šä»»ä½•èŠ‚ç‚¹æ·»åŠ policyç­–ç•¥å³å¯ï¼Œè¯¥é›†ç¾¤å°±å…·æœ‰é•œåƒé˜Ÿåˆ—èƒ½åŠ›ï¼Œå¯è®¾ç½®å¤‡ä»½çš„ä»½æ•°å’Œå¤‡ä»½é˜Ÿåˆ—è§„åˆ™ï¼Œå³ä½¿å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œä¹Ÿä¼šä¿è¯æ•´ä¸ªé›†ç¾¤ä¸­ä¿å­˜2ä»½ é«˜å¯ç”¨è´Ÿè½½å‡è¡¡ï¼šhaproxy+keepaliveï¼Œnginxï¼Œlvsç­‰å®ç°é«˜å¯ç”¨è´Ÿè½½å‡è¡¡ å…¶ä»–ï¼šFederation Exchangeè”é‚¦äº¤æ¢æœºæ’ä»¶è§£å†³ä¸¤åœ°æ¥å—æ¶ˆæ¯ç¡®è®¤æ¶ˆæ¯å»¶è¿Ÿé—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç”¨Shovelæ¥åšæ•°æ®åŒæ­¥ï¼Œéœ€è¦å®‰è£…æ’ä»¶ zookeeperzookeeperçš„ç†è§£ é›†ç¾¤ç®¡ç†ï¼šæä¾›äº†CPæ¨¡å‹æ¥ä¿è¯é›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„æ•°æ®ä¸€è‡´æ€§ åˆ†å¸ƒå¼é” é›†ç¾¤é€‰ä¸¾ zookeeperé€‰ä¸¾æœºåˆ¶ LeaderElection AuthFastLeaderElection FastLeaderElection ï¼ˆæœ€æ–°é»˜è®¤ï¼‰ ç›®å‰æœ‰5å°æœåŠ¡å™¨ï¼Œæ¯å°æœåŠ¡å™¨å‡æ²¡æœ‰æ•°æ®ï¼Œå®ƒä»¬çš„ç¼–å·åˆ†åˆ«æ˜¯1,2,3,4,5,æŒ‰ç¼–å·ä¾æ¬¡å¯åŠ¨ï¼Œå®ƒä»¬çš„é€‰æ‹©ä¸¾è¿‡ç¨‹å¦‚ä¸‹ï¼š æœåŠ¡å™¨1å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼Œç„¶åå‘æŠ•ç¥¨ä¿¡æ¯ï¼Œç”±äºå…¶å®ƒæœºå™¨è¿˜æ²¡æœ‰å¯åŠ¨æ‰€ä»¥å®ƒæ”¶ä¸åˆ°åé¦ˆä¿¡æ¯ï¼ŒæœåŠ¡å™¨1çš„çŠ¶æ€ä¸€ç›´å±äºLooking(é€‰ä¸¾çŠ¶æ€)ã€‚ æœåŠ¡å™¨2å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨1äº¤æ¢ç»“æœï¼Œç”±äºæœåŠ¡å™¨2çš„ç¼–å·å¤§æ‰€ä»¥æœåŠ¡å™¨2èƒœå‡ºï¼Œä½†æ­¤æ—¶æŠ•ç¥¨æ•°æ²¡æœ‰å¤§äºåŠæ•°ï¼Œæ‰€ä»¥ä¸¤ä¸ªæœåŠ¡å™¨çš„çŠ¶æ€ä¾ç„¶æ˜¯LOOKINGã€‚ æœåŠ¡å™¨3å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨1,2äº¤æ¢ä¿¡æ¯ï¼Œç”±äºæœåŠ¡å™¨3çš„ç¼–å·æœ€å¤§æ‰€ä»¥æœåŠ¡å™¨3èƒœå‡ºï¼Œæ­¤æ—¶æŠ•ç¥¨æ•°æ­£å¥½å¤§äºåŠæ•°ï¼Œæ‰€ä»¥æœåŠ¡å™¨3æˆä¸ºé¢†å¯¼è€…ï¼ŒæœåŠ¡å™¨1,2æˆä¸ºå°å¼Ÿã€‚ æœåŠ¡å™¨4å¯åŠ¨ï¼Œç»™è‡ªå·±æŠ•ç¥¨ï¼ŒåŒæ—¶ä¸ä¹‹å‰å¯åŠ¨çš„æœåŠ¡å™¨1,2,3äº¤æ¢ä¿¡æ¯ï¼Œå°½ç®¡æœåŠ¡å™¨4çš„ç¼–å·å¤§ï¼Œä½†ä¹‹å‰æœåŠ¡å™¨3å·²ç»èƒœå‡ºï¼Œæ‰€ä»¥æœåŠ¡å™¨4åªèƒ½æˆä¸ºå°å¼Ÿã€‚ æœåŠ¡å™¨5å¯åŠ¨ï¼Œåé¢çš„é€»è¾‘åŒæœåŠ¡å™¨4æˆä¸ºå°å¼Ÿã€‚ å¾®æœåŠ¡å…¨å±€åºå·ç”Ÿæˆè§„åˆ™ï¼Ÿ UUIDï¼šæ²¡é¡ºåºï¼Œé•¿åº¦è¿‡é•¿ï¼Œä½œä¸ºä¸»é”®ç´¢å¼•æ•ˆç‡ä½ æ•°æ®åº“è‡ªå¢idï¼šå®ç°ç®€å•ï¼Œä¿è¯å”¯ä¸€é€’å¢ï¼Œæ‰©å±•æ€§å·®ï¼Œæœ‰å•ç‚¹æ•…éšœé£é™© redisç”Ÿæˆid é›ªèŠ±ç®—æ³• é€šè¿‡ä¸€ä¸ªåºåˆ—è¡¨è®°å½•å½“å‰åºåˆ—å·ï¼Œæœºå™¨æ¯æ¬¡ä»åºåˆ—è¡¨ä¸­è·å–ä¸€å®šæ­¥é•¿çš„åºåˆ—æ•°ç„¶åç¼“å­˜å†æœ¬åœ°ï¼Œç­‰ç”¨å®Œåå†é‡æ–°ä»æ­¥é•¿è¡¨è·å– ç†è®ºCAPç†è®ºâ€‹ CAP ç†è®ºåˆå« Brewer ç†è®ºï¼Œè¿™æ˜¯åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„åŸƒé‡Œå…‹ Â· å¸ƒé²å°”ï¼ˆEric Brewerï¼‰æ•™æˆï¼Œåœ¨ 2000 å¹´ 7 æœˆâ€œACM åˆ†å¸ƒå¼è®¡ç®—åŸç†ç ”è®¨ä¼šï¼ˆPODCï¼‰â€ä¸Šæå‡ºçš„ä¸€ä¸ªçŒœæƒ³ã€‚CAPç†è®ºåŸç¨¿ï¼ˆé‚£æ—¶å€™è¿˜åªæ˜¯çŒœæƒ³ï¼‰ç„¶ååˆ°äº† 2002 å¹´ï¼Œéº»çœç†å·¥å­¦é™¢çš„èµ›æ–¯ Â· å‰å°”ä¼¯ç‰¹ï¼ˆSeth Gilbertï¼‰å’Œå—å¸Œ Â· æ—å¥‡ï¼ˆNancy Lynchï¼‰å°±ä»¥ä¸¥è°¨çš„æ•°å­¦æ¨ç†è¯æ˜äº†è¿™ä¸ª CAP çŒœæƒ³ã€‚åœ¨è¿™ä¹‹åï¼ŒCAP ç†è®ºå°±æ­£å¼æˆä¸ºäº†åˆ†å¸ƒå¼è®¡ç®—é¢†åŸŸå…¬è®¤çš„è‘—åå®šç†ã€‚è¿™ä¸ªå®šç†é‡Œï¼Œæè¿°äº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„ç³»ç»Ÿä¸­ï¼Œå½“æ¶‰åŠåˆ°å…±äº«æ•°æ®é—®é¢˜æ—¶ï¼Œä»¥ä¸‹ä¸‰ä¸ªç‰¹æ€§æœ€å¤šåªèƒ½æ»¡è¶³å…¶ä¸­ä¸¤ä¸ªï¼š ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šä»£è¡¨åœ¨ä»»ä½•æ—¶åˆ»ã€ä»»ä½•åˆ†å¸ƒå¼èŠ‚ç‚¹ä¸­ï¼Œæˆ‘ä»¬æ‰€çœ‹åˆ°çš„æ•°æ®éƒ½æ˜¯æ²¡æœ‰çŸ›ç›¾çš„ã€‚è¿™ä¸ ACID ä¸­çš„ C æ˜¯ç›¸åŒçš„å•è¯ï¼Œä½†å®ƒä»¬åˆæœ‰ä¸åŒçš„å®šä¹‰ï¼ˆåˆ†åˆ«æŒ‡ Replication çš„ä¸€è‡´æ€§å’Œæ•°æ®åº“çŠ¶æ€çš„ä¸€è‡´æ€§ï¼‰ã€‚åœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸­ï¼ŒACID çš„ C è¦ä»¥æ»¡è¶³ CAP ä¸­çš„ C ä¸ºå‰æã€‚ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šä»£è¡¨ç³»ç»Ÿä¸é—´æ–­åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ã€‚ åˆ†åŒºå®¹å¿æ€§ï¼ˆPartition Toleranceï¼‰ï¼šä»£è¡¨åˆ†å¸ƒå¼ç¯å¢ƒä¸­ï¼Œå½“éƒ¨åˆ†èŠ‚ç‚¹å› ç½‘ç»œåŸå› è€Œå½¼æ­¤å¤±è”ï¼ˆå³ä¸å…¶ä»–èŠ‚ç‚¹å½¢æˆâ€œç½‘ç»œåˆ†åŒºâ€ï¼‰æ—¶ï¼Œç³»ç»Ÿä»èƒ½æ­£ç¡®åœ°æä¾›æœåŠ¡çš„èƒ½åŠ›ã€‚ DDDdddä¸æ˜¯ä¸€ç§æ¶æ„é£æ ¼ï¼Œè€Œæ˜¯ä¸€ç§æ–¹æ³•è®ºï¼Œä»€ä¹ˆæ˜¯æ–¹æ³•è®ºï¼Œæ¯ä¸ªäººæŒ‰ç…§è‡ªå·±çš„æƒ³æ³•æ¥è®¾è®¡å°±æ˜¯ä¸€å¥—æ–¹æ³•è®ºï¼›dddæ˜¯ä¸€ç§ä¸šåŠ¡æ¯”è¾ƒè®¤å¯ï¼Œå¯¹äºå¾®æœåŠ¡æ‹†åˆ†çš„ä¸€ç§æ–¹æ³•è®ºã€‚ é¡¹ç›® æœ€è¿‘åšçš„æ¯”è¾ƒç†Ÿæ‚‰çš„é¡¹ç›®æ˜¯å“ªä¸ªï¼Ÿç”»ä¸€ä¸‹é¡¹ç›®æŠ€æœ¯æ¶æ„å›¾ å†™ä¸¤ä¸ªç±»ï¼Œèƒ½å¤Ÿå®ç°å †å†…å­˜æº¢å‡ºå’Œæ ˆå†…å­˜æº¢å‡º å†™ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å•ä¾‹ã€‚ ä¸¤ä¸ªå¯å˜æœ‰åºé“¾è¡¨æ”¾åˆ°æ–°æ•°ç»„ä¸­ï¼Œæœ‰åº ç®—æ³•","categories":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zhangyong3214.github.io/categories/%E9%9D%A2%E8%AF%95/"}],"tags":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zhangyong3214.github.io/tags/%E9%9D%A2%E8%AF%95/"}]},{"title":"SpringæŠ€æœ¯ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°/Spring","date":"2022-01-27T08:31:13.127Z","updated":"2022-01-27T08:31:13.127Z","comments":true,"path":"2022/01/27/å­¦ä¹ ç¬”è®°/Spring/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/Spring/","excerpt":"","text":"Springåº•å±‚æ ¸å¿ƒåŸç†è§£æä¸‹è½½Springæºç git cloneçš„åœ°å€ä¸ºï¼šhttps://gitee.com/archguide/spring-framework-5.3.10.git Beançš„åˆ›å»ºè¿‡ç¨‹é‚£ä¹ˆSpringåˆ°åº•æ˜¯å¦‚ä½•æ¥åˆ›å»ºä¸€ä¸ªBeançš„å‘¢ï¼Œè¿™ä¸ªå°±æ˜¯Beanåˆ›å»ºçš„ç”Ÿå‘½å‘¨æœŸï¼Œå¤§è‡´è¿‡ç¨‹å¦‚ä¸‹ï¼š åˆ©ç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼ˆä½†æ˜¯å¦‚ä½•ä¸€ä¸ªç±»ä¸­æœ‰å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringåˆ™ä¼šè¿›è¡Œé€‰æ‹©ï¼Œè¿™ä¸ªå«åšæ¨æ–­æ„é€ æ–¹æ³•ï¼‰ å¾—åˆ°ä¸€ä¸ªå¯¹è±¡åï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨è¢«@Autowiredæ³¨è§£äº†çš„å±æ€§ï¼ŒæŠŠè¿™äº›å±æ€§æ‰¾å‡ºæ¥å¹¶ç”±Springè¿›è¡Œèµ‹å€¼ï¼ˆä¾èµ–æ³¨å…¥ï¼‰ ä¾èµ–æ³¨å…¥åï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº†BeanNameAwareæ¥å£ã€BeanClassLoaderAwareæ¥å£ã€BeanFactoryAwareæ¥å£ï¼Œå¦‚æœå®ç°äº†ï¼Œå°±è¡¨ç¤ºå½“å‰å¯¹è±¡å¿…é¡»å®ç°è¯¥æ¥å£ä¸­æ‰€å®šä¹‰çš„setBeanName()ã€setBeanClassLoader()ã€setBeanFactory()æ–¹æ³•ï¼Œé‚£Springå°±ä¼šè°ƒç”¨è¿™äº›æ–¹æ³•å¹¶ä¼ å…¥ç›¸åº”çš„å‚æ•°ï¼ˆAwareå›è°ƒï¼‰ Awareå›è°ƒåï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æŸä¸ªæ–¹æ³•è¢«@PostConstructæ³¨è§£äº†ï¼Œå¦‚æœå­˜åœ¨ï¼ŒSpringä¼šè°ƒç”¨å½“å‰å¯¹è±¡çš„æ­¤æ–¹æ³•ï¼ˆåˆå§‹åŒ–å‰ï¼‰ ç´§æ¥ç€ï¼ŒSpringä¼šåˆ¤æ–­è¯¥å¯¹è±¡æ˜¯å¦å®ç°äº†InitializingBeanæ¥å£ï¼Œå¦‚æœå®ç°äº†ï¼Œå°±è¡¨ç¤ºå½“å‰å¯¹è±¡å¿…é¡»å®ç°è¯¥æ¥å£ä¸­çš„afterPropertiesSet()æ–¹æ³•ï¼Œé‚£Springå°±ä¼šè°ƒç”¨å½“å‰å¯¹è±¡ä¸­çš„afterPropertiesSet()æ–¹æ³•ï¼ˆåˆå§‹åŒ–ï¼‰ æœ€åï¼ŒSpringä¼šåˆ¤æ–­å½“å‰å¯¹è±¡éœ€ä¸éœ€è¦è¿›è¡ŒAOPï¼Œå¦‚æœä¸éœ€è¦é‚£ä¹ˆBeanå°±åˆ›å»ºå®Œäº†ï¼Œå¦‚æœéœ€è¦è¿›è¡ŒAOPï¼Œåˆ™ä¼šè¿›è¡ŒåŠ¨æ€ä»£ç†å¹¶ç”Ÿæˆä¸€ä¸ªä»£ç†å¯¹è±¡åšä¸ºBeanï¼ˆåˆå§‹åŒ–åï¼‰ é€šè¿‡æœ€åä¸€æ­¥ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå½“Springæ ¹æ®UserServiceç±»æ¥åˆ›å»ºä¸€ä¸ªBeanæ—¶ï¼š å¦‚æœä¸ç”¨è¿›è¡ŒAOPï¼Œé‚£ä¹ˆBeanå°±æ˜¯UserServiceç±»çš„æ„é€ æ–¹æ³•æ‰€å¾—åˆ°çš„å¯¹è±¡ã€‚ å¦‚æœéœ€è¦è¿›è¡ŒAOPï¼Œé‚£ä¹ˆBeanå°±æ˜¯UserServiceçš„ä»£ç†ç±»æ‰€å®ä¾‹åŒ–å¾—åˆ°çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯UserServiceæœ¬èº«æ‰€å¾—åˆ°çš„å¯¹è±¡ã€‚ Beanå¯¹è±¡åˆ›å»ºå‡ºæ¥åï¼š å¦‚æœå½“å‰Beanæ˜¯å•ä¾‹Beanï¼Œé‚£ä¹ˆä¼šæŠŠè¯¥Beanå¯¹è±¡å­˜å…¥ä¸€ä¸ªMap&lt;String,Object&gt;ï¼ŒMapçš„keyä¸ºbeanNameï¼Œvalueä¸ºBeanå¯¹è±¡ã€‚è¿™æ ·ä¸‹æ¬¡getBeanæ—¶å°±å¯ä»¥ç›´æ¥ä»Mapä¸­æ‹¿åˆ°å¯¹åº”çš„Beanå¯¹è±¡äº†ã€‚ï¼ˆå®é™…ä¸Šï¼Œåœ¨Springæºç ä¸­ï¼Œè¿™ä¸ªMapå°±æ˜¯å•ä¾‹æ± ï¼‰ å¦‚æœå½“å‰Beanæ˜¯åŸå‹Beanï¼Œé‚£ä¹ˆåç»­æ²¡æœ‰å…¶ä»–åŠ¨ä½œï¼Œä¸ä¼šå­˜å…¥ä¸€ä¸ªMapï¼Œä¸‹æ¬¡getBeanæ—¶ä¼šå†æ¬¡æ‰§è¡Œä¸Šè¿°åˆ›å»ºè¿‡ç¨‹ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„Beanå¯¹è±¡ã€‚ æ¨æ–­æ„é€ æ–¹æ³•Springåœ¨åŸºäºæŸä¸ªç±»ç”ŸæˆBeançš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦åˆ©ç”¨è¯¥ç±»çš„æ„é€ æ–¹æ³•æ¥å®ä¾‹åŒ–å¾—åˆ°ä¸€ä¸ªå¯¹è±¡ï¼Œä½†æ˜¯å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringä¼šä½¿ç”¨å“ªä¸ªå‘¢ï¼Ÿ Springçš„åˆ¤æ–­é€»è¾‘å¦‚ä¸‹ï¼š å¦‚æœä¸€ä¸ªç±»åªå­˜åœ¨ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œä¸ç®¡è¯¥æ„é€ æ–¹æ³•æ˜¯æ— å‚æ„é€ æ–¹æ³•ï¼Œè¿˜æ˜¯æœ‰å‚æ„é€ æ–¹æ³•ï¼ŒSpringéƒ½ä¼šç”¨è¿™ä¸ªæ„é€ æ–¹æ³• å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³•a. è¿™äº›æ„é€ æ–¹æ³•ä¸­ï¼Œå­˜åœ¨ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆSpringå°±ä¼šç”¨è¿™ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•b. è¿™äº›æ„é€ æ–¹æ³•ä¸­ï¼Œä¸å­˜åœ¨ä¸€ä¸ªæ— å‚çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆSpringå°±ä¼šæŠ¥é”™ Springçš„è®¾è®¡æ€æƒ³æ˜¯è¿™æ ·çš„ï¼š å¦‚æœä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆæ²¡å¾—é€‰æ‹©ï¼Œåªèƒ½ç”¨è¿™ä¸ªæ„é€ æ–¹æ³• å¦‚æœä¸€ä¸ªç±»å­˜åœ¨å¤šä¸ªæ„é€ æ–¹æ³•ï¼ŒSpringä¸çŸ¥é“å¦‚ä½•é€‰æ‹©ï¼Œå°±ä¼šçœ‹æ˜¯å¦æœ‰æ— å‚çš„æ„é€ æ–¹æ³•ï¼Œå› ä¸ºæ— å‚æ„é€ æ–¹æ³•æœ¬èº«è¡¨ç¤ºäº†ä¸€ç§é»˜è®¤çš„æ„ä¹‰ ä¸è¿‡å¦‚æœæŸä¸ªæ„é€ æ–¹æ³•ä¸ŠåŠ äº†@Autowiredæ³¨è§£ï¼Œé‚£å°±è¡¨ç¤ºç¨‹åºå‘˜å‘Šè¯‰Springå°±ç”¨è¿™ä¸ªåŠ äº†æ³¨è§£çš„æ–¹æ³•ï¼Œé‚£Springå°±ä¼šç”¨è¿™ä¸ªåŠ äº†@Autowiredæ³¨è§£æ„é€ æ–¹æ³•äº† éœ€è¦é‡è§†çš„æ˜¯ï¼Œå¦‚æœSpringé€‰æ‹©äº†ä¸€ä¸ªæœ‰å‚çš„æ„é€ æ–¹æ³•ï¼ŒSpringåœ¨è°ƒç”¨è¿™ä¸ªæœ‰å‚æ„é€ æ–¹æ³•æ—¶ï¼Œéœ€è¦ä¼ å…¥å‚æ•°ï¼Œé‚£è¿™ä¸ªå‚æ•°æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿ Springä¼šæ ¹æ®å…¥å‚çš„ç±»å‹å’Œå…¥å‚çš„åå­—å»Springä¸­æ‰¾Beanå¯¹è±¡ï¼ˆä»¥å•ä¾‹Beanä¸ºä¾‹ï¼ŒSpringä¼šä»å•ä¾‹æ± é‚£ä¸ªMapä¸­å»æ‰¾ï¼‰ï¼š å…ˆæ ¹æ®å…¥å‚ç±»å‹æ‰¾ï¼Œå¦‚æœåªæ‰¾åˆ°ä¸€ä¸ªï¼Œé‚£å°±ç›´æ¥ç”¨æ¥ä½œä¸ºå…¥å‚ å¦‚æœæ ¹æ®ç±»å‹æ‰¾åˆ°å¤šä¸ªï¼Œåˆ™å†æ ¹æ®å…¥å‚åå­—æ¥ç¡®å®šå”¯ä¸€ä¸€ä¸ª æœ€ç»ˆå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œæ— æ³•åˆ›å»ºå½“å‰Beanå¯¹è±¡ ç¡®å®šç”¨å“ªä¸ªæ„é€ æ–¹æ³•ï¼Œç¡®å®šå…¥å‚çš„Beanå¯¹è±¡ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«åšæ¨æ–­æ„é€ æ–¹æ³•ã€‚ AOPå¤§è‡´æµç¨‹AOPå°±æ˜¯è¿›è¡ŒåŠ¨æ€ä»£ç†ï¼Œåœ¨åˆ›å»ºä¸€ä¸ªBeançš„è¿‡ç¨‹ä¸­ï¼ŒSpringåœ¨æœ€åä¸€æ­¥ä¼šå»åˆ¤æ–­å½“å‰æ­£åœ¨åˆ›å»ºçš„è¿™ä¸ªBeanæ˜¯ä¸æ˜¯éœ€è¦è¿›è¡ŒAOPï¼Œå¦‚æœéœ€è¦åˆ™ä¼šè¿›è¡ŒåŠ¨æ€ä»£ç†ã€‚ å¦‚ä½•åˆ¤æ–­å½“å‰Beanå¯¹è±¡éœ€ä¸éœ€è¦è¿›è¡ŒAOP: æ‰¾å‡ºæ‰€æœ‰çš„åˆ‡é¢Bean éå†åˆ‡é¢ä¸­çš„æ¯ä¸ªæ–¹æ³•ï¼Œçœ‹æ˜¯å¦å†™äº†@Beforeã€@Afterç­‰æ³¨è§£ å¦‚æœå†™äº†ï¼Œåˆ™åˆ¤æ–­æ‰€å¯¹åº”çš„Pointcutæ˜¯å¦å’Œå½“å‰Beanå¯¹è±¡çš„ç±»æ˜¯å¦åŒ¹é… å¦‚æœåŒ¹é…åˆ™è¡¨ç¤ºå½“å‰Beanå¯¹è±¡æœ‰åŒ¹é…çš„çš„Pointcutï¼Œè¡¨ç¤ºéœ€è¦è¿›è¡ŒAOP åˆ©ç”¨cglibè¿›è¡ŒAOPçš„å¤§è‡´æµç¨‹ï¼š ç”Ÿæˆä»£ç†ç±»UserServiceProxyï¼Œä»£ç†ç±»ç»§æ‰¿UserService ä»£ç†ç±»ä¸­é‡å†™äº†çˆ¶ç±»çš„æ–¹æ³•ï¼Œæ¯”å¦‚UserServiceä¸­çš„test()æ–¹æ³• ä»£ç†ç±»ä¸­è¿˜ä¼šæœ‰ä¸€ä¸ªtargetå±æ€§ï¼Œè¯¥å±æ€§çš„å€¼ä¸ºè¢«ä»£ç†å¯¹è±¡ï¼ˆä¹Ÿå°±æ˜¯é€šè¿‡UserServiceç±»æ¨æ–­æ„é€ æ–¹æ³•å®ä¾‹åŒ–å‡ºæ¥çš„å¯¹è±¡ï¼Œè¿›è¡Œäº†ä¾èµ–æ³¨å…¥ã€åˆå§‹åŒ–ç­‰æ­¥éª¤çš„å¯¹è±¡ï¼‰ ä»£ç†ç±»ä¸­çš„test()æ–¹æ³•è¢«æ‰§è¡Œæ—¶çš„é€»è¾‘å¦‚ä¸‹ï¼ša. æ‰§è¡Œåˆ‡é¢é€»è¾‘ï¼ˆ@Beforeï¼‰b. è°ƒç”¨target.test() å½“æˆ‘ä»¬ä»Springå®¹å™¨å¾—åˆ°UserServiceçš„Beanå¯¹è±¡æ—¶ï¼Œæ‹¿åˆ°çš„å°±æ˜¯UserServiceProxyæ‰€ç”Ÿæˆçš„å¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ä»£ç†å¯¹è±¡ã€‚UserServiceä»£ç†å¯¹è±¡.test()â€”&gt;æ‰§è¡Œåˆ‡é¢é€»è¾‘â€”&gt;target.test()ï¼Œæ³¨æ„targetå¯¹è±¡ä¸æ˜¯ä»£ç†å¯¹è±¡ï¼Œè€Œæ˜¯è¢«ä»£ç†å¯¹è±¡ã€‚ Springäº‹åŠ¡å½“æˆ‘ä»¬åœ¨æŸä¸ªæ–¹æ³•ä¸ŠåŠ äº†@Transactionalæ³¨è§£åï¼Œå°±è¡¨ç¤ºè¯¥æ–¹æ³•åœ¨è°ƒç”¨æ—¶ä¼šå¼€å¯Springäº‹åŠ¡ï¼Œè€Œè¿™ä¸ªæ–¹æ³•æ‰€åœ¨çš„ç±»æ‰€å¯¹åº”çš„Beanå¯¹è±¡ä¼šæ˜¯è¯¥ç±»çš„ä»£ç†å¯¹è±¡ã€‚ Springäº‹åŠ¡çš„ä»£ç†å¯¹è±¡æ‰§è¡ŒæŸä¸ªæ–¹æ³•æ—¶çš„æ­¥éª¤ï¼š åˆ¤æ–­å½“å‰æ‰§è¡Œçš„æ–¹æ³•æ˜¯å¦å­˜åœ¨@Transactionalæ³¨è§£ å¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ©ç”¨äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransactionManangerï¼‰æ–°å»ºä¸€ä¸ªæ•°æ®åº“è¿æ¥ ä¿®æ”¹æ•°æ®åº“è¿æ¥çš„autocommitä¸ºfalse æ‰§è¡Œtarget.test()ï¼Œæ‰§è¡Œç¨‹åºå‘˜æ‰€å†™çš„ä¸šåŠ¡é€»è¾‘ä»£ç ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œsql æ‰§è¡Œå®Œäº†ä¹‹åå¦‚æœæ²¡æœ‰å‡ºç°å¼‚å¸¸ï¼Œåˆ™æäº¤ï¼Œå¦åˆ™å›æ»š Springäº‹åŠ¡æ˜¯å¦ä¼šå¤±æ•ˆçš„åˆ¤æ–­æ ‡å‡†ï¼šæŸä¸ªåŠ äº†@Transactionalæ³¨è§£çš„æ–¹æ³•è¢«è°ƒç”¨æ—¶ï¼Œè¦åˆ¤æ–­åˆ°åº•æ˜¯ä¸æ˜¯ç›´æ¥è¢«ä»£ç†å¯¹è±¡è°ƒç”¨çš„ï¼Œå¦‚æœæ˜¯åˆ™äº‹åŠ¡ä¼šç”Ÿæ•ˆï¼Œå¦‚æœä¸æ˜¯åˆ™å¤±æ•ˆã€‚","categories":[{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://zhangyong3214.github.io/categories/%E6%A1%86%E6%9E%B6/"}],"tags":[{"name":"åç«¯æŠ€æœ¯","slug":"åç«¯æŠ€æœ¯","permalink":"https://zhangyong3214.github.io/tags/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/"}]},{"title":"ä¼ä¸šå¼€å‘è§„èŒƒå’ŒæŠ€å·§","slug":"å¼€å‘å·¥ä½œ/å¼€å‘è§„èŒƒå’ŒæŠ€å·§","date":"2022-01-27T08:31:13.127Z","updated":"2022-01-27T08:31:13.127Z","comments":true,"path":"2022/01/27/å¼€å‘å·¥ä½œ/å¼€å‘è§„èŒƒå’ŒæŠ€å·§/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E5%BC%80%E5%8F%91%E5%B7%A5%E4%BD%9C/%E5%BC%80%E5%8F%91%E8%A7%84%E8%8C%83%E5%92%8C%E6%8A%80%E5%B7%A7/","excerpt":"","text":"å¼€å‘è§„èŒƒå‰è¨€â€‹ æ²¡æœ‰çœ‹è¿‡é˜¿é‡Œå¼€å‘è§„èŒƒçš„åŒå­¦å¯ä»¥å…ˆé˜…è¯»ä¸€éè§„èŒƒé‡Œé¢çš„å†…å®¹ï¼Œã€ŠJava å¼€å‘æ‰‹å†Œã€‹æ˜¯é˜¿é‡Œå·´å·´é›†å›¢æŠ€æœ¯å›¢é˜Ÿçš„é›†ä½“æ™ºæ…§ç»“æ™¶å’Œç»éªŒæ€»ç»“ï¼Œç»å†äº†å¤šæ¬¡å¤§è§„æ¨¡ä¸€ çº¿å®æˆ˜çš„æ£€éªŒåŠä¸æ–­å®Œå–„ï¼Œå…¬å¼€åˆ°ä¸šç•Œåï¼Œä¼—å¤šç¤¾åŒºå¼€å‘è€…è¸Šè·ƒå‚ä¸ï¼Œå…±åŒæ‰“ç£¨å®Œå–„ï¼Œç³»ç»ŸåŒ–åœ°æ•´ç† æˆå†Œã€‚ä¸ºæé«˜è½¯ä»¶çš„æœ€ç»ˆäº¤ä»˜è´¨é‡ï¼Œäº”èŠ±å…«é—¨çš„é”™è¯¯ç äººä¸ºåœ° å¢åŠ æ’æŸ¥é—®é¢˜çš„éš¾åº¦;æ•°æ®åº“çš„è¡¨ç»“æ„å’Œç´¢å¼•è®¾è®¡ç¼ºé™·å¸¦æ¥çš„ç³»ç»Ÿæ¶æ„ç¼ºé™·æˆ–æ€§èƒ½é£é™©;å·¥ç¨‹ç»“æ„æ·· ä¹±å¯¼è‡´åç»­é¡¹ç›®ç»´æŠ¤è‰°éš¾;æ²¡æœ‰é‰´æƒçš„æ¼æ´ä»£ç æ˜“è¢«é»‘å®¢æ”»å‡»ç­‰ç­‰ï¼Œåˆ¶å®šä¸€å¥—å¼€å‘è§„èŒƒå‡ºæ¥è¿˜æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼Œå¯¹äºå¢å¼ºä»£ç çš„å¯è¯»æ€§ï¼Œæé«˜é¡¹ç›®çš„ç»´æŠ¤æˆæœ¬ï¼Œæé«˜é—®é¢˜çš„æ’æŸ¥é€Ÿåº¦ï¼Œéƒ½ä¼šæœ‰é‡è¦çš„ä½œç”¨ã€‚ å‘½å","categories":[{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"}],"tags":[{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://zhangyong3214.github.io/tags/%E5%BC%80%E5%8F%91/"}]},{"title":"RabbitMQæ¶ˆæ¯ä¸­é—´ä»¶æŠ€æœ¯ç¬”è®°","slug":"å­¦ä¹ ç¬”è®°/RabbitMQ","date":"2022-01-27T08:31:13.126Z","updated":"2022-01-27T08:31:13.127Z","comments":true,"path":"2022/01/27/å­¦ä¹ ç¬”è®°/RabbitMQ/","link":"","permalink":"https://zhangyong3214.github.io/2022/01/27/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/RabbitMQ/","excerpt":"","text":"MQç›¸å…³æ¦‚å¿µä»€ä¹ˆæ˜¯MQMQ(message queue)ï¼Œä»å­—é¢æ„æ€ä¸Šçœ‹ï¼Œæœ¬è´¨æ˜¯ä¸ªé˜Ÿåˆ—ï¼ŒFIFO å…ˆå…¥å…ˆå‡ºï¼Œåªä¸è¿‡é˜Ÿåˆ—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯message è€Œå·²ï¼Œè¿˜æ˜¯ä¸€ç§è·¨è¿›ç¨‹çš„é€šä¿¡æœºåˆ¶ï¼Œç”¨äºä¸Šä¸‹æ¸¸ä¼ é€’æ¶ˆæ¯ã€‚åœ¨äº’è”ç½‘æ¶æ„ä¸­ï¼ŒMQ æ˜¯ä¸€ç§éå¸¸å¸¸è§çš„ä¸Šä¸‹æ¸¸â€œé€»è¾‘è§£è€¦+ç‰©ç†è§£è€¦â€çš„æ¶ˆæ¯é€šä¿¡æœåŠ¡ã€‚ä½¿ç”¨äº† MQä¹‹åï¼Œæ¶ˆæ¯å‘é€ä¸Šæ¸¸åªéœ€è¦ä¾èµ– MQï¼Œä¸ç”¨ä¾èµ–å…¶ä»–æœåŠ¡ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨MQ æµé‡æ¶ˆå³° ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœè®¢å•ç³»ç»Ÿæœ€å¤šèƒ½å¤„ç†ä¸€ä¸‡æ¬¡è®¢å•ï¼Œè¿™ä¸ªå¤„ç†èƒ½åŠ›åº”ä»˜æ­£å¸¸æ—¶æ®µçš„ä¸‹å•æ—¶ç»°ç»°æœ‰ä½™ï¼Œæ­£å¸¸æ—¶æ®µæˆ‘ä»¬ä¸‹å•ä¸€ç§’åå°±èƒ½è¿”å›ç»“æœã€‚ä½†æ˜¯åœ¨é«˜å³°æœŸï¼Œå¦‚æœæœ‰ä¸¤ä¸‡æ¬¡ä¸‹å•æ“ä½œç³»ç»Ÿæ˜¯å¤„ç†ä¸äº†çš„ï¼Œåªèƒ½é™åˆ¶è®¢å•è¶…è¿‡ä¸€ä¸‡åä¸å…è®¸ç”¨æˆ·ä¸‹å•ã€‚ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—åšç¼“å†²ï¼Œæˆ‘ä»¬å¯ä»¥å–æ¶ˆè¿™ä¸ªé™åˆ¶ï¼ŒæŠŠä¸€ç§’å†…ä¸‹çš„è®¢å•åˆ†æ•£æˆä¸€æ®µæ—¶é—´æ¥å¤„ç†ï¼Œè¿™æ—¶æœ‰äº›ç”¨æˆ·å¯èƒ½åœ¨ä¸‹å•åå‡ ç§’åæ‰èƒ½æ”¶åˆ°ä¸‹å•æˆåŠŸçš„æ“ä½œï¼Œä½†æ˜¯æ¯”ä¸èƒ½ä¸‹å•çš„ä½“éªŒè¦å¥½ã€‚ åº”ç”¨è§£è€¦ ä»¥ç”µå•†åº”ç”¨ä¸ºä¾‹ï¼Œåº”ç”¨ä¸­æœ‰è®¢å•ç³»ç»Ÿã€åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿã€‚ç”¨æˆ·åˆ›å»ºè®¢å•åï¼Œå¦‚æœè€¦åˆè°ƒç”¨åº“å­˜ç³»ç»Ÿã€ç‰©æµç³»ç»Ÿã€æ”¯ä»˜ç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªå­ç³»ç»Ÿå‡ºäº†æ•…éšœï¼Œéƒ½ä¼šé€ æˆä¸‹å•æ“ä½œå¼‚å¸¸ã€‚å½“è½¬å˜æˆåŸºäºæ¶ˆæ¯é˜Ÿåˆ—çš„æ–¹å¼åï¼Œç³»ç»Ÿé—´è°ƒç”¨çš„é—®é¢˜ä¼šå‡å°‘å¾ˆå¤šï¼Œæ¯”å¦‚ç‰©æµç³»ç»Ÿå› ä¸ºå‘ç”Ÿæ•…éšœï¼Œéœ€è¦å‡ åˆ†é’Ÿæ¥ä¿®å¤ã€‚åœ¨è¿™å‡ åˆ†é’Ÿçš„æ—¶é—´é‡Œï¼Œç‰©æµç³»ç»Ÿè¦å¤„ç†çš„å†…å­˜è¢«ç¼“å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼Œç”¨æˆ·çš„ä¸‹å•æ“ä½œå¯ä»¥æ­£å¸¸å®Œæˆã€‚å½“ç‰©æµç³»ç»Ÿæ¢å¤åï¼Œç»§ç»­å¤„ç†è®¢å•ä¿¡æ¯å³å¯ï¼Œä¸­å•ç”¨æˆ·æ„Ÿå—ä¸åˆ°ç‰©æµç³»ç»Ÿçš„æ•…éšœï¼Œæå‡ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚ å¼‚æ­¥æé€Ÿ æœ‰äº›æœåŠ¡é—´è°ƒç”¨æ˜¯å¼‚æ­¥çš„ï¼Œä¾‹å¦‚ A è°ƒç”¨ Bï¼ŒB éœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ‰§è¡Œï¼Œä½†æ˜¯ A éœ€è¦çŸ¥é“ B ä»€ä¹ˆæ—¶å€™å¯ä»¥æ‰§è¡Œå®Œï¼Œä»¥å‰ä¸€èˆ¬æœ‰ä¸¤ç§æ–¹å¼ï¼ŒA è¿‡ä¸€æ®µæ—¶é—´å»è°ƒç”¨ B çš„æŸ¥è¯¢ api æŸ¥è¯¢ã€‚æˆ–è€… A æä¾›ä¸€ä¸ª callback apiï¼ŒB æ‰§è¡Œå®Œä¹‹åè°ƒç”¨ api é€šçŸ¥ A æœåŠ¡ã€‚è¿™ä¸¤ç§æ–¹å¼éƒ½ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œä½¿ç”¨æ¶ˆæ¯æ€»çº¿ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒA è°ƒç”¨ B æœåŠ¡åï¼Œåªéœ€è¦ç›‘å¬ B å¤„ç†å®Œæˆçš„æ¶ˆæ¯ï¼Œå½“ B å¤„ç†å®Œæˆåï¼Œä¼šå‘é€ä¸€æ¡æ¶ˆæ¯ç»™ MQï¼ŒMQ ä¼šå°†æ­¤æ¶ˆæ¯è½¬å‘ç»™ A æœåŠ¡ã€‚è¿™æ · A æœåŠ¡æ—¢ä¸ç”¨å¾ªç¯è°ƒç”¨ B çš„æŸ¥è¯¢ apiï¼Œä¹Ÿä¸ç”¨æä¾› callback apiã€‚åŒæ · B æœåŠ¡ä¹Ÿä¸ç”¨åšè¿™äº›æ“ä½œã€‚A æœåŠ¡è¿˜èƒ½åŠæ—¶çš„å¾—åˆ°å¼‚æ­¥å¤„ç†æˆåŠŸçš„æ¶ˆæ¯ã€‚ MQçš„åˆ†ç±» ActiveMQä¼˜ç‚¹ï¼šå•æœºååé‡ä¸‡çº§ï¼Œæ—¶æ•ˆæ€§ ms çº§ï¼Œå¯ç”¨æ€§é«˜ï¼ŒåŸºäºä¸»ä»æ¶æ„å®ç°é«˜å¯ç”¨æ€§ï¼Œæ¶ˆæ¯å¯é æ€§è¾ƒä½çš„æ¦‚ç‡ä¸¢å¤±æ•°æ®ã€‚ ç¼ºç‚¹ï¼šå®˜æ–¹ç¤¾åŒºç°åœ¨å¯¹ ActiveMQ 5.x ç»´æŠ¤è¶Šæ¥è¶Šå°‘ï¼Œé«˜ååé‡åœºæ™¯è¾ƒå°‘ä½¿ç”¨ã€‚ Kafkaå¤§æ•°æ®çš„æ€æ‰‹é”ï¼Œè°ˆåˆ°å¤§æ•°æ®é¢†åŸŸå†…çš„æ¶ˆæ¯ä¼ è¾“ï¼Œåˆ™ç»•ä¸å¼€ Kafkaï¼Œè¿™æ¬¾ä¸ºå¤§æ•°æ®è€Œç”Ÿçš„æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œä»¥å…¶ç™¾ä¸‡çº§ TPS çš„ååé‡åå£°å¤§å™ªï¼Œè¿…é€Ÿæˆä¸ºå¤§æ•°æ®é¢†åŸŸçš„å® å„¿ï¼Œåœ¨æ•°æ®é‡‡é›†ã€ä¼ è¾“ã€å­˜å‚¨çš„è¿‡ç¨‹ä¸­å‘æŒ¥ç€ä¸¾è¶³è½»é‡çš„ä½œç”¨ã€‚ç›®å‰å·²ç»è¢« LinkedInï¼ŒUber, Twitter, Netflix ç­‰å¤§å…¬å¸æ‰€é‡‡çº³ã€‚ ä¼˜ç‚¹ï¼šæ€§èƒ½å“è¶Šï¼Œå•æœºå†™å…¥ TPS çº¦åœ¨ç™¾ä¸‡æ¡/ç§’ï¼Œæœ€å¤§çš„ä¼˜ç‚¹ï¼Œå°±æ˜¯ååé‡é«˜ã€‚æ—¶æ•ˆæ€§ ms çº§å¯ç”¨æ€§éå¸¸é«˜ï¼Œkafka æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¸€ä¸ªæ•°æ®å¤šä¸ªå‰¯æœ¬ï¼Œå°‘æ•°æœºå™¨å®•æœºï¼Œä¸ä¼šä¸¢å¤±æ•°æ®ï¼Œä¸ä¼šå¯¼è‡´ä¸å¯ç”¨,æ¶ˆè´¹è€…é‡‡ç”¨ Pull æ–¹å¼è·å–æ¶ˆæ¯, æ¶ˆæ¯æœ‰åº, é€šè¿‡æ§åˆ¶èƒ½å¤Ÿä¿è¯æ‰€æœ‰æ¶ˆæ¯è¢«æ¶ˆè´¹ä¸”ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡;æœ‰ä¼˜ç§€çš„ç¬¬ä¸‰æ–¹Kafka Web ç®¡ç†ç•Œé¢ Kafka-Managerï¼›åœ¨æ—¥å¿—é¢†åŸŸæ¯”è¾ƒæˆç†Ÿï¼Œè¢«å¤šå®¶å…¬å¸å’Œå¤šä¸ªå¼€æºé¡¹ç›®ä½¿ç”¨ï¼›åŠŸèƒ½æ”¯æŒï¼šåŠŸèƒ½è¾ƒä¸ºç®€å•ï¼Œä¸»è¦æ”¯æŒç®€å•çš„ MQ åŠŸèƒ½ï¼Œåœ¨å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ä»¥åŠæ—¥å¿—é‡‡é›†è¢«å¤§è§„æ¨¡ä½¿ç”¨ã€‚ ç¼ºç‚¹ï¼šKafka å•æœºè¶…è¿‡ 64 ä¸ªé˜Ÿåˆ—/åˆ†åŒºï¼ŒLoad ä¼šå‘ç”Ÿæ˜æ˜¾çš„é£™é«˜ç°è±¡ï¼Œé˜Ÿåˆ—è¶Šå¤šï¼Œload è¶Šé«˜ï¼Œå‘é€æ¶ˆæ¯å“åº”æ—¶é—´å˜é•¿ï¼Œä½¿ç”¨çŸ­è½®è¯¢æ–¹å¼ï¼Œå®æ—¶æ€§å–å†³äºè½®è¯¢é—´éš”æ—¶é—´ï¼Œæ¶ˆè´¹å¤±è´¥ä¸æ”¯æŒé‡è¯•ï¼›æ”¯æŒæ¶ˆæ¯é¡ºåºï¼Œä½†æ˜¯ä¸€å°ä»£ç†å®•æœºåï¼Œå°±ä¼šäº§ç”Ÿæ¶ˆæ¯ä¹±åºï¼Œç¤¾åŒºæ›´æ–°è¾ƒæ…¢ã€‚ RocketMQRocketMQ å‡ºè‡ªé˜¿é‡Œå·´å·´çš„å¼€æºäº§å“ï¼Œç”¨ Java è¯­è¨€å®ç°ï¼Œåœ¨è®¾è®¡æ—¶å‚è€ƒäº† Kafkaï¼Œå¹¶åšå‡ºäº†è‡ªå·±çš„ä¸€äº›æ”¹è¿›ã€‚è¢«é˜¿é‡Œå·´å·´å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œbinglog åˆ†å‘ç­‰åœºæ™¯ã€‚ ä¼˜ç‚¹ï¼šå•æœºååé‡åä¸‡çº§,å¯ç”¨æ€§éå¸¸é«˜ï¼Œåˆ†å¸ƒå¼æ¶æ„,æ¶ˆæ¯å¯ä»¥åšåˆ° 0 ä¸¢å¤±,MQ åŠŸèƒ½è¾ƒä¸ºå®Œå–„ï¼Œè¿˜æ˜¯åˆ†å¸ƒå¼çš„ï¼Œæ‰©å±•æ€§å¥½,æ”¯æŒ 10 äº¿çº§åˆ«çš„æ¶ˆæ¯å †ç§¯ï¼Œä¸ä¼šå› ä¸ºå †ç§¯å¯¼è‡´æ€§èƒ½ä¸‹é™,æºç æ˜¯ java æˆ‘ä»¬å¯ä»¥è‡ªå·±é˜…è¯»æºç ï¼Œå®šåˆ¶è‡ªå·±å…¬å¸çš„ MQã€‚ ç¼ºç‚¹ï¼šæ”¯æŒçš„å®¢æˆ·ç«¯è¯­è¨€ä¸å¤šï¼Œç›®å‰æ˜¯ java åŠ c++ï¼Œå…¶ä¸­ c++ä¸æˆç†Ÿï¼›ç¤¾åŒºæ´»è·ƒåº¦ä¸€èˆ¬,æ²¡æœ‰åœ¨ MQæ ¸å¿ƒä¸­å»å®ç° JMS ç­‰æ¥å£,æœ‰äº›ç³»ç»Ÿè¦è¿ç§»éœ€è¦ä¿®æ”¹å¤§é‡ä»£ç ã€‚ RabbitMQ2007 å¹´å‘å¸ƒï¼Œæ˜¯ä¸€ä¸ªåœ¨ AMQP(é«˜çº§æ¶ˆæ¯é˜Ÿåˆ—åè®®)åŸºç¡€ä¸Šå®Œæˆçš„ï¼Œå¯å¤ç”¨çš„ä¼ä¸šæ¶ˆæ¯ç³»ç»Ÿï¼Œæ˜¯å½“å‰æœ€ä¸»æµçš„æ¶ˆæ¯ä¸­é—´ä»¶ä¹‹ä¸€ã€‚ ä¼˜ç‚¹ï¼šç”±äº erlang è¯­è¨€çš„é«˜å¹¶å‘ç‰¹æ€§ï¼Œæ€§èƒ½è¾ƒå¥½ï¼›ååé‡åˆ°ä¸‡çº§ï¼ŒMQ åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡,å¥å£®ã€ç¨³å®šã€æ˜“ç”¨ã€è·¨å¹³å°ã€æ”¯æŒå¤šç§è¯­è¨€ å¦‚ï¼šPythonã€Rubyã€.NETã€Javaã€JMSã€Cã€PHPã€ActionScriptã€XMPPã€STOMPç­‰ï¼Œæ”¯æŒ AJAX æ–‡æ¡£é½å…¨ï¼›å¼€æºæä¾›çš„ç®¡ç†ç•Œé¢éå¸¸æ£’ï¼Œç”¨èµ·æ¥å¾ˆå¥½ç”¨,ç¤¾åŒºæ´»è·ƒåº¦é«˜ï¼›æ›´æ–°é¢‘ç‡ç›¸å½“é«˜ã€‚ ç¼ºç‚¹ï¼šå•†ä¸šç‰ˆéœ€è¦æ”¶è´¹,å­¦ä¹ æˆæœ¬è¾ƒé«˜ã€‚ MQçš„é€‰æ‹©KafkaKafka ä¸»è¦ç‰¹ç‚¹æ˜¯åŸºäº Pull çš„æ¨¡å¼æ¥å¤„ç†æ¶ˆæ¯æ¶ˆè´¹ï¼Œè¿½æ±‚é«˜ååé‡ï¼Œä¸€å¼€å§‹çš„ç›®çš„å°±æ˜¯ç”¨äºæ—¥å¿—æ”¶é›†å’Œä¼ è¾“ï¼Œé€‚åˆäº§ç”Ÿå¤§é‡æ•°æ®çš„äº’è”ç½‘æœåŠ¡çš„æ•°æ®æ”¶é›†ä¸šåŠ¡ã€‚å¤§å‹å…¬å¸å»ºè®®å¯ä»¥é€‰ç”¨ï¼Œå¦‚æœæœ‰æ—¥å¿—é‡‡é›†åŠŸèƒ½ï¼Œè‚¯å®šæ˜¯é¦–é€‰ kafka äº†ã€‚ RocketMQå¤©ç”Ÿä¸ºé‡‘èäº’è”ç½‘é¢†åŸŸè€Œç”Ÿï¼Œå¯¹äºå¯é æ€§è¦æ±‚å¾ˆé«˜çš„åœºæ™¯ï¼Œå°¤å…¶æ˜¯ç”µå•†é‡Œé¢çš„è®¢å•æ‰£æ¬¾ï¼Œä»¥åŠä¸šåŠ¡å‰Šå³°ï¼Œåœ¨å¤§é‡äº¤æ˜“æ¶Œå…¥æ—¶ï¼Œåç«¯å¯èƒ½æ— æ³•åŠæ—¶å¤„ç†çš„æƒ…å†µã€‚RoketMQ åœ¨ç¨³å®šæ€§ä¸Šå¯èƒ½æ›´å€¼å¾—ä¿¡èµ–ï¼Œè¿™äº›ä¸šåŠ¡åœºæ™¯åœ¨é˜¿é‡ŒåŒ 11 å·²ç»ç»å†äº†å¤šæ¬¡è€ƒéªŒï¼Œå¦‚æœä½ çš„ä¸šåŠ¡æœ‰ä¸Šè¿°å¹¶å‘åœºæ™¯ï¼Œå»ºè®®å¯ä»¥é€‰æ‹© RocketMQã€‚ RabbitMQç»“åˆ erlang è¯­è¨€æœ¬èº«çš„å¹¶å‘ä¼˜åŠ¿ï¼Œæ€§èƒ½å¥½æ—¶æ•ˆæ€§å¾®ç§’çº§ï¼Œç¤¾åŒºæ´»è·ƒåº¦ä¹Ÿæ¯”è¾ƒé«˜ï¼Œç®¡ç†ç•Œé¢ç”¨èµ·æ¥ååˆ†æ–¹ä¾¿ï¼Œå¦‚æœä½ çš„æ•°æ®é‡æ²¡æœ‰é‚£ä¹ˆå¤§ï¼Œä¸­å°å‹å…¬å¸ä¼˜å…ˆé€‰æ‹©åŠŸèƒ½æ¯”è¾ƒå®Œå¤‡çš„ RabbitMQã€‚ RabbitMQç®€ä»‹2007å¹´ï¼ŒRabbit æŠ€æœ¯å…¬å¸åŸºäº AMQP æ ‡å‡†å¼€å‘çš„ RabbitMQ 1.0 å‘å¸ƒã€‚RabbitMQ é‡‡ç”¨ Erlang è¯­è¨€å¼€å‘ã€‚Erlang è¯­è¨€ç”± Ericson è®¾è®¡ï¼Œä¸“é—¨ä¸ºå¼€å‘é«˜å¹¶å‘å’Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸€ç§è¯­è¨€ï¼Œåœ¨ç”µä¿¡é¢†åŸŸä½¿ç”¨å¹¿æ³›ã€‚ RabbitMQå››å¤§æ ¸å¿ƒæ¦‚å¿µ ç”Ÿäº§è€…äº§ç”Ÿæ•°æ®å‘é€æ¶ˆæ¯çš„ç¨‹åºæ˜¯ç”Ÿäº§è€… äº¤æ¢æœºäº¤æ¢æœºæ˜¯ RabbitMQ éå¸¸é‡è¦çš„ä¸€ä¸ªéƒ¨ä»¶ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å®ƒå°†æ¶ˆæ¯æ¨é€åˆ°é˜Ÿåˆ—ä¸­ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†å®ƒæ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œæ˜¯å°†è¿™äº›æ¶ˆæ¯æ¨é€åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯æ¨é€åˆ°å¤šä¸ªé˜Ÿåˆ—ï¼Œäº¦æˆ–è€…æ˜¯æŠŠæ¶ˆæ¯ä¸¢å¼ƒï¼Œè¿™ä¸ªå¾—æœ‰äº¤æ¢æœºç±»å‹å†³å®šã€‚ é˜Ÿåˆ— é˜Ÿåˆ—æ˜¯ RabbitMQ å†…éƒ¨ä½¿ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå°½ç®¡æ¶ˆæ¯æµç» RabbitMQ å’Œåº”ç”¨ç¨‹åºï¼Œä½†å®ƒä»¬åªèƒ½å­˜å‚¨åœ¨é˜Ÿåˆ—ä¸­ã€‚é˜Ÿåˆ—ä»…å—ä¸»æœºçš„å†…å­˜å’Œç£ç›˜é™åˆ¶çš„çº¦æŸï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªå¤§çš„æ¶ˆæ¯ç¼“å†²åŒºã€‚è®¸å¤šç”Ÿäº§è€…å¯ä»¥å°†æ¶ˆæ¯å‘é€åˆ°ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè®¸å¤šæ¶ˆè´¹è€…å¯ä»¥å°è¯•ä»ä¸€ä¸ªé˜Ÿåˆ—æ¥æ”¶æ•°æ®ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨é˜Ÿåˆ—çš„æ–¹å¼ã€‚ æ¶ˆè´¹è€… æ¶ˆè´¹ä¸æ¥æ”¶å…·æœ‰ç›¸ä¼¼çš„å«ä¹‰ã€‚æ¶ˆè´¹è€…å¤§å¤šæ—¶å€™æ˜¯ä¸€ä¸ªç­‰å¾…æ¥æ”¶æ¶ˆæ¯çš„ç¨‹åºã€‚è¯·æ³¨æ„ç”Ÿäº§è€…ï¼Œæ¶ˆè´¹è€…å’Œæ¶ˆæ¯ä¸­é—´ä»¶å¾ˆå¤šæ—¶å€™å¹¶ä¸åœ¨åŒä¸€æœºå™¨ä¸Šã€‚åŒä¸€ä¸ªåº”ç”¨ç¨‹åºæ—¢å¯ä»¥æ˜¯ç”Ÿäº§è€…åˆæ˜¯å¯ä»¥æ˜¯æ¶ˆè´¹è€…ã€‚ RabbitMQçš„å·¥ä½œæ¨¡å¼ ç®€å•æ¨¡å¼ HelloWorldï¼š ä¸€ä¸ªç”Ÿäº§è€…ã€ä¸€ä¸ªæ¶ˆè´¹è€…ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰ã€‚ å·¥ä½œé˜Ÿåˆ—æ¨¡å¼ Work Queueï¼š ä¸€ä¸ªç”Ÿäº§è€…ã€å¤šä¸ªæ¶ˆè´¹è€…ï¼ˆç«äº‰å…³ç³»ï¼‰ï¼Œä¸éœ€è¦è®¾ç½®äº¤æ¢æœºï¼ˆä½¿ç”¨é»˜è®¤çš„äº¤æ¢æœºï¼‰ã€‚ å‘å¸ƒè®¢é˜…æ¨¡å¼ Publish/subscribeï¼šéœ€è¦è®¾ç½®ç±»å‹ä¸º fanout çš„äº¤æ¢æœºï¼Œå¹¶ä¸”äº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šå°†æ¶ˆæ¯å‘é€åˆ°ç»‘å®šçš„é˜Ÿåˆ—ã€‚ è·¯ç”±æ¨¡å¼ Routingï¼š éœ€è¦è®¾ç½®ç±»å‹ä¸º direct çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®š routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚ é€šé…ç¬¦æ¨¡å¼ Topicï¼šéœ€è¦è®¾ç½®ç±»å‹ä¸º topic çš„äº¤æ¢æœºï¼Œäº¤æ¢æœºå’Œé˜Ÿåˆ—è¿›è¡Œç»‘å®šï¼Œå¹¶ä¸”æŒ‡å®šé€šé…ç¬¦æ–¹å¼çš„ routing keyï¼Œå½“å‘é€æ¶ˆæ¯åˆ°äº¤æ¢æœºåï¼Œäº¤æ¢æœºä¼šæ ¹æ® routing key å°†æ¶ˆæ¯å‘é€åˆ°å¯¹åº”çš„é˜Ÿåˆ—ã€‚ RabbitMQå·¥ä½œåŸç† Brokerï¼šæ¥æ”¶å’Œåˆ†å‘æ¶ˆæ¯çš„åº”ç”¨ï¼ŒRabbitMQ Server å°±æ˜¯ Message Broker Virtual hostï¼šå‡ºäºå¤šç§Ÿæˆ·å’Œå®‰å…¨å› ç´ è®¾è®¡çš„ï¼ŒæŠŠ AMQP çš„åŸºæœ¬ç»„ä»¶åˆ’åˆ†åˆ°ä¸€ä¸ªè™šæ‹Ÿçš„åˆ†ç»„ä¸­ï¼Œç±»ä¼¼äºç½‘ç»œä¸­çš„ namespace æ¦‚å¿µã€‚å½“å¤šä¸ªä¸åŒçš„ç”¨æˆ·ä½¿ç”¨åŒä¸€ä¸ª RabbitMQ server æä¾›çš„æœåŠ¡æ—¶ï¼Œå¯ä»¥åˆ’åˆ†å‡ºå¤šä¸ª vhostï¼Œæ¯ä¸ªç”¨æˆ·åœ¨è‡ªå·±çš„ vhost åˆ›å»º exchangeï¼queue ç­‰ Connectionï¼špublisherï¼consumer å’Œ broker ä¹‹é—´çš„ TCP è¿æ¥ Channelï¼šå¦‚æœæ¯ä¸€æ¬¡è®¿é—® RabbitMQ éƒ½å»ºç«‹ä¸€ä¸ª Connectionï¼Œåœ¨æ¶ˆæ¯é‡å¤§çš„æ—¶å€™å»ºç«‹ TCPConnection çš„å¼€é”€å°†æ˜¯å·¨å¤§çš„ï¼Œæ•ˆç‡ä¹Ÿè¾ƒä½ã€‚Channel æ˜¯åœ¨ connection å†…éƒ¨å»ºç«‹çš„é€»è¾‘è¿æ¥ï¼Œå¦‚æœåº”ç”¨ç¨‹åºæ”¯æŒå¤šçº¿ç¨‹ï¼Œé€šå¸¸æ¯ä¸ª thread åˆ›å»ºå•ç‹¬çš„ channel è¿›è¡Œé€šè®¯ï¼ŒAMQP method åŒ…å«äº† channel id å¸®åŠ©å®¢æˆ·ç«¯å’Œ message broker è¯†åˆ« channelï¼Œæ‰€ä»¥ channel ä¹‹é—´æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚ l Channel ä½œä¸ºè½»é‡çº§çš„Connection æå¤§å‡å°‘äº†æ“ä½œç³»ç»Ÿå»ºç«‹ TCP connection çš„å¼€é”€ Exchange ï¼š message åˆ°è¾¾ broker çš„ç¬¬ä¸€ç«™ï¼Œæ ¹æ®åˆ†å‘è§„åˆ™ï¼ŒåŒ¹é…æŸ¥è¯¢è¡¨ä¸­çš„ routing keyï¼Œåˆ†å‘æ¶ˆæ¯åˆ° queue ä¸­å»ã€‚å¸¸ç”¨çš„ç±»å‹æœ‰ï¼šdirect (point-to-point), topic (publish-subscribe) and fanout(multicast) Queue ï¼š æ¶ˆæ¯æœ€ç»ˆè¢«é€åˆ°è¿™é‡Œç­‰å¾… consumer å–èµ° Binding ï¼š exchange å’Œ queue ä¹‹é—´çš„è™šæ‹Ÿè¿æ¥ï¼Œbinding ä¸­å¯ä»¥åŒ…å« routing keyï¼ŒBinding ä¿¡æ¯è¢«ä¿å­˜åˆ° exchange ä¸­çš„æŸ¥è¯¢è¡¨ä¸­ï¼Œç”¨äº message çš„åˆ†å‘ä¾æ® RabbitMQå®‰è£…ç•¥â€¦.æ¨èä½¿ç”¨Dockerå®‰è£…å­¦ä¹ ï¼Œå‚è€ƒæ–‡ç« ï¼šDockeræ“ä½œç¬”è®°-ä»å°ç™½åˆ°å…¥é—¨ RabbitMQåœ¨å®‰è£…å¥½åï¼Œå¯ä»¥è®¿é—®http://ipåœ°å€:15672 ;å…¶è‡ªå¸¦äº†guest/guestçš„ ç”¨æˆ·åå’Œå¯†ç ã€‚ è§’è‰²è¯´æ˜ è¶…çº§ç®¡ç†å‘˜(administrator)ï¼šå¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œå¯æŸ¥çœ‹æ‰€æœ‰çš„ä¿¡æ¯ï¼Œå¹¶ä¸”å¯ä»¥å¯¹ç”¨æˆ·ï¼Œç­–ç•¥(policy)è¿›è¡Œæ“ ä½œã€‚ ç›‘æ§è€…(monitoring)ï¼šå¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹rabbitmqèŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯(è¿›ç¨‹æ•°ï¼Œå†…å­˜ä½¿ç”¨ æƒ…å†µï¼Œç£ç›˜ä½¿ç”¨æƒ…å†µç­‰)ã€‚ ç­–ç•¥åˆ¶å®šè€…(policymaker)ï¼šå¯ç™»é™†ç®¡ç†æ§åˆ¶å°, åŒæ—¶å¯ä»¥å¯¹policyè¿›è¡Œç®¡ç†ã€‚ä½†æ— æ³•æŸ¥çœ‹èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯(ä¸Š å›¾çº¢æ¡†æ ‡è¯†çš„éƒ¨åˆ†)ã€‚ æ™®é€šç®¡ç†è€…(management)ï¼šä»…å¯ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œæ— æ³•çœ‹åˆ°èŠ‚ç‚¹ä¿¡æ¯ï¼Œä¹Ÿæ— æ³•å¯¹ç­–ç•¥è¿›è¡Œç®¡ç†ã€‚ å…¶ä»–ï¼šæ— æ³•ç™»é™†ç®¡ç†æ§åˆ¶å°ï¼Œé€šå¸¸å°±æ˜¯æ™®é€šçš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ã€‚ æ¶ˆæ¯åº”ç­”åŠæŒä¹…åŒ–æ¶ˆæ¯åº”ç­”æœºåˆ¶æ¦‚å¿µæ¶ˆè´¹è€…å®Œæˆä¸€ä¸ªä»»åŠ¡å¯èƒ½éœ€è¦ä¸€æ®µæ—¶é—´ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…å¤„ç†ä¸€ä¸ªé•¿çš„ä»»åŠ¡å¹¶ä»…åªå®Œæˆäº†éƒ¨åˆ†çªç„¶å®ƒæŒ‚æ‰äº†ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆæƒ…å†µã€‚RabbitMQ ä¸€æ—¦å‘æ¶ˆè´¹è€…ä¼ é€’äº†ä¸€æ¡æ¶ˆæ¯ï¼Œä¾¿ç«‹å³å°†è¯¥æ¶ˆæ¯æ ‡è®°ä¸ºåˆ é™¤ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œçªç„¶æœ‰ä¸ªæ¶ˆè´¹è€…æŒ‚æ‰äº†ï¼Œæˆ‘ä»¬å°†ä¸¢å¤±æ­£åœ¨å¤„ç†çš„æ¶ˆæ¯ã€‚ä»¥åŠåç»­å‘é€ç»™è¯¥æ¶ˆè´¹è¿™çš„æ¶ˆæ¯ï¼Œå› ä¸ºå®ƒæ— æ³•æ¥æ”¶åˆ°ã€‚ä¸ºäº†ä¿è¯æ¶ˆæ¯åœ¨å‘é€è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ï¼Œrabbitmq å¼•å…¥æ¶ˆæ¯åº”ç­”æœºåˆ¶ï¼Œæ¶ˆæ¯åº”ç­”å°±æ˜¯: æ¶ˆè´¹è€…åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯å¹¶ä¸”å¤„ç†è¯¥æ¶ˆæ¯ä¹‹åï¼Œå‘Šè¯‰rabbitmq å®ƒå·²ç»å¤„ç†äº†ï¼Œrabbitmq å¯ä»¥æŠŠè¯¥æ¶ˆæ¯åˆ é™¤äº†ã€‚ è‡ªåŠ¨åº”ç­”æ¶ˆæ¯å‘é€åç«‹å³è¢«è®¤ä¸ºå·²ç»ä¼ é€æˆåŠŸï¼Œè¿™ç§æ¨¡å¼éœ€è¦åœ¨é«˜ååé‡å’Œæ•°æ®ä¼ è¾“å®‰å…¨æ€§æ–¹é¢åšæƒè¡¡,å› ä¸ºè¿™ç§æ¨¡å¼å¦‚æœæ¶ˆæ¯åœ¨æ¥æ”¶åˆ°ä¹‹å‰ï¼Œæ¶ˆè´¹è€…é‚£è¾¹å‡ºç°è¿æ¥æˆ–è€… channel å…³é—­ï¼Œé‚£ä¹ˆæ¶ˆæ¯å°±ä¸¢å¤±äº†,å½“ç„¶å¦ä¸€æ–¹é¢è¿™ç§æ¨¡å¼æ¶ˆè´¹è€…é‚£è¾¹å¯ä»¥ä¼ é€’è¿‡è½½çš„æ¶ˆæ¯ï¼Œæ²¡æœ‰å¯¹ä¼ é€’çš„æ¶ˆæ¯æ•°é‡è¿›è¡Œé™åˆ¶ï¼Œå½“ç„¶è¿™æ ·æœ‰å¯èƒ½ä½¿å¾—æ¶ˆè´¹è€…è¿™è¾¹ç”±äºæ¥æ”¶å¤ªå¤šè¿˜æ¥ä¸åŠå¤„ç†çš„æ¶ˆæ¯ï¼Œå¯¼è‡´è¿™äº›æ¶ˆæ¯çš„ç§¯å‹ï¼Œæœ€ç»ˆä½¿å¾—å†…å­˜è€—å°½ï¼Œæœ€ç»ˆè¿™äº›æ¶ˆè´¹è€…çº¿ç¨‹è¢«æ“ä½œç³»ç»Ÿæ€æ­»ï¼Œ æ‰€ä»¥è¿™ç§æ¨¡å¼ä»…é€‚ç”¨åœ¨æ¶ˆè´¹è€…å¯ä»¥é«˜æ•ˆå¹¶ä»¥æŸç§é€Ÿç‡èƒ½å¤Ÿå¤„ç†è¿™äº›æ¶ˆæ¯çš„æƒ…å†µä¸‹ä½¿ç”¨ã€‚ æ€»ç»“ï¼šå°½é‡å°‘ç”¨è‡ªåŠ¨åº”ç­”ï¼Œè‡ªåŠ¨åº”ç­”æ˜¯åœ¨æ¥æ”¶åˆ°æ¶ˆæ¯çš„ä¸€åˆ¹é‚£å°±è¿›è¡Œäº†åº”ç­”ï¼Œå¦‚æœåç»­å¯¹æ¶ˆæ¯è¿›è¡Œäº†å¤„ç†å‡ºç°é”™è¯¯ï¼Œä¸èƒ½é‡æ–°ä»é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯å¤„ç†ã€‚ æ‰‹åŠ¨åº”ç­”æ¶ˆæ¯åº”ç­”çš„æ–¹æ³• Channel.basicAck(ç”¨äºè‚¯å®šç¡®è®¤)ï¼šRabbitMQ å·²çŸ¥é“è¯¥æ¶ˆæ¯å¹¶ä¸”æˆåŠŸçš„å¤„ç†æ¶ˆæ¯ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº† Channel.basicNack(ç”¨äºå¦å®šç¡®è®¤) Channel.basicReject(ç”¨äºå¦å®šç¡®è®¤)ï¼šä¸ Channel.basicNack ç›¸æ¯”å°‘ä¸€ä¸ªå‚æ•°(æ˜¯å¦æ‰¹é‡å¤„ç†)ï¼Œä¸å¤„ç†è¯¥æ¶ˆæ¯äº†ç›´æ¥æ‹’ç»ï¼Œå¯ä»¥å°†å…¶ä¸¢å¼ƒäº† æ‰‹åŠ¨åº”ç­”çš„å¥½å¤„æ˜¯å¯ä»¥æ‰¹é‡åº”ç­”å¹¶ä¸”å‡å°‘ç½‘ç»œæ‹¥å µ multiple çš„ true å’Œ false ä»£è¡¨ä¸åŒæ„æ€ true ä»£è¡¨æ‰¹é‡åº”ç­” channel ä¸Šæœªåº”ç­”çš„æ¶ˆæ¯ï¼Œæ¯”å¦‚è¯´ channel ä¸Šæœ‰ä¼ é€ tag çš„æ¶ˆæ¯ 5,6,7,8 å½“å‰ tag æ˜¯ 8 é‚£ä¹ˆæ­¤æ—¶5-8 çš„è¿™äº›è¿˜æœªåº”ç­”çš„æ¶ˆæ¯éƒ½ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­” false åŒä¸Šé¢ç›¸æ¯”åªä¼šåº”ç­” tag=8 çš„æ¶ˆæ¯ 5,6,7 è¿™ä¸‰ä¸ªæ¶ˆæ¯ä¾ç„¶ä¸ä¼šè¢«ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯åº”ç­” æ¶ˆæ¯è‡ªåŠ¨é‡æ–°å…¥é˜Ÿå¦‚æœæ¶ˆè´¹è€…ç”±äºæŸäº›åŸå› å¤±å»è¿æ¥(å…¶é€šé“å·²å…³é—­ï¼Œè¿æ¥å·²å…³é—­æˆ– TCP è¿æ¥ä¸¢å¤±)ï¼Œå¯¼è‡´æ¶ˆæ¯æœªå‘é€ ACK ç¡®è®¤ï¼ŒRabbitMQ å°†äº†è§£åˆ°æ¶ˆæ¯æœªå®Œå…¨å¤„ç†ï¼Œå¹¶å°†å¯¹å…¶é‡æ–°æ’é˜Ÿã€‚å¦‚æœæ­¤æ—¶å…¶ä»–æ¶ˆè´¹è€…å¯ä»¥å¤„ç†ï¼Œå®ƒå°†å¾ˆå¿«å°†å…¶é‡æ–°åˆ†å‘ç»™å¦ä¸€ä¸ªæ¶ˆè´¹è€…ã€‚è¿™æ ·ï¼Œå³ä½¿æŸä¸ªæ¶ˆè´¹è€…å¶å°”æ­»äº¡ï¼Œä¹Ÿå¯ä»¥ç¡®ä¿ä¸ä¼šä¸¢å¤±ä»»ä½•æ¶ˆæ¯ã€‚ æ¶ˆæ¯æ‰‹åŠ¨åº”ç­”ä»£ç ç¼–å†™é»˜è®¤æ¶ˆæ¯é‡‡ç”¨çš„æ˜¯è‡ªåŠ¨åº”ç­”ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æƒ³å®ç°æ¶ˆæ¯æ¶ˆè´¹è¿‡ç¨‹ä¸­ä¸ä¸¢å¤±ï¼Œéœ€è¦æŠŠè‡ªåŠ¨åº”ç­”æ”¹ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œæ¶ˆè´¹è€…åœ¨ä¸Šé¢ä»£ç çš„åŸºç¡€ä¸Šå¢åŠ ä¸‹é¢ç”»çº¢è‰²éƒ¨åˆ†ä»£ç ã€‚ æ¶ˆæ¯ç”Ÿäº§è€…123456789101112131415161718public class Producer &#123; // é˜Ÿåˆ—åç§° public static final String TASK_QUEUE_NAME = &quot;ack_queue&quot;; public static void main(String[] args) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); // å£°æ˜é˜Ÿåˆ—ï¼šé˜Ÿåˆ—åç§°ï¼Œæ˜¯å¦æŒä¹…åŒ–ï¼Œæ˜¯å¦å…±äº«ï¼Œè‡ªåŠ¨åˆ é™¤ï¼Œå‚æ•° channel.queueDeclare(TASK_QUEUE_NAME, false, false, false, null); Scanner scanner = new Scanner(System.in); while (scanner.hasNext()) &#123; String message = scanner.next(); channel.basicPublish(&quot;&quot;, TASK_QUEUE_NAME, null, message.getBytes(StandardCharsets.UTF_8)); log.info(&quot;ç”Ÿäº§è€…å‘é€æ¶ˆæ¯ï¼š&#123;&#125;&quot;, message); &#125; &#125;&#125; RabbitMQ è¿æ¥å·¥å…·ç±» 123456789101112131415public class RabbitMqUtils &#123; // å¾—åˆ°ä¸€ä¸ªè¿æ¥çš„ channel public static Channel getChannel() throws Exception &#123; // åˆ›å»ºä¸€ä¸ªè¿æ¥å·¥å‚ ConnectionFactory factory = new ConnectionFactory(); factory.setHost(&quot;127.0.0.1&quot;); factory.setPort(5672); factory.setUsername(&quot;guest&quot;); factory.setPassword(&quot;guest&quot;); factory.setVirtualHost(&quot;demo&quot;); Connection connection = factory.newConnection(); Channel channel = connection.createChannel(); return channel; &#125;&#125; æ¶ˆè´¹è€…1234567891011121314151617181920212223242526public class Work01 &#123; private static final String ACK_QUEUE_NAME = &quot;ack_queue&quot;; public static void main(String[] args) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); System.out.println(&quot;Work01 ç­‰å¾…æ¥æ”¶æ¶ˆæ¯å¤„ç†æ—¶é—´è¾ƒçŸ­&quot;); // æ¶ˆæ¯æ¶ˆè´¹çš„æ—¶å€™å¦‚ä½•å¤„ç†æ¶ˆæ¯ DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody()); // ä¸šåŠ¡å¤„ç†è€—æ—¶1ç§’ SleepUtils.sleep(1); System.out.println(&quot; æ¥æ”¶åˆ°æ¶ˆæ¯:&quot; + message); /** * é‡‡ç”¨æ‰‹åŠ¨åº”ç­” * 1. æ¶ˆæ¯æ ‡è®° tag * 2. æ˜¯å¦æ‰¹é‡åº”ç­”æœªåº”ç­”æ¶ˆæ¯ï¼šä¸æ‰¹é‡ä¿¡é“ä¸­çš„æ¶ˆæ¯ */ channel.basicAck(delivery.getEnvelope().getDeliveryTag(), false); &#125;; // ***é‡‡ç”¨æ‰‹åŠ¨åº”ç­” boolean autoAck = false; channel.basicConsume(ACK_QUEUE_NAME, autoAck, deliverCallback, (consumerTag) -&gt; &#123; System.out.println(consumerTag + &quot; æ¶ˆè´¹è€…å–æ¶ˆæ¶ˆè´¹æ¥å£å›è°ƒé€»è¾‘&quot;); &#125;); &#125;&#125; ç¡çœ å·¥å…· 123456789public class SleepUtils &#123; public static void sleep(int second) &#123; try &#123; Thread.sleep(1000L * second); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125;&#125; RabbitMQ æŒä¹…åŒ–æŒä¹…åŒ–æ¦‚å¿µåˆšåˆšæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•å¤„ç†ä»»åŠ¡ä¸ä¸¢å¤±çš„æƒ…å†µï¼Œä½†æ˜¯å¦‚ä½•ä¿éšœå½“ RabbitMQ æœåŠ¡åœæ‰ä»¥åæ¶ˆæ¯ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„æ¶ˆæ¯ä¸ä¸¢å¤±ã€‚é»˜è®¤æƒ…å†µä¸‹ RabbitMQ é€€å‡ºæˆ–ç”±äºæŸç§åŸå› å´©æºƒæ—¶ï¼Œå®ƒå¿½è§†é˜Ÿåˆ—å’Œæ¶ˆæ¯ï¼Œé™¤éå‘ŠçŸ¥å®ƒä¸è¦è¿™æ ·åšã€‚ç¡®ä¿æ¶ˆæ¯ä¸ä¼šä¸¢å¤±éœ€è¦åšä¸¤ä»¶äº‹ï¼šæˆ‘ä»¬éœ€è¦å°†é˜Ÿåˆ—å’Œæ¶ˆæ¯éƒ½æ ‡è®°ä¸ºæŒä¹…åŒ–ã€‚ é˜Ÿåˆ—å®ç°æŒä¹…åŒ–ä¹‹å‰æˆ‘ä»¬åˆ›å»ºçš„é˜Ÿåˆ—éƒ½æ˜¯éæŒä¹…åŒ–çš„ï¼Œrabbitmq å¦‚æœé‡å¯çš„åŒ–ï¼Œè¯¥é˜Ÿåˆ—å°±ä¼šè¢«åˆ é™¤æ‰ï¼Œå¦‚æœ è¦é˜Ÿåˆ—å®ç°æŒä¹…åŒ– éœ€è¦åœ¨å£°æ˜é˜Ÿåˆ—çš„æ—¶å€™æŠŠ durable å‚æ•°è®¾ç½®ä¸ºæŒä¹…åŒ– ä½†æ˜¯éœ€è¦æ³¨æ„çš„å°±æ˜¯å¦‚æœä¹‹å‰å£°æ˜çš„é˜Ÿåˆ—ä¸æ˜¯æŒä¹…åŒ–çš„ï¼Œéœ€è¦æŠŠåŸå…ˆé˜Ÿåˆ—å…ˆåˆ é™¤ï¼Œæˆ–è€…é‡æ–°åˆ›å»ºä¸€ä¸ªæŒä¹…åŒ–çš„é˜Ÿåˆ—ï¼Œä¸ç„¶å°±ä¼šå‡ºç°é”™è¯¯ã€‚ ä»¥ä¸‹ä¸ºæ§åˆ¶å°ä¸­æŒä¹…åŒ–ä¸éæŒä¹…åŒ–é˜Ÿåˆ—çš„ UI æ˜¾ç¤ºåŒºï¼š è¿™ä¸ªæ—¶å€™å³ä½¿é‡å¯ rabbitmq é˜Ÿåˆ—ä¹Ÿä¾ç„¶å­˜åœ¨ã€‚ æ¶ˆæ¯å®ç°æŒä¹…åŒ–è¦æƒ³è®©æ¶ˆæ¯å®ç°æŒä¹…åŒ–éœ€è¦åœ¨æ¶ˆæ¯ç”Ÿäº§è€…ä¿®æ”¹ä»£ç ï¼ŒMessageProperties.PERSISTENT_TEXT_PLAIN æ·»åŠ è¿™ä¸ªå±æ€§ï¼Œå¦‚ä¸‹å›¾ å°†æ¶ˆæ¯æ ‡è®°ä¸ºæŒä¹…åŒ–å¹¶ä¸èƒ½å®Œå…¨ä¿è¯ä¸ä¼šä¸¢å¤±æ¶ˆæ¯ã€‚å°½ç®¡å®ƒå‘Šè¯‰ RabbitMQ å°†æ¶ˆæ¯ä¿å­˜åˆ°ç£ç›˜ï¼Œä½†æ˜¯ è¿™é‡Œä¾ç„¶å­˜åœ¨å½“æ¶ˆæ¯åˆšå‡†å¤‡å­˜å‚¨åœ¨ç£ç›˜çš„æ—¶å€™ ä½†æ˜¯è¿˜æ²¡æœ‰å­˜å‚¨å®Œï¼Œæ¶ˆæ¯è¿˜åœ¨ç¼“å­˜çš„ä¸€ä¸ªé—´éš”ç‚¹ã€‚æ­¤æ—¶å¹¶æ²¡ æœ‰çœŸæ­£å†™å…¥ç£ç›˜ã€‚æŒä¹…æ€§ä¿è¯å¹¶ä¸å¼ºï¼Œä½†æ˜¯å¯¹äºæˆ‘ä»¬çš„ç®€å•ä»»åŠ¡é˜Ÿåˆ—è€Œè¨€ï¼Œè¿™å·²ç»ç»°ç»°æœ‰ä½™äº†ã€‚å¦‚æœéœ€è¦ æ›´å¼ºæœ‰åŠ›çš„æŒä¹…åŒ–ç­–ç•¥ï¼Œå‚è€ƒåè¾¹è¯¾ä»¶å‘å¸ƒç¡®è®¤ç« èŠ‚ã€‚ ä¸å…¬å¹³åˆ†å‘åœ¨æœ€å¼€å§‹çš„æ—¶å€™æˆ‘ä»¬å­¦ä¹ åˆ° RabbitMQ åˆ†å‘æ¶ˆæ¯é‡‡ç”¨çš„è½®è®­åˆ†å‘ï¼Œä½†æ˜¯åœ¨æŸç§åœºæ™¯ä¸‹è¿™ç§ç­–ç•¥å¹¶ä¸æ˜¯å¾ˆå¥½ï¼Œæ¯”æ–¹è¯´æœ‰ä¸¤ä¸ªæ¶ˆè´¹è€…åœ¨å¤„ç†ä»»åŠ¡ï¼Œå…¶ä¸­æœ‰ä¸ªæ¶ˆè´¹è€… 1 å¤„ç†ä»»åŠ¡çš„é€Ÿåº¦éå¸¸å¿«ï¼Œè€Œå¦å¤–ä¸€ä¸ªæ¶ˆè´¹è€… 2 å¤„ç†é€Ÿåº¦å´å¾ˆæ…¢ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¿˜æ˜¯é‡‡ç”¨è½®è®­åˆ†å‘çš„åŒ–å°±ä¼šåˆ°è¿™å¤„ç†é€Ÿåº¦å¿«çš„è¿™ä¸ªæ¶ˆè´¹è€…å¾ˆå¤§ä¸€éƒ¨åˆ†æ—¶é—´å¤„äºç©ºé—²çŠ¶æ€ï¼Œè€Œå¤„ç†æ…¢çš„é‚£ä¸ªæ¶ˆè´¹è€…ä¸€ç›´åœ¨å¹²æ´»ï¼Œè¿™ç§åˆ†é…æ–¹å¼åœ¨è¿™ç§æƒ…å†µä¸‹å…¶å®å°±ä¸å¤ªå¥½ï¼Œä½†æ˜¯RabbitMQ å¹¶ä¸çŸ¥é“è¿™ç§æƒ…å†µå®ƒä¾ç„¶å¾ˆå…¬å¹³çš„è¿›è¡Œåˆ†å‘ã€‚ æ³¨ï¼šä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è®¾ç½®å‚æ•° channel.basicQos(1)ï¼Œä¸å…¬å¹³åˆ†å‘ç”±æ¶ˆè´¹æ–¹è®¾ç½®ï¼Œç”Ÿäº§ç¯å¢ƒåº”è¯¥è®¾ç½®ä¸ºä¸å…¬å¹³åˆ†å‘ã€‚ æ„æ€å°±æ˜¯å¦‚æœè¿™ä¸ªä»»åŠ¡æˆ‘è¿˜æ²¡æœ‰å¤„ç†å®Œæˆ–è€…æˆ‘è¿˜æ²¡æœ‰åº”ç­”ä½ ï¼Œä½ å…ˆåˆ«åˆ†é…ç»™æˆ‘ï¼Œæˆ‘ç›®å‰åªèƒ½å¤„ç†ä¸€ä¸ªä»»åŠ¡ï¼Œç„¶å rabbitmq å°±ä¼šæŠŠè¯¥ä»»åŠ¡åˆ†é…ç»™æ²¡æœ‰é‚£ä¹ˆå¿™çš„é‚£ä¸ªç©ºé—²æ¶ˆè´¹è€…ï¼Œå½“ç„¶å¦‚æœæ‰€æœ‰çš„æ¶ˆè´¹è€…éƒ½æ²¡æœ‰å®Œæˆæ‰‹ä¸Šä»»åŠ¡ï¼Œé˜Ÿåˆ—è¿˜åœ¨ä¸åœçš„æ·»åŠ æ–°ä»»åŠ¡ï¼Œé˜Ÿåˆ—æœ‰å¯èƒ½å°±ä¼šé‡åˆ°é˜Ÿåˆ—è¢«æ’‘æ»¡çš„æƒ…å†µï¼Œè¿™ä¸ªæ—¶å€™å°±åªèƒ½æ·»åŠ æ–°çš„ worker æˆ–è€…æ”¹å˜å…¶ä»–å­˜å‚¨ä»»åŠ¡çš„ç­–ç•¥ã€‚ å‘å¸ƒç¡®è®¤å‘å¸ƒç¡®è®¤åŸç†ç”Ÿäº§è€…å°†ä¿¡é“è®¾ç½®æˆ confirm æ¨¡å¼ï¼Œä¸€æ—¦ä¿¡é“è¿›å…¥confirm æ¨¡å¼ï¼Œæ‰€æœ‰åœ¨è¯¥ä¿¡é“ä¸Šé¢å‘å¸ƒçš„æ¶ˆæ¯éƒ½å°†ä¼šè¢«æŒ‡æ´¾ä¸€ä¸ªå”¯ä¸€çš„ID(ä»1å¼€å§‹)ï¼Œä¸€æ—¦æ¶ˆæ¯è¢«æŠ•é€’åˆ°æ‰€æœ‰åŒ¹é…çš„é˜Ÿåˆ—ä¹‹åï¼Œbroker å°±ä¼šå‘é€ä¸€ä¸ªç¡®è®¤ç»™ç”Ÿäº§è€…(åŒ…å«æ¶ˆæ¯çš„å”¯ä¸€ID)ï¼Œè¿™å°±ä½¿å¾—ç”Ÿäº§è€…çŸ¥é“æ¶ˆæ¯å·²ç»æ­£ç¡®åˆ°è¾¾ç›®çš„é˜Ÿåˆ—äº†ï¼Œå¦‚æœæ¶ˆæ¯å’Œé˜Ÿåˆ—æ˜¯å¯æŒä¹…åŒ–çš„ï¼Œé‚£ä¹ˆç¡®è®¤æ¶ˆæ¯ä¼šåœ¨å°†æ¶ˆæ¯å†™å…¥ç£ç›˜ä¹‹åå‘å‡ºï¼Œbrokerå›ä¼  ç»™ç”Ÿäº§è€…çš„ç¡®è®¤æ¶ˆæ¯ä¸­ delivery-tag åŸŸåŒ…å«äº†ç¡®è®¤æ¶ˆæ¯çš„åºåˆ—å·ï¼Œæ­¤å¤–brokerä¹Ÿå¯ä»¥è®¾ç½®basic.ackçš„multipleåŸŸï¼Œè¡¨ç¤ºåˆ°è¿™ä¸ªåºåˆ—å·ä¹‹å‰çš„æ‰€æœ‰æ¶ˆæ¯éƒ½å·²ç»å¾—åˆ°äº†å¤„ç†ã€‚confirm æ¨¡å¼æœ€å¤§çš„å¥½å¤„åœ¨äºä»–æ˜¯å¼‚æ­¥çš„ï¼Œä¸€æ—¦å‘å¸ƒä¸€æ¡æ¶ˆæ¯ï¼Œç”Ÿäº§è€…åº”ç”¨ç¨‹åºå°±å¯ä»¥åœ¨ç­‰ä¿¡é“è¿”å›ç¡®è®¤çš„åŒæ—¶ç»§ç»­å‘é€ä¸‹ä¸€æ¡æ¶ˆæ¯ï¼Œå½“æ¶ˆæ¯æœ€ç»ˆå¾—åˆ°ç¡®è®¤ä¹‹åï¼Œç”Ÿäº§è€…åº”ç”¨ä¾¿å¯ä»¥é€šè¿‡å›è°ƒæ–¹æ³•æ¥å¤„ç†è¯¥ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœ RabbitMQå› ä¸ºè‡ªèº«å†…éƒ¨é”™è¯¯å¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œå°±ä¼šå‘é€ä¸€æ¡nackæ¶ˆ æ¯ï¼Œç”Ÿäº§è€…åº”ç”¨ç¨‹åºåŒæ ·å¯ä»¥åœ¨å›è°ƒæ–¹æ³•ä¸­å¤„ç†è¯¥nackæ¶ˆæ¯ã€‚ å‘å¸ƒç¡®è®¤çš„ç­–ç•¥å¼€å¯å‘å¸ƒç¡®è®¤çš„æ–¹æ³•å‘å¸ƒç¡®è®¤é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œå¦‚æœè¦å¼€å¯éœ€è¦è°ƒç”¨æ–¹æ³• confirmSelectï¼Œæ¯å½“ä½ è¦æƒ³ä½¿ç”¨å‘å¸ƒç¡®è®¤ï¼Œéƒ½éœ€è¦åœ¨ channel ä¸Šè°ƒç”¨è¯¥æ–¹æ³•ã€‚ 12Channel channel = connection.createchannel();channel.confirmselect(); ç¬¬ä¸€ç§ï¼šå•ä¸ªç¡®è®¤å‘å¸ƒè¿™æ˜¯ä¸€ç§ç®€å•çš„ç¡®è®¤æ–¹å¼ï¼Œå®ƒæ˜¯ä¸€ç§åŒæ­¥ç¡®è®¤å‘å¸ƒçš„æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ä¹‹ååªæœ‰å®ƒ è¢«ç¡®è®¤å‘å¸ƒï¼Œåç»­çš„æ¶ˆæ¯æ‰èƒ½ç»§ç»­å‘å¸ƒ,waitForConfirmsOrDie(long)è¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨æ¶ˆæ¯è¢«ç¡®è®¤ çš„æ—¶å€™æ‰è¿”å›ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´èŒƒå›´å†…è¿™ä¸ªæ¶ˆæ¯æ²¡æœ‰è¢«ç¡®è®¤é‚£ä¹ˆå®ƒå°†æŠ›å‡ºå¼‚å¸¸ã€‚è¿™ç§ç¡®è®¤æ–¹å¼æœ‰ä¸€ä¸ªæœ€å¤§çš„ç¼ºç‚¹å°±æ˜¯:å‘å¸ƒé€Ÿåº¦ç‰¹åˆ«çš„æ…¢ï¼Œå› ä¸ºå¦‚æœæ²¡æœ‰ç¡®è®¤å‘å¸ƒçš„æ¶ˆæ¯å°±ä¼š é˜»å¡æ‰€æœ‰åç»­æ¶ˆæ¯çš„å‘å¸ƒï¼Œè¿™ç§æ–¹å¼æœ€å¤šæä¾›æ¯ç§’ä¸è¶…è¿‡æ•°ç™¾æ¡å‘å¸ƒæ¶ˆæ¯çš„ååé‡ã€‚å½“ç„¶å¯¹äºæŸ äº›åº”ç”¨ç¨‹åºæ¥è¯´è¿™å¯èƒ½å·²ç»è¶³å¤Ÿäº†ã€‚ 123456789101112131415161718192021// å‘å¸ƒå•æ¡æ¶ˆæ¯1000æ¡è€—æ—¶æµ‹è¯•ï¼š 722mspublic static void publishMessageOne() throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; String queueName = UUID.randomUUID().toString(); channel.queueDeclare(queueName, false, false, false, null); // å¼€å¯å‘å¸ƒç¡®è®¤ channel.confirmSelect(); long begin = System.currentTimeMillis(); for (int i = 0; i &lt; MESSAGE_COUNT; i++) &#123; String message = i + &quot;&quot;; channel.basicPublish(&quot;&quot;, queueName, null, message.getBytes()); // å‘é€ä¹‹åé©¬ä¸Šè¿›è¡Œå‘å¸ƒç¡®è®¤ï¼ŒæœåŠ¡ç«¯è¿”å› false æˆ–è¶…æ—¶æ—¶é—´å†…æœªè¿”å›ï¼Œç”Ÿäº§è€…å¯ä»¥æ¶ˆæ¯é‡å‘ boolean flag = channel.waitForConfirms(); if (flag) &#123; System.out.println(&quot; æ¶ˆæ¯å‘é€æˆåŠŸ&quot;); &#125; &#125; long end = System.currentTimeMillis(); System.out.println(&quot; å‘å¸ƒ&quot; + MESSAGE_COUNT + &quot; ä¸ªå•ç‹¬ç¡®è®¤æ¶ˆæ¯, è€—æ—¶&quot; + (end - begin) + &quot;ms&quot;); &#125;&#125; ç¬¬äºŒç§ï¼šæ‰¹é‡ç¡®è®¤å‘å¸ƒä¸Šé¢é‚£ç§æ–¹å¼éå¸¸æ…¢ï¼Œä¸å•ä¸ªç­‰å¾…ç¡®è®¤æ¶ˆæ¯ç›¸æ¯”ï¼Œå…ˆå‘å¸ƒä¸€æ‰¹æ¶ˆæ¯ç„¶åä¸€èµ·ç¡®è®¤å¯ä»¥æå¤§åœ° æé«˜ååé‡ï¼Œå½“ç„¶è¿™ç§æ–¹å¼çš„ç¼ºç‚¹å°±æ˜¯:å½“å‘ç”Ÿæ•…éšœå¯¼è‡´å‘å¸ƒå‡ºç°é—®é¢˜æ—¶ï¼Œä¸çŸ¥é“æ˜¯å“ªä¸ªæ¶ˆæ¯å‡ºç° é—®é¢˜äº†ï¼Œæˆ‘ä»¬å¿…é¡»å°†æ•´ä¸ªæ‰¹å¤„ç†ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œä»¥è®°å½•é‡è¦çš„ä¿¡æ¯è€Œåé‡æ–°å‘å¸ƒæ¶ˆæ¯ã€‚å½“ç„¶è¿™ç§ æ–¹æ¡ˆä»ç„¶æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿä¸€æ ·é˜»å¡æ¶ˆæ¯çš„å‘å¸ƒã€‚ 123456789101112131415161718192021222324252627282930// æ‰¹é‡å‘å¸ƒç¡®è®¤ å‘å¸ƒ1000ä¸ªæ¶ˆæ¯ï¼Œè€—æ—¶141mspublic static void publishMessageBatch() throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; String queueName = UUID.randomUUID().toString(); channel.queueDeclare(queueName, false, false, false, null); // å¼€å¯å‘å¸ƒç¡®è®¤ channel.confirmSelect(); // æ‰¹é‡ç¡®è®¤æ¶ˆæ¯å¤§å° int batchSize = 100; // æœªç¡®è®¤æ¶ˆæ¯ä¸ªæ•° int outstandingMessageCount = 0; long begin = System.currentTimeMillis(); for (int i = 0; i &lt; MESSAGE_COUNT; i++) &#123; String message = i + &quot;&quot;; channel.basicPublish(&quot;&quot;, queueName, null, message.getBytes()); outstandingMessageCount++; // 100æ¡ç¡®è®¤ä¸€æ¬¡ if (outstandingMessageCount == batchSize) &#123; channel.waitForConfirms(); outstandingMessageCount = 0; &#125; &#125; // ä¸ºäº†ç¡®ä¿è¿˜æœ‰å‰©ä½™æ²¡æœ‰ç¡®è®¤æ¶ˆæ¯ å†æ¬¡ç¡®è®¤ if (outstandingMessageCount &gt; 0) &#123; channel.waitForConfirms(); &#125; long end = System.currentTimeMillis(); System.out.println(&quot; å‘å¸ƒ&quot; + MESSAGE_COUNT + &quot; ä¸ªæ‰¹é‡ç¡®è®¤æ¶ˆæ¯, è€—æ—¶&quot; + (end - begin) + &quot;ms&quot;); &#125;&#125; ç¬¬ä¸‰ç§ï¼šå¼‚æ­¥ç¡®è®¤å‘å¸ƒå¼‚æ­¥ç¡®è®¤è™½ç„¶ç¼–ç¨‹é€»è¾‘æ¯”ä¸Šä¸¤ä¸ªè¦å¤æ‚ï¼Œä½†æ˜¯æ€§ä»·æ¯”æœ€é«˜ï¼Œæ— è®ºæ˜¯å¯é æ€§è¿˜æ˜¯æ•ˆç‡éƒ½æ²¡å¾—è¯´ï¼Œ ä»–æ˜¯åˆ©ç”¨å›è°ƒå‡½æ•°æ¥è¾¾åˆ°æ¶ˆæ¯å¯é æ€§ä¼ é€’çš„ï¼Œè¿™ä¸ªä¸­é—´ä»¶ä¹Ÿæ˜¯é€šè¿‡å‡½æ•°å›è°ƒæ¥ä¿è¯æ˜¯å¦æŠ•é€’æˆåŠŸï¼Œ ä¸‹é¢å°±è®©æˆ‘ä»¬æ¥è¯¦ç»†è®²è§£å¼‚æ­¥ç¡®è®¤æ˜¯æ€ä¹ˆå®ç°çš„ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758// å¼‚æ­¥å‘å¸ƒç¡®è®¤ å‘å¸ƒ1000ä¸ªæ¶ˆæ¯ï¼Œè€—æ—¶62mspublic static void publishMessageAsync() throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; String queueName = UUID.randomUUID().toString(); channel.queueDeclare(queueName, false, false, false, null); // å¼€å¯å‘å¸ƒç¡®è®¤ channel.confirmSelect(); /** * çº¿ç¨‹å®‰å…¨æœ‰åºçš„ä¸€ä¸ªå“ˆå¸Œè¡¨ï¼Œé€‚ç”¨äºé«˜å¹¶å‘çš„æƒ…å†µ * 1. è½»æ¾çš„å°†åºå·ä¸æ¶ˆæ¯è¿›è¡Œå…³è” * 2. è½»æ¾æ‰¹é‡åˆ é™¤æ¡ç›® åªè¦ç»™åˆ°åºåˆ—å· * 3. æ”¯æŒå¹¶å‘è®¿é—® */ ConcurrentSkipListMap&lt;Long, String&gt; outstandingConfirms = new ConcurrentSkipListMap&lt;&gt;(); /** * ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯çš„ä¸€ä¸ªå›è°ƒ * 1. æ¶ˆæ¯åºåˆ—å· * 2.true å¯ä»¥ç¡®è®¤å°äºç­‰äºå½“å‰åºåˆ—å·çš„æ¶ˆæ¯ * false ç¡®è®¤å½“å‰åºåˆ—å·æ¶ˆæ¯ */ ConfirmCallback ackCallback = (sequenceNumber, multiple) -&gt; &#123; if (multiple) &#123; // è¿”å›çš„æ˜¯å°äºç­‰äºå½“å‰åºåˆ—å·çš„æœªç¡®è®¤æ¶ˆæ¯ æ˜¯ä¸€ä¸ª map ConcurrentNavigableMap&lt;Long, String&gt; confirmed = outstandingConfirms.headMap(sequenceNumber, true); // æ¸…é™¤è¯¥éƒ¨åˆ†æœªç¡®è®¤æ¶ˆæ¯ confirmed.clear(); &#125;else&#123; // åªæ¸…é™¤å½“å‰åºåˆ—å·çš„æ¶ˆæ¯ outstandingConfirms.remove(sequenceNumber); &#125; &#125;; ConfirmCallback nackCallback = (sequenceNumber, multiple) -&gt; &#123; String message = outstandingConfirms.get(sequenceNumber); System.out.println(&quot; å‘å¸ƒçš„æ¶ˆæ¯&quot;+message+&quot; æœªè¢«ç¡®è®¤ï¼Œåºåˆ—å·&quot;+sequenceNumber); &#125;; /** * æ·»åŠ ä¸€ä¸ªå¼‚æ­¥ç¡®è®¤çš„ç›‘å¬å™¨ * 1. ç¡®è®¤æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒ * 2. æœªæ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒ */ channel.addConfirmListener(ackCallback, null); long begin = System.currentTimeMillis(); for (int i = 0; i &lt; MESSAGE_COUNT; i++) &#123; String message = &quot; æ¶ˆæ¯&quot; + i; /** * channel.getNextPublishSeqNo() è·å–ä¸‹ä¸€ä¸ªæ¶ˆæ¯çš„åºåˆ—å· * é€šè¿‡åºåˆ—å·ä¸æ¶ˆæ¯ä½“è¿›è¡Œä¸€ä¸ªå…³è” * å…¨éƒ¨éƒ½æ˜¯æœªç¡®è®¤çš„æ¶ˆæ¯ä½“ */ outstandingConfirms.put(channel.getNextPublishSeqNo(), message); channel.basicPublish(&quot;&quot;, queueName, null, message.getBytes()); &#125; long end = System.currentTimeMillis(); System.out.println(&quot; å‘å¸ƒ&quot; + MESSAGE_COUNT + &quot; ä¸ªå¼‚æ­¥ç¡®è®¤æ¶ˆæ¯, è€—æ—¶&quot; + (end - begin) + &quot;ms&quot;); &#125;&#125; å¦‚ä½•å¤„ç†å¼‚æ­¥æœªç¡®è®¤æ¶ˆæ¯å¥½çš„è§£å†³çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯æŠŠæœªç¡®è®¤çš„æ¶ˆæ¯æ”¾åˆ°ä¸€ä¸ªåŸºäºå†…å­˜çš„èƒ½è¢«å‘å¸ƒçº¿ç¨‹è®¿é—®çš„é˜Ÿåˆ—ï¼Œ æ¯”å¦‚è¯´ç”¨ ConcurrentLinkedQueue è¿™ä¸ªé˜Ÿåˆ—åœ¨ confirm callbacks ä¸å‘å¸ƒçº¿ç¨‹ä¹‹é—´è¿›è¡Œæ¶ˆæ¯çš„ä¼  é€’ã€‚ 3ç§å‘å¸ƒç¡®è®¤é€Ÿåº¦å¯¹æ¯” å•ç‹¬å‘å¸ƒæ¶ˆæ¯ï¼šåŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œä½†ååé‡éå¸¸æœ‰é™ã€‚ æ‰¹é‡å‘å¸ƒæ¶ˆæ¯ï¼šæ‰¹é‡åŒæ­¥ç­‰å¾…ç¡®è®¤ï¼Œç®€å•ï¼Œåˆç†çš„ååé‡ï¼Œä¸€æ—¦å‡ºç°é—®é¢˜ä½†å¾ˆéš¾æ¨æ–­å‡ºæ˜¯é‚£æ¡æ¶ˆæ¯å‡ºç°äº†é—®é¢˜ã€‚ å¼‚æ­¥å¤„ç†ï¼šæœ€ä½³æ€§èƒ½å’Œèµ„æºä½¿ç”¨ï¼Œåœ¨å‡ºç°é”™è¯¯çš„æƒ…å†µä¸‹å¯ä»¥å¾ˆå¥½åœ°æ§åˆ¶ï¼Œä½†æ˜¯å®ç°èµ·æ¥ç¨å¾®éš¾äº›ã€‚ äº¤æ¢æœºåœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå·¥ä½œé˜Ÿåˆ—ã€‚æˆ‘ä»¬å‡è®¾çš„æ˜¯å·¥ä½œé˜Ÿåˆ—èƒŒåï¼Œæ¯ä¸ªä»»åŠ¡éƒ½æ°å¥½äº¤ä»˜ç»™ä¸€ä¸ªæ¶ˆ è´¹è€…(å·¥ä½œè¿›ç¨‹)ã€‚åœ¨è¿™ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†åšä¸€äº›å®Œå…¨ä¸åŒçš„äº‹æƒ…-æˆ‘ä»¬å°†æ¶ˆæ¯ä¼ è¾¾ç»™å¤šä¸ªæ¶ˆè´¹è€…ã€‚è¿™ç§æ¨¡å¼ ç§°ä¸º â€å‘å¸ƒ/è®¢é˜…â€ï¼Œä¸ºäº†è¯´æ˜è¿™ç§æ¨¡å¼ï¼Œæˆ‘ä»¬å°†æ„å»ºä¸€ä¸ªç®€å•çš„æ—¥å¿—ç³»ç»Ÿã€‚å®ƒå°†ç”±ä¸¤ä¸ªç¨‹åºç»„æˆ:ç¬¬ä¸€ä¸ªç¨‹åºå°†å‘å‡ºæ—¥å¿—æ¶ˆ æ¯ï¼Œç¬¬äºŒä¸ªç¨‹åºæ˜¯æ¶ˆè´¹è€…ã€‚å…¶ä¸­æˆ‘ä»¬ä¼šå¯åŠ¨ä¸¤ä¸ªæ¶ˆè´¹è€…ï¼Œå…¶ä¸­ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åæŠŠæ—¥å¿—å­˜å‚¨åœ¨ç£ç›˜ï¼Œå¦å¤–ä¸€ä¸ªæ¶ˆè´¹è€…æ¥æ”¶åˆ°æ¶ˆæ¯åæŠŠæ¶ˆæ¯æ‰“å°åœ¨å±å¹•ä¸Šï¼Œäº‹å®ä¸Šç¬¬ä¸€ä¸ªç¨‹åºå‘å‡ºçš„æ—¥å¿—æ¶ˆæ¯å°†å¹¿æ’­ç»™æ‰€æœ‰æ¶ˆè´¹è€…ã€‚ Exchangesæ¦‚å¿µRabbitMQ æ¶ˆæ¯ä¼ é€’æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯: ç”Ÿäº§è€…ç”Ÿäº§çš„æ¶ˆæ¯ä»ä¸ä¼šç›´æ¥å‘é€åˆ°é˜Ÿåˆ—ã€‚å®é™…ä¸Šï¼Œé€šå¸¸ç”Ÿäº§è€…ç”šè‡³éƒ½ä¸çŸ¥é“è¿™äº›æ¶ˆæ¯ä¼ é€’ä¼ é€’åˆ°äº†å“ªäº›é˜Ÿåˆ—ä¸­ã€‚ç›¸åï¼Œ**ç”Ÿäº§è€…åªèƒ½å°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœº(exchange)**ï¼Œäº¤æ¢æœºå·¥ä½œçš„å†…å®¹éå¸¸ç®€å•ï¼Œä¸€æ–¹é¢å®ƒæ¥æ”¶æ¥ è‡ªç”Ÿäº§è€…çš„æ¶ˆæ¯ï¼Œå¦ä¸€æ–¹é¢å°†å®ƒä»¬æ¨å…¥é˜Ÿåˆ—ã€‚äº¤æ¢æœºå¿…é¡»ç¡®åˆ‡çŸ¥é“å¦‚ä½•å¤„ç†æ”¶åˆ°çš„æ¶ˆæ¯ã€‚æ˜¯åº”è¯¥æŠŠè¿™äº›æ¶ˆ æ¯æ”¾åˆ°ç‰¹å®šé˜Ÿåˆ—è¿˜æ˜¯è¯´æŠŠä»–ä»¬åˆ°è®¸å¤šé˜Ÿåˆ—ä¸­è¿˜æ˜¯è¯´åº”è¯¥ä¸¢å¼ƒå®ƒä»¬ã€‚è¿™å°±çš„ç”±äº¤æ¢æœºçš„ç±»å‹æ¥å†³å®šã€‚ Exchanges çš„ç±»å‹ ç›´æ¥(direct) â€” è·¯ç”±ç±»å‹ ä¸»é¢˜(topic) â€” é€šé…ç¬¦åŒ¹é…æ¨¡å¼ æ ‡é¢˜(headers) â€” å·²ç»ä¸ç”¨äº† æ‰‡å‡º(fanout) â€” å‘å¸ƒè®¢é˜…ç±»å‹ æ— å exchangeç¬¬ä¸€ä¸ªå‚æ•°æ˜¯äº¤æ¢æœºçš„åç§°ã€‚ç©ºå­—ç¬¦ä¸²è¡¨ç¤ºé»˜è®¤æˆ–æ— åç§°äº¤æ¢æœºï¼šæ¶ˆæ¯èƒ½è·¯ç”±å‘é€åˆ°é˜Ÿåˆ—ä¸­å…¶å®æ˜¯ç”± routingKey(bindingkey)ç»‘å®š key æŒ‡å®šçš„ã€‚ ä¸´æ—¶é˜Ÿåˆ—æ¯å½“æˆ‘ä»¬è¿æ¥åˆ° Rabbit æ—¶ï¼Œæˆ‘ä»¬éƒ½éœ€è¦ä¸€ä¸ªå…¨æ–°çš„ç©ºé˜Ÿåˆ—ï¼Œä¸ºæ­¤æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªå…·æœ‰éšæœºåç§°çš„é˜Ÿåˆ—ï¼Œæˆ–è€…èƒ½è®©æœåŠ¡å™¨ä¸ºæˆ‘ä»¬é€‰æ‹©ä¸€ä¸ªéšæœºé˜Ÿåˆ—åç§°é‚£å°±æ›´å¥½äº†ã€‚å…¶æ¬¡ä¸€æ—¦æˆ‘ä»¬æ–­å¼€äº†æ¶ˆè´¹è€…çš„è¿æ¥ï¼Œé˜Ÿåˆ—å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚åˆ›å»ºä¸´æ—¶é˜Ÿåˆ—çš„æ–¹å¼å¦‚ä¸‹:String queueName = channel.queueDeclare().getQueue(); ç»‘å®š(bindings)ä»€ä¹ˆæ˜¯ bingding å‘¢ï¼Œbinding å…¶å®æ˜¯ exchange å’Œ queue ä¹‹é—´çš„æ¡¥æ¢ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬ exchange å’Œé‚£ä¸ªé˜Ÿ åˆ—è¿›è¡Œäº†ç»‘å®šå…³ç³»ã€‚æ¯”å¦‚è¯´ä¸‹é¢è¿™å¼ å›¾å‘Šè¯‰æˆ‘ä»¬çš„å°±æ˜¯ X ä¸ Q1 å’Œ Q2 è¿›è¡Œäº†ç»‘å®š Fanout(å‘å¸ƒè®¢é˜…äº¤æ¢æœº)Fanout è¿™ç§ç±»å‹éå¸¸ç®€å•ã€‚æ­£å¦‚ä»åç§°ä¸­çŒœåˆ°çš„é‚£æ ·ï¼Œå®ƒæ˜¯å°†æ¥æ”¶åˆ°çš„æ‰€æœ‰æ¶ˆæ¯å¹¿æ’­åˆ°å®ƒçŸ¥é“çš„ æ‰€æœ‰é˜Ÿåˆ—ä¸­ã€‚ç³»ç»Ÿä¸­é»˜è®¤æœ‰äº› exchange ç±»å‹ Fanout å®æˆ˜ Logs å’Œä¸´æ—¶é˜Ÿåˆ—çš„ç»‘å®šå…³ç³»å¦‚ä¸‹å›¾ å‘å¸ƒè®¢é˜…å‘å¸ƒè€…1234567891011121314151617181920public class EmitLog &#123; private static final String EXCHANGE_NAME = &quot;logs&quot;; public static void main(String[] argv) throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; /** * å£°æ˜ä¸€ä¸ª exchange * 1.exchange çš„åç§° * 2.exchange çš„ç±»å‹ */ channel.exchangeDeclare(EXCHANGE_NAME, &quot;fanout&quot;); Scanner sc = new Scanner(System.in); System.out.println(&quot; è¯·è¾“å…¥ä¿¡æ¯&quot;); while (sc.hasNext()) &#123; String message = sc.nextLine(); channel.basicPublish(EXCHANGE_NAME, &quot;&quot;, null, message.getBytes(&quot;UTF-8&quot;)); System.out.println(&quot; ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯&quot; + message); &#125; &#125; &#125;&#125; å‘å¸ƒè®¢é˜…æ¥æ”¶è€…112345678910111213141516171819202122public class ReceiveLogs01 &#123; private static final String EXCHANGE_NAME = &quot;logs&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); channel.exchangeDeclare(EXCHANGE_NAME, &quot;fanout&quot;); /** * ç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„é˜Ÿåˆ— é˜Ÿåˆ—çš„åç§°æ˜¯éšæœºçš„ * å½“æ¶ˆè´¹è€…æ–­å¼€å’Œè¯¥é˜Ÿåˆ—çš„è¿æ¥æ—¶ é˜Ÿåˆ—è‡ªåŠ¨åˆ é™¤ */ String queueName = channel.queueDeclare().getQueue(); // æŠŠè¯¥ä¸´æ—¶é˜Ÿåˆ—ç»‘å®šæˆ‘ä»¬çš„ exchange å…¶ä¸­ routingkey( ä¹Ÿç§°ä¹‹ä¸º binding key) ä¸ºç©ºå­—ç¬¦ä¸² channel.queueBind(queueName, EXCHANGE_NAME, &quot;&quot;); System.out.println(&quot;01ç­‰å¾…æ¥æ”¶æ¶ˆæ¯, æŠŠæ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨å±å¹•.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), StandardCharsets.UTF_8); System.out.println(&quot;01æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯&quot; + message); &#125;; channel.basicConsume(queueName, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; å‘å¸ƒè®¢é˜…æ¥æ”¶è€…212345678910111213141516171819202122public class ReceiveLogs02 &#123; private static final String EXCHANGE_NAME = &quot;logs&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); channel.exchangeDeclare(EXCHANGE_NAME, &quot;fanout&quot;); /** * ç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„é˜Ÿåˆ— é˜Ÿåˆ—çš„åç§°æ˜¯éšæœºçš„ * å½“æ¶ˆè´¹è€…æ–­å¼€å’Œè¯¥é˜Ÿåˆ—çš„è¿æ¥æ—¶ é˜Ÿåˆ—è‡ªåŠ¨åˆ é™¤ */ String queueName = channel.queueDeclare().getQueue(); // æŠŠè¯¥ä¸´æ—¶é˜Ÿåˆ—ç»‘å®šæˆ‘ä»¬çš„ exchange å…¶ä¸­ routingkey( ä¹Ÿç§°ä¹‹ä¸º binding key) ä¸ºç©ºå­—ç¬¦ä¸² channel.queueBind(queueName, EXCHANGE_NAME, &quot;&quot;); System.out.println(&quot;02ç­‰å¾…æ¥æ”¶æ¶ˆæ¯, æŠŠæ¥æ”¶åˆ°çš„æ¶ˆæ¯æ‰“å°åœ¨å±å¹•.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), StandardCharsets.UTF_8); System.out.println(&quot;02æ§åˆ¶å°æ‰“å°æ¥æ”¶åˆ°çš„æ¶ˆæ¯&quot; + message); &#125;; channel.basicConsume(queueName, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; Direct exchange(ç›´æ¥äº¤æ¢æœº)ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ„å»ºäº†ä¸€ä¸ªç®€å•çš„æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬èƒ½å¤Ÿå‘è®¸å¤šæ¥æ”¶è€…å¹¿æ’­æ—¥å¿—æ¶ˆæ¯ã€‚åœ¨æœ¬èŠ‚æˆ‘ä»¬å°†å‘å…¶ä¸­æ·»åŠ ä¸€äº›ç‰¹åˆ«çš„åŠŸèƒ½-æ¯”æ–¹è¯´æˆ‘ä»¬åªè®©æŸä¸ªæ¶ˆè´¹è€…è®¢é˜…å‘å¸ƒçš„éƒ¨åˆ†æ¶ˆæ¯ã€‚ä¾‹å¦‚æˆ‘ä»¬åªæŠŠä¸¥é‡é”™è¯¯æ¶ˆæ¯å®šå‘å­˜å‚¨åˆ°æ—¥å¿—æ–‡ä»¶(ä»¥èŠ‚çœç£ç›˜ç©ºé—´)ï¼ŒåŒæ—¶ä»ç„¶èƒ½å¤Ÿåœ¨æ§åˆ¶å°ä¸Šæ‰“å°æ‰€æœ‰æ—¥å¿—æ¶ˆæ¯ã€‚æˆ‘ä»¬å†æ¬¡æ¥å›é¡¾ä¸€ä¸‹ä»€ä¹ˆæ˜¯ bindingsï¼Œç»‘å®šæ˜¯äº¤æ¢æœºå’Œé˜Ÿåˆ—ä¹‹é—´çš„æ¡¥æ¢å…³ç³»ã€‚ä¹Ÿå¯ä»¥è¿™ä¹ˆç†è§£ï¼šé˜Ÿåˆ—åªå¯¹å®ƒç»‘å®šçš„äº¤æ¢æœºçš„æ¶ˆæ¯æ„Ÿå…´è¶£ã€‚ç»‘å®šç”¨å‚æ•°ï¼šroutingKey æ¥è¡¨ç¤ºä¹Ÿå¯ç§°è¯¥å‚æ•°ä¸º binding keyï¼Œåˆ›å»ºç»‘å®šæˆ‘ä»¬ç”¨ä»£ç :channel.queueBind(queueName, EXCHANGE_NAME, &quot;routingKey&quot;);ç»‘å®šä¹‹åçš„æ„ä¹‰ç”±å…¶äº¤æ¢ç±»å‹å†³å®šã€‚ ç›´æ¥äº¤æ¢æœºå‘å¸ƒè€…12345678910111213141516171819202122public class EmitLogDirect &#123; private static final String EXCHANGE_NAME = &quot;direct_logs&quot;; public static void main(String[] argv) throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT); // åˆ›å»ºå¤šä¸ª bindingKey Map&lt;String, String&gt; bindingKeyMap = new HashMap&lt;&gt;(); bindingKeyMap.put(&quot;info&quot;, &quot; æ™®é€š info ä¿¡æ¯&quot;); bindingKeyMap.put(&quot;warning&quot;, &quot; è­¦å‘Š warning ä¿¡æ¯&quot;); bindingKeyMap.put(&quot;error&quot;, &quot; é”™è¯¯ error ä¿¡æ¯&quot;); //debug æ²¡æœ‰æ¶ˆè´¹è¿™æ¥æ”¶è¿™ä¸ªæ¶ˆæ¯ æ‰€æœ‰å°±ä¸¢å¤±äº† bindingKeyMap.put(&quot;debug&quot;, &quot; è°ƒè¯• debug ä¿¡æ¯&quot;); for (Map.Entry&lt;String, String&gt; bindingKeyEntry : bindingKeyMap.entrySet()) &#123; String bindingKey = bindingKeyEntry.getKey(); String message = bindingKeyEntry.getValue(); channel.basicPublish(EXCHANGE_NAME, bindingKey, null, message.getBytes(StandardCharsets.UTF_8)); System.out.println(&quot; ç”Ÿäº§è€…å‘å‡ºæ¶ˆæ¯:&quot; + message); &#125; &#125; &#125;&#125; ç›´æ¥äº¤æ¢æœºæ¶ˆè´¹è€…11234567891011121314151617181920public class ReceiveLogsDirect01 &#123; private static final String EXCHANGE_NAME = &quot;direct_logs&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT); String queueName = &quot;disk&quot;; channel.queueDeclare(queueName, false, false, false, null); channel.queueBind(queueName, EXCHANGE_NAME, &quot;error&quot;); System.out.println(&quot; ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), &quot;UTF-8&quot;); message = &quot; æ¥æ”¶ç»‘å®šé”®:&quot; + delivery.getEnvelope().getRoutingKey() + &quot;, æ¶ˆæ¯:&quot; + message; // å†™ç£ç›˜å¿½ç•¥ System.out.println(&quot; é”™è¯¯æ—¥å¿—å·²ç»æ¥æ”¶&quot; + message); &#125;; channel.basicConsume(queueName, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; ç›´æ¥äº¤æ¢æœºæ¶ˆè´¹è€…212345678910111213141516171819public class ReceiveLogsDirect02 &#123; private static final String EXCHANGE_NAME = &quot;direct_logs&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); channel.exchangeDeclare(EXCHANGE_NAME, BuiltinExchangeType.DIRECT); String queueName = &quot;console&quot;; channel.queueDeclare(queueName, false, false, false, null); channel.queueBind(queueName, EXCHANGE_NAME, &quot;info&quot;); channel.queueBind(queueName, EXCHANGE_NAME, &quot;warning&quot;); System.out.println(&quot; ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), &quot;UTF-8&quot;); System.out.println(&quot; æ¥ æ”¶ ç»‘ å®š é”® :&quot; + delivery.getEnvelope().getRoutingKey() + &quot;, æ¶ˆæ¯:&quot; + message); &#125;; channel.basicConsume(queueName, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; Topics(ä¸»é¢˜äº¤æ¢æœº)åœ¨ä¸Šä¸€ä¸ªå°èŠ‚ä¸­ï¼Œæˆ‘ä»¬æ”¹è¿›äº†æ—¥å¿—è®°å½•ç³»ç»Ÿã€‚æˆ‘ä»¬æ²¡æœ‰ä½¿ç”¨åªèƒ½è¿›è¡Œéšæ„å¹¿æ’­çš„ fanout äº¤æ¢æœºï¼Œè€Œæ˜¯ä½¿ç”¨äº† direct äº¤æ¢æœºï¼Œä»è€Œæœ‰èƒ½å®ç°æœ‰é€‰æ‹©æ€§åœ°æ¥æ”¶æ—¥å¿—ã€‚å°½ç®¡ä½¿ç”¨ direct äº¤æ¢æœºæ”¹è¿›äº†æˆ‘ä»¬çš„ç³»ç»Ÿï¼Œä½†æ˜¯å®ƒä»ç„¶å­˜åœ¨å±€é™æ€§-æ¯”æ–¹è¯´æˆ‘ä»¬æƒ³æ¥æ”¶çš„æ—¥å¿—ç±»å‹æœ‰info.base å’Œ info.advantageï¼ŒæŸä¸ªé˜Ÿåˆ—åªæƒ³ info.base çš„æ¶ˆæ¯ï¼Œé‚£è¿™ä¸ªæ—¶å€™ direct å°±åŠä¸åˆ°äº†ã€‚è¿™ä¸ªæ—¶å€™å°±åªèƒ½ä½¿ç”¨ topic ç±»å‹ã€‚ Topic è¦æ±‚å‘é€åˆ°ç±»å‹æ˜¯ topic äº¤æ¢æœºçš„æ¶ˆæ¯çš„ routing_key ä¸èƒ½éšæ„å†™ï¼Œå¿…é¡»æ»¡è¶³ä¸€å®šçš„è¦æ±‚ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå•è¯åˆ—è¡¨ï¼Œä»¥ç‚¹å·åˆ†éš”å¼€ã€‚è¿™äº›å•è¯å¯ä»¥æ˜¯ä»»æ„å•è¯ï¼Œæ¯”å¦‚è¯´ï¼šâ€stock.usd.nyseâ€, â€œnyse.vmwâ€,â€quick.orange.rabbitâ€.è¿™ç§ç±»å‹çš„ã€‚å½“ç„¶è¿™ä¸ªå•è¯åˆ—è¡¨æœ€å¤šä¸èƒ½è¶…è¿‡ 255 ä¸ªå­—èŠ‚ã€‚åœ¨è¿™ä¸ªè§„åˆ™åˆ—è¡¨ä¸­ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ›¿æ¢ç¬¦æ˜¯å¤§å®¶éœ€è¦æ³¨æ„çš„ *(æ˜Ÿå·)å¯ä»¥ä»£æ›¿ä¸€ä¸ªå•è¯ #(äº•å·)å¯ä»¥æ›¿ä»£é›¶ä¸ªæˆ–å¤šä¸ªå•è¯ Topic åŒ¹é…æ¡ˆä¾‹ä¸‹å›¾ç»‘å®šå…³ç³»å¦‚ä¸‹ï¼š Q1â€“&gt;ç»‘å®šçš„æ˜¯ï¼šä¸­é—´å¸¦ orange å¸¦ 3 ä¸ªå•è¯çš„å­—ç¬¦ä¸²(.orange.) Q2â€“&gt;ç»‘å®šçš„æ˜¯ï¼šæœ€åä¸€ä¸ªå•è¯æ˜¯ rabbit çš„ 3 ä¸ªå•è¯(..rabbit) ç¬¬ä¸€ä¸ªå•è¯æ˜¯ lazy çš„å¤šä¸ªå•è¯(lazy.#) ä¸Šå›¾æ˜¯ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šå…³ç³»å›¾ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹ä»–ä»¬ä¹‹é—´æ•°æ®æ¥æ”¶æƒ…å†µæ˜¯æ€ä¹ˆæ ·çš„quick.orange.rabbit â€”â€”â€”â€” è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°lazy.orange.elephant â€”â€”â€”â€” è¢«é˜Ÿåˆ— Q1Q2 æ¥æ”¶åˆ°quick.orange.fox â€”â€”â€”â€” è¢«é˜Ÿåˆ— Q1 æ¥æ”¶åˆ°lazy.brown.fox â€”â€”â€”â€” è¢«é˜Ÿåˆ— Q2 æ¥æ”¶åˆ°lazy.pink.rabbit â€”â€”â€”â€” è™½ç„¶æ»¡è¶³ä¸¤ä¸ªç»‘å®šä½†åªè¢«é˜Ÿåˆ— Q2 æ¥æ”¶ä¸€æ¬¡quick.brown.fox â€”â€”â€”â€” ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¸ä¼šè¢«ä»»ä½•é˜Ÿåˆ—æ¥æ”¶åˆ°ä¼šè¢«ä¸¢å¼ƒquick.orange.male.rabbit â€”â€”â€”â€” æ˜¯å››ä¸ªå•è¯ä¸åŒ¹é…ä»»ä½•ç»‘å®šä¼šè¢«ä¸¢å¼ƒlazy.orange.male.rabbit â€”â€”â€”â€” æ˜¯å››ä¸ªå•è¯ä½†åŒ¹é… Q2 å½“é˜Ÿåˆ—ç»‘å®šå…³ç³»æ˜¯ä¸‹åˆ—è¿™ç§æƒ…å†µæ—¶éœ€è¦å¼•èµ·æ³¨æ„ å½“ä¸€ä¸ªé˜Ÿåˆ—ç»‘å®šé”®æ˜¯#,é‚£ä¹ˆè¿™ä¸ªé˜Ÿåˆ—å°†æ¥æ”¶æ‰€æœ‰æ•°æ®ï¼Œå°±æœ‰ç‚¹åƒ fanout äº†ï¼Œå¦‚æœé˜Ÿåˆ—ç»‘å®šé”®å½“ä¸­æ²¡æœ‰#å’Œ*å‡ºç°ï¼Œé‚£ä¹ˆè¯¥é˜Ÿåˆ—ç»‘å®šç±»å‹å°±æ˜¯ direct äº†ã€‚ æ­»ä¿¡é˜Ÿåˆ—æ­»ä¿¡çš„æ¦‚å¿µå…ˆä»æ¦‚å¿µè§£é‡Šä¸Šææ¸…æ¥šè¿™ä¸ªå®šä¹‰ï¼Œæ­»ä¿¡ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯æ— æ³•è¢«æ¶ˆè´¹çš„æ¶ˆæ¯ï¼Œå­—é¢æ„æ€å¯ä»¥è¿™æ ·ç† è§£ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œproducer å°†æ¶ˆæ¯æŠ•é€’åˆ° broker æˆ–è€…ç›´æ¥åˆ° queue é‡Œäº†ï¼Œconsumer ä» queue å–å‡ºæ¶ˆæ¯ è¿›è¡Œæ¶ˆè´¹ï¼Œä½†æŸäº›æ—¶å€™ç”±äºç‰¹å®šçš„åŸå› å¯¼è‡´ queue ä¸­çš„æŸäº›æ¶ˆæ¯æ— æ³•è¢«æ¶ˆè´¹ï¼Œè¿™æ ·çš„æ¶ˆæ¯å¦‚æœæ²¡æœ‰ åç»­çš„å¤„ç†ï¼Œå°±å˜æˆäº†æ­»ä¿¡ï¼Œæœ‰æ­»ä¿¡è‡ªç„¶å°±æœ‰äº†æ­»ä¿¡é˜Ÿåˆ—ã€‚ åº”ç”¨åœºæ™¯:ä¸ºäº†ä¿è¯è®¢å•ä¸šåŠ¡çš„æ¶ˆæ¯æ•°æ®ä¸ä¸¢å¤±ï¼Œéœ€è¦ä½¿ç”¨åˆ° RabbitMQ çš„æ­»ä¿¡é˜Ÿåˆ—æœºåˆ¶ï¼Œå½“æ¶ˆæ¯ æ¶ˆè´¹å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå°†æ¶ˆæ¯æŠ•å…¥æ­»ä¿¡é˜Ÿåˆ—ä¸­.è¿˜æœ‰æ¯”å¦‚è¯´: ç”¨æˆ·åœ¨å•†åŸä¸‹å•æˆåŠŸå¹¶ç‚¹å‡»å»æ”¯ä»˜ååœ¨æŒ‡å®šæ—¶ é—´æœªæ”¯ä»˜æ—¶è‡ªåŠ¨å¤±æ•ˆ æ­»ä¿¡çš„æ¥æº æ¶ˆæ¯ TTL è¿‡æœŸ é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦(é˜Ÿåˆ—æ»¡äº†ï¼Œæ— æ³•å†æ·»åŠ æ•°æ®åˆ° mq ä¸­) æ¶ˆæ¯è¢«æ‹’ç»(basic.reject æˆ– basic.nack)å¹¶ä¸” requeue=false. ä»£ç æ¶æ„å›¾ æ¶ˆæ¯TTLè¿‡æœŸä»£ç æ­»ä¿¡ç”Ÿäº§è€…123456789101112131415161718public class Producer &#123; private static final String NORMAL_EXCHANGE = &quot;normal_exchange&quot;; public static void main(String[] argv) throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT); // è®¾ç½®æ¶ˆæ¯çš„ TTL æ—¶é—´ AMQP.BasicProperties properties = new AMQP.BasicProperties().builder().expiration(&quot;10000&quot;).build(); // è¯¥ä¿¡æ¯æ˜¯ç”¨ä½œæ¼”ç¤ºé˜Ÿåˆ—ä¸ªæ•°é™åˆ¶ for (int i = 1; i &lt; 11; i++) &#123; String message = &quot;info&quot; + i; channel.basicPublish(NORMAL_EXCHANGE, &quot;zhangsan&quot;, properties, message.getBytes()); System.out.println(&quot; ç”Ÿäº§è€…å‘é€æ¶ˆæ¯:&quot; + message); &#125; &#125; &#125;&#125; æ­»ä¿¡æ¶ˆè´¹è€…C1æ¶ˆè´¹è€… C1 ( å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯) 12345678910111213141516171819202122232425262728293031323334public class Consumer01 &#123; // æ™®é€šäº¤æ¢æœºåç§° private static final String NORMAL_EXCHANGE = &quot;normal_exchange&quot;; // æ­»ä¿¡äº¤æ¢æœºåç§° private static final String DEAD_EXCHANGE = &quot;dead_exchange&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); // å£°æ˜æ­»ä¿¡å’Œæ™®é€šäº¤æ¢æœº ç±»å‹ä¸º direct channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT); channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT); // å£°æ˜æ­»ä¿¡é˜Ÿåˆ— String deadQueue = &quot;dead-queue&quot;; channel.queueDeclare(deadQueue, false, false, false, null); // æ­»ä¿¡é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡äº¤æ¢æœºä¸ routingkey channel.queueBind(deadQueue, DEAD_EXCHANGE, &quot;lisi&quot;); // æ­£å¸¸é˜Ÿåˆ—ç»‘å®šæ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯ Map&lt;String, Object&gt; params = new HashMap&lt;&gt;(); // æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœº å‚æ•° key æ˜¯å›ºå®šå€¼ params.put(&quot;x-dead-letter-exchange&quot;, DEAD_EXCHANGE); // æ­£å¸¸é˜Ÿåˆ—è®¾ç½®æ­»ä¿¡ routing-key å‚æ•° key æ˜¯å›ºå®šå€¼ params.put(&quot;x-dead-letter-routing-key&quot;, &quot;lisi&quot;); String normalQueue = &quot;normal-queue&quot;; channel.queueDeclare(normalQueue, false, false, false, params); channel.queueBind(normalQueue, NORMAL_EXCHANGE, &quot;zhangsan&quot;); System.out.println(&quot; ç­‰å¾…æ¥æ”¶æ¶ˆæ¯.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), &quot;UTF-8&quot;); System.out.println(&quot;Consumer01 æ¥æ”¶åˆ°æ¶ˆæ¯&quot; + message); &#125;; channel.basicConsume(normalQueue, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; æ­»ä¿¡é˜Ÿåˆ—æ¶ˆè´¹è€…æ¶ˆè´¹è€… C2 ( ä»¥ä¸Šæ­¥éª¤å®Œæˆå å¯åŠ¨ C2 æ¶ˆè´¹è€…å®ƒæ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯) 123456789101112131415161718public class Consumer02 &#123; private static final String DEAD_EXCHANGE = &quot;dead_exchange&quot;; public static void main(String[] argv) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); channel.exchangeDeclare(DEAD_EXCHANGE, BuiltinExchangeType.DIRECT); String deadQueue = &quot;dead-queue&quot;; channel.queueDeclare(deadQueue, false, false, false, null); channel.queueBind(deadQueue, DEAD_EXCHANGE, &quot;lisi&quot;); System.out.println(&quot; ç­‰å¾…æ¥æ”¶æ­»ä¿¡é˜Ÿåˆ—æ¶ˆæ¯.....&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String message = new String(delivery.getBody(), &quot;UTF-8&quot;); System.out.println(&quot;Consumer02 æ¥æ”¶æ­»ä¿¡é˜Ÿåˆ—çš„æ¶ˆæ¯&quot; + message); &#125;; channel.basicConsume(deadQueue, true, deliverCallback, consumerTag -&gt; &#123; &#125;); &#125;&#125; é˜Ÿåˆ—è¾¾åˆ°æœ€å¤§é•¿åº¦ç”Ÿäº§è€…æ¶ˆæ¯ç”Ÿäº§è€…ä»£ç å»æ‰ TTL å±æ€§ 123456789101112131415public class TooLongProducer &#123; private static final String NORMAL_EXCHANGE = &quot;normal_exchange&quot;; public static void main(String[] argv) throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel()) &#123; channel.exchangeDeclare(NORMAL_EXCHANGE, BuiltinExchangeType.DIRECT); // è¯¥ä¿¡æ¯æ˜¯ç”¨ä½œæ¼”ç¤ºé˜Ÿåˆ—ä¸ªæ•°é™åˆ¶ for (int i = 1; i &lt; 11; i++) &#123; String message = &quot;info&quot; + i; channel.basicPublish(NORMAL_EXCHANGE, &quot;zhangsan&quot;, null, message.getBytes()); System.out.println(&quot; ç”Ÿäº§è€…å‘é€æ¶ˆæ¯:&quot; + message); &#125; &#125; &#125;&#125; æ¶ˆè´¹è€…C1 æ¶ˆè´¹è€…ä¿®æ”¹ä»¥ä¸‹ä»£ç  ( å¯åŠ¨ä¹‹åå…³é—­è¯¥æ¶ˆè´¹è€… æ¨¡æ‹Ÿå…¶æ¥æ”¶ä¸åˆ°æ¶ˆæ¯) æ³¨æ„æ­¤æ—¶éœ€è¦æŠŠåŸå…ˆé˜Ÿåˆ—åˆ é™¤ å› ä¸ºå‚æ•°æ”¹å˜äº† ,C2 æ¶ˆè´¹è€…ä»£ç ä¸å˜( å¯åŠ¨ C2 æ¶ˆè´¹è€…) æ¶ˆæ¯è¢«æ‹’è¿›å…¥æ­»ä¿¡ä»£ç ç•¥ å»¶è¿Ÿé˜Ÿåˆ—å»¶æ—¶é˜Ÿåˆ—,é˜Ÿåˆ—å†…éƒ¨æ˜¯æœ‰åºçš„ï¼Œæœ€é‡è¦çš„ç‰¹æ€§å°±ä½“ç°åœ¨å®ƒçš„å»¶æ—¶å±æ€§ä¸Šï¼Œå»¶æ—¶é˜Ÿåˆ—ä¸­çš„å…ƒç´ æ˜¯å¸Œæœ›åœ¨æŒ‡å®šæ—¶é—´åˆ°äº†ä»¥åæˆ–ä¹‹å‰å–å‡ºå’Œå¤„ç†ï¼Œç®€å•æ¥è¯´ï¼Œå»¶æ—¶é˜Ÿåˆ—å°±æ˜¯ç”¨æ¥å­˜æ”¾éœ€è¦åœ¨æŒ‡å®šæ—¶é—´è¢«å¤„ç†çš„å…ƒç´ çš„é˜Ÿåˆ—ã€‚ å»¶è¿Ÿé˜Ÿåˆ—ä½¿ç”¨åœºæ™¯ è®¢å•åœ¨ååˆ†é’Ÿä¹‹å†…æœªæ”¯ä»˜åˆ™è‡ªåŠ¨å–æ¶ˆ æ–°åˆ›å»ºçš„åº—é“ºï¼Œå¦‚æœåœ¨åå¤©å†…éƒ½æ²¡æœ‰ä¸Šä¼ è¿‡å•†å“ï¼Œåˆ™è‡ªåŠ¨å‘é€æ¶ˆæ¯æé†’ã€‚ ç”¨æˆ·æ³¨å†ŒæˆåŠŸåï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰ç™»é™†åˆ™è¿›è¡ŒçŸ­ä¿¡æé†’ã€‚ ç”¨æˆ·å‘èµ·é€€æ¬¾ï¼Œå¦‚æœä¸‰å¤©å†…æ²¡æœ‰å¾—åˆ°å¤„ç†åˆ™é€šçŸ¥ç›¸å…³è¿è¥äººå‘˜ã€‚ é¢„å®šä¼šè®®åï¼Œéœ€è¦åœ¨é¢„å®šçš„æ—¶é—´ç‚¹å‰ååˆ†é’Ÿé€šçŸ¥å„ä¸ªä¸ä¼šäººå‘˜å‚åŠ ä¼šè®® RabbitMQ ä¸­çš„ TTLTTL æ˜¯ä»€ä¹ˆå‘¢ï¼ŸTTL æ˜¯ RabbitMQ ä¸­ä¸€ä¸ªæ¶ˆæ¯æˆ–è€…é˜Ÿåˆ—çš„å±æ€§ï¼Œè¡¨æ˜ä¸€æ¡æ¶ˆæ¯æˆ–è€…è¯¥é˜Ÿåˆ—ä¸­çš„æ‰€æœ‰æ¶ˆæ¯çš„æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœä¸€æ¡æ¶ˆæ¯è®¾ç½®äº† TTL å±æ€§æˆ–è€…è¿›å…¥äº†è®¾ç½® TTL å±æ€§çš„é˜Ÿåˆ—ï¼Œé‚£ä¹ˆè¿™æ¡æ¶ˆæ¯å¦‚æœåœ¨ TTL è®¾ç½®çš„æ—¶é—´å†…æ²¡æœ‰è¢«æ¶ˆè´¹ï¼Œåˆ™ä¼šæˆä¸ºâ€æ­»ä¿¡â€ã€‚å¦‚æœåŒæ—¶é…ç½®äº†é˜Ÿåˆ—çš„ TTL å’Œæ¶ˆæ¯çš„TTLï¼Œé‚£ä¹ˆè¾ƒå°çš„é‚£ä¸ªå€¼å°†ä¼šè¢«ä½¿ç”¨ï¼Œæœ‰ä¸¤ç§æ–¹å¼è®¾ç½® TTLã€‚ æ¶ˆæ¯è®¾ç½® TTLå¦ä¸€ç§æ–¹å¼ä¾¿æ˜¯é’ˆå¯¹æ¯æ¡æ¶ˆæ¯è®¾ç½® TTL é˜Ÿåˆ—è®¾ç½® TTLç¬¬ä¸€ç§æ˜¯åœ¨åˆ›å»ºé˜Ÿåˆ—çš„æ—¶å€™è®¾ç½®é˜Ÿåˆ—çš„â€œx-message-ttlâ€å±æ€§ ä¸¤è€…çš„åŒºåˆ«å¦‚æœè®¾ç½®äº†é˜Ÿåˆ—çš„ TTL å±æ€§ï¼Œé‚£ä¹ˆä¸€æ—¦æ¶ˆæ¯è¿‡æœŸï¼Œå°±ä¼šè¢«é˜Ÿåˆ—ä¸¢å¼ƒ(å¦‚æœé…ç½®äº†æ­»ä¿¡é˜Ÿåˆ—è¢«ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¸­)ï¼Œè€Œç¬¬äºŒç§æ–¹å¼ï¼Œæ¶ˆæ¯å³ä½¿è¿‡æœŸï¼Œä¹Ÿä¸ä¸€å®šä¼šè¢«é©¬ä¸Šä¸¢å¼ƒï¼Œå› ä¸ºæ¶ˆæ¯æ˜¯å¦è¿‡æœŸæ˜¯åœ¨å³å°†æŠ•é€’åˆ°æ¶ˆè´¹è€…ä¹‹å‰åˆ¤å®šçš„ï¼Œå¦‚æœå½“å‰é˜Ÿåˆ—æœ‰ä¸¥é‡çš„æ¶ˆæ¯ç§¯å‹æƒ…å†µï¼Œåˆ™å·²è¿‡æœŸçš„æ¶ˆæ¯ä¹Ÿè®¸è¿˜èƒ½å­˜æ´»è¾ƒé•¿æ—¶é—´ï¼›å¦å¤–ï¼Œè¿˜éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœä¸è®¾ç½® TTLï¼Œè¡¨ç¤ºæ¶ˆæ¯æ°¸è¿œä¸ä¼šè¿‡æœŸï¼Œå¦‚æœå°† TTL è®¾ç½®ä¸º 0ï¼Œåˆ™è¡¨ç¤ºé™¤éæ­¤æ—¶å¯ä»¥ç›´æ¥æŠ•é€’è¯¥æ¶ˆæ¯åˆ°æ¶ˆè´¹è€…ï¼Œå¦åˆ™è¯¥æ¶ˆæ¯å°†ä¼šè¢«ä¸¢å¼ƒã€‚ å‰ä¸€å°èŠ‚æˆ‘ä»¬ä»‹ç»äº†æ­»ä¿¡é˜Ÿåˆ—ï¼Œåˆšåˆšåˆä»‹ç»äº† TTLï¼Œè‡³æ­¤åˆ©ç”¨ RabbitMQ å®ç°å»¶æ—¶é˜Ÿåˆ—çš„ä¸¤å¤§è¦ç´ å·²ç»é›†é½ï¼Œæ¥ä¸‹æ¥åªéœ€è¦å°†å®ƒä»¬è¿›è¡Œèåˆï¼Œå†åŠ å…¥ä¸€ç‚¹ç‚¹è°ƒå‘³æ–™ï¼Œå»¶æ—¶é˜Ÿåˆ—å°±å¯ä»¥æ–°é²œå‡ºç‚‰äº†ã€‚æƒ³æƒ³çœ‹ï¼Œå»¶æ—¶é˜Ÿåˆ—ï¼Œä¸å°±æ˜¯æƒ³è¦æ¶ˆæ¯å»¶è¿Ÿå¤šä¹…è¢«å¤„ç†å—ï¼ŒTTL åˆ™åˆšå¥½èƒ½è®©æ¶ˆæ¯åœ¨å»¶è¿Ÿå¤šä¹…ä¹‹åæˆä¸ºæ­»ä¿¡ï¼Œå¦ä¸€æ–¹é¢ï¼Œæˆä¸ºæ­»ä¿¡çš„æ¶ˆæ¯éƒ½ä¼šè¢«æŠ•é€’åˆ°æ­»ä¿¡é˜Ÿåˆ—é‡Œï¼Œè¿™æ ·åªéœ€è¦æ¶ˆè´¹è€…ä¸€ç›´æ¶ˆè´¹æ­»ä¿¡é˜Ÿåˆ—é‡Œçš„æ¶ˆæ¯å°±å®Œäº‹äº†ï¼Œå› ä¸ºé‡Œé¢çš„æ¶ˆæ¯éƒ½æ˜¯å¸Œæœ›è¢«ç«‹å³å¤„ç†çš„æ¶ˆæ¯ã€‚ æ•´åˆSpringBootæ·»åŠ ä¾èµ–123456789101112131415161718192021222324252627282930313233343536373839404142&lt;dependencies&gt; &lt;!--RabbitMQ ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.47&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--swagger--&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.springfox&lt;/groupId&gt; &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt; &lt;version&gt;2.9.2&lt;/version&gt; &lt;/dependency&gt; &lt;!--RabbitMQ æµ‹è¯•ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.amqp&lt;/groupId&gt; &lt;artifactId&gt;spring-rabbit-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt;&lt;/dependencies&gt; ä¿®æ”¹é…ç½®æ–‡ä»¶1234spring.rabbitmq.host=127.0.0.1spring.rabbitmq.port=5672spring.rabbitmq.username=adminspring.rabbitmq.password=123 æ­»ä¿¡é˜Ÿåˆ—å®ç°å»¶è¿ŸMQåˆ›å»ºä¸¤ä¸ªé˜Ÿåˆ— QA å’Œ QBï¼Œä¸¤è€…é˜Ÿåˆ— TTL åˆ†åˆ«è®¾ç½®ä¸º 10S å’Œ 40Sï¼Œç„¶ååœ¨åˆ›å»ºä¸€ä¸ªäº¤æ¢æœº X å’Œæ­»ä¿¡äº¤æ¢æœº Yï¼Œå®ƒä»¬çš„ç±»å‹éƒ½æ˜¯ directï¼Œåˆ›å»ºä¸€ä¸ªæ­»ä¿¡é˜Ÿåˆ— QDï¼Œå®ƒä»¬çš„ç»‘å®šå…³ç³»å¦‚ä¸‹ï¼š é…ç½®æ–‡ä»¶ç±»ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public class TtlQueueConfig &#123; public static final String X_EXCHANGE = &quot;X&quot;; public static final String QUEUE_A = &quot;QA&quot;; public static final String QUEUE_B = &quot;QB&quot;; public static final String Y_DEAD_LETTER_EXCHANGE = &quot;Y&quot;; public static final String DEAD_LETTER_QUEUE = &quot;QD&quot;; // å£°æ˜ xExchange @Bean(&quot;xExchange&quot;) public DirectExchange xExchange() &#123; return new DirectExchange(X_EXCHANGE); &#125; // å£°æ˜ xExchange @Bean(&quot;yExchange&quot;) public DirectExchange yExchange() &#123; return new DirectExchange(Y_DEAD_LETTER_EXCHANGE); &#125; // å£°æ˜é˜Ÿåˆ— A ttl ä¸º 10s å¹¶ç»‘å®šåˆ°å¯¹åº”çš„æ­»ä¿¡äº¤æ¢æœº @Bean(&quot;queueA&quot;) public Queue queueA() &#123; Map&lt;String, Object&gt; args = new HashMap&lt;&gt;(3); // å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº args.put(&quot;x-dead-letter-exchange&quot;, Y_DEAD_LETTER_EXCHANGE); // å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key args.put(&quot;x-dead-letter-routing-key&quot;, &quot;YD&quot;); // å£°æ˜é˜Ÿåˆ—çš„ TTL args.put(&quot;x-message-ttl&quot;, 10000); return QueueBuilder.durable(QUEUE_A).withArguments(args).build(); &#125; // å£°æ˜é˜Ÿåˆ— A ç»‘å®š X äº¤æ¢æœº @Bean public Binding queueaBindingX(@Qualifier(&quot;queueA&quot;) Queue queueA, @Qualifier(&quot;xExchange&quot;) DirectExchange xExchange) &#123; return BindingBuilder.bind(queueA).to(xExchange).with(&quot;XA&quot;); &#125; // å£°æ˜é˜Ÿåˆ— B ttl ä¸º 40s å¹¶ç»‘å®šåˆ°å¯¹åº”çš„æ­»ä¿¡äº¤æ¢æœº @Bean(&quot;queueB&quot;) public Queue queueB() &#123; Map&lt;String, Object&gt; args = new HashMap&lt;&gt;(3); // å£°æ˜å½“å‰é˜Ÿåˆ—ç»‘å®šçš„æ­»ä¿¡äº¤æ¢æœº args.put(&quot;x-dead-letter-exchange&quot;, Y_DEAD_LETTER_EXCHANGE); // å£°æ˜å½“å‰é˜Ÿåˆ—çš„æ­»ä¿¡è·¯ç”± key args.put(&quot;x-dead-letter-routing-key&quot;, &quot;YD&quot;); // å£°æ˜é˜Ÿåˆ—çš„ TTL args.put(&quot;x-message-ttl&quot;, 40000); return QueueBuilder.durable(QUEUE_B).withArguments(args).build(); &#125; // å£°æ˜é˜Ÿåˆ— B ç»‘å®š X äº¤æ¢æœº @Bean public Binding queuebBindingX(@Qualifier(&quot;queueB&quot;) Queue queue1B, @Qualifier(&quot;xExchange&quot;) DirectExchange xExchange) &#123; return BindingBuilder.bind(queue1B).to(xExchange).with(&quot;XB&quot;); &#125; // å£°æ˜æ­»ä¿¡é˜Ÿåˆ— QD @Bean(&quot;queueD&quot;) public Queue queueD() &#123; return new Queue(DEAD_LETTER_QUEUE); &#125; // å£°æ˜æ­»ä¿¡é˜Ÿåˆ— QD ç»‘å®šå…³ç³» @Bean public Binding deadLetterBindingQAD(@Qualifier(&quot;queueD&quot;) Queue queueD, @Qualifier(&quot;yExchange&quot;) DirectExchange yExchange) &#123; return BindingBuilder.bind(queueD).to(yExchange).with(&quot;YD&quot;); &#125;&#125; ç”Ÿäº§è€…ä»£ç 1234567891011121314@Slf4j@RequestMapping(&quot;ttl&quot;)@RestControllerpublic class SendMsgController &#123; @Autowired private RabbitTemplate rabbitTemplate; @GetMapping(&quot;sendMsg/&#123;message&#125;&quot;) public void sendMsg(@PathVariable String message) &#123; log.info(&quot; å½“å‰æ—¶é—´ï¼š&#123;&#125;, å‘é€ä¸€æ¡ä¿¡æ¯ç»™ä¸¤ä¸ª TTL é˜Ÿåˆ—:&#123;&#125;&quot;, new Date(), message); rabbitTemplate.convertAndSend(&quot;X&quot;, &quot;XA&quot;, &quot; æ¶ˆæ¯æ¥è‡ª ttl ä¸º ä¸º 10S çš„é˜Ÿåˆ—: &quot; + message); rabbitTemplate.convertAndSend(&quot;X&quot;, &quot;XB&quot;, &quot; æ¶ˆæ¯æ¥è‡ª ttl ä¸º ä¸º 40S çš„é˜Ÿåˆ—: &quot; + message); &#125;&#125; æ¶ˆè´¹è€…ä»£ç 123456789@Slf4j@Componentpublic class DeadLetterQueueConsumer &#123; @RabbitListener(queues = &quot;QD&quot;) public void receiveD(Message message, Channel channel) throws IOException &#123; String msg = new String(message.getBody()); log.info(&quot; å½“å‰æ—¶é—´ï¼š&#123;&#125;, æ”¶åˆ°æ­»ä¿¡é˜Ÿåˆ—ä¿¡æ¯&#123;&#125;&quot;, new Date().toString(), msg); &#125;&#125; ç¬¬ä¸€æ¡æ¶ˆæ¯åœ¨ 10S åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œç„¶åè¢«æ¶ˆè´¹è€…æ¶ˆè´¹æ‰ï¼Œç¬¬äºŒæ¡æ¶ˆæ¯åœ¨ 40S ä¹‹åå˜æˆäº†æ­»ä¿¡æ¶ˆæ¯ï¼Œç„¶åè¢«æ¶ˆè´¹æ‰ï¼Œè¿™æ ·ä¸€ä¸ªå»¶æ—¶é˜Ÿåˆ—å°±æ‰“é€ å®Œæˆäº†ã€‚ä¸è¿‡ï¼Œå¦‚æœè¿™æ ·ä½¿ç”¨çš„è¯ï¼Œå²‚ä¸æ˜¯æ¯å¢åŠ ä¸€ä¸ªæ–°çš„æ—¶é—´éœ€æ±‚ï¼Œå°±è¦æ–°å¢ä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™é‡Œåªæœ‰ 10S å’Œ 40Sä¸¤ä¸ªæ—¶é—´é€‰é¡¹ï¼Œå¦‚æœéœ€è¦ä¸€ä¸ªå°æ—¶åå¤„ç†ï¼Œé‚£ä¹ˆå°±éœ€è¦å¢åŠ  TTL ä¸ºä¸€ä¸ªå°æ—¶çš„é˜Ÿåˆ—ï¼Œå¦‚æœæ˜¯é¢„å®šä¼šè®®å®¤ç„¶åæå‰é€šçŸ¥è¿™æ ·çš„åœºæ™¯ï¼Œå²‚ä¸æ˜¯è¦å¢åŠ æ— æ•°ä¸ªé˜Ÿåˆ—æ‰èƒ½æ»¡è¶³éœ€æ±‚ï¼Ÿ å»¶æ—¶é˜Ÿåˆ—ä¼˜åŒ–åœ¨è¿™é‡Œæ–°å¢äº†ä¸€ä¸ªé˜Ÿåˆ— QC,ç»‘å®šå…³ç³»å¦‚ä¸‹,è¯¥é˜Ÿåˆ—ä¸è®¾ç½® TTL æ—¶é—´ çœ‹èµ·æ¥ä¼¼ä¹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯åœ¨æœ€å¼€å§‹çš„æ—¶å€™ï¼Œå°±ä»‹ç»è¿‡å¦‚æœä½¿ç”¨åœ¨æ¶ˆæ¯å±æ€§ä¸Šè®¾ç½® TTL çš„æ–¹å¼ï¼Œæ¶ˆæ¯å¯èƒ½å¹¶ä¸ä¼šæŒ‰æ—¶â€œæ­»äº¡â€œï¼Œå› ä¸º RabbitMQ åªä¼šæ£€æŸ¥ç¬¬ä¸€ä¸ªæ¶ˆæ¯æ˜¯å¦è¿‡æœŸï¼Œå¦‚æœè¿‡æœŸåˆ™ä¸¢åˆ°æ­»ä¿¡é˜Ÿåˆ—ï¼Œå¦‚æœç¬¬ä¸€ä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆé•¿ï¼Œè€Œç¬¬äºŒä¸ªæ¶ˆæ¯çš„å»¶æ—¶æ—¶é•¿å¾ˆçŸ­ï¼Œç¬¬äºŒä¸ªæ¶ˆæ¯å¹¶ä¸ä¼šä¼˜å…ˆå¾—åˆ°æ‰§è¡Œã€‚ Rabbitmqæ’ä»¶å®ç°å»¶è¿Ÿé˜Ÿåˆ—å‚è€ƒæ–‡ç«  SpringBoot+RabbitMQç”¨æ­»ä¿¡é˜Ÿåˆ—å’Œæ’ä»¶å½¢å¼å®ç°å»¶è¿Ÿé˜Ÿåˆ— Dockerå®‰è£…RabbitmqåŠå…¶å»¶æ—¶é˜Ÿåˆ—æ’ä»¶ å®‰è£…å»¶æ—¶é˜Ÿåˆ—æ’ä»¶åœ¨å®˜ç½‘ ï¼Œä¸‹è½½rabbitmq_delayed_message_exchangeæ’ä»¶ï¼Œç„¶åè§£å‹æ”¾ç½®åˆ° RabbitMQ çš„æ’ä»¶ç›®å½•ã€‚è¿›å…¥ RabbitMQ çš„å®‰è£…ç›®å½•ä¸‹çš„ plgins ç›®å½•ï¼Œæ‰§è¡Œä¸‹é¢å‘½ä»¤è®©è¯¥æ’ä»¶ç”Ÿæ•ˆï¼Œç„¶åé‡å¯ RabbitMQ /usr/lib/rabbitmq/lib/rabbitmq_server-3.8.8/plugins rabbitmq-plugins enable rabbitmq_delayed_message_exchange å‘å¸ƒç¡®è®¤é«˜çº§å§¿åŠ¿åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ç”±äºä¸€äº›ä¸æ˜åŸå› ï¼Œå¯¼è‡´ rabbitmq é‡å¯ï¼Œåœ¨ RabbitMQ é‡å¯æœŸé—´ç”Ÿäº§è€…æ¶ˆæ¯æŠ•é€’å¤±è´¥ï¼Œå¯¼è‡´æ¶ˆæ¯ä¸¢å¤±ï¼Œéœ€è¦æ‰‹åŠ¨å¤„ç†å’Œæ¢å¤ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ‰èƒ½è¿›è¡Œ RabbitMQ çš„æ¶ˆæ¯å¯é æŠ•é€’å‘¢ï¼Ÿç‰¹åˆ«æ˜¯åœ¨è¿™æ ·æ¯”è¾ƒæç«¯çš„æƒ…å†µï¼ŒRabbitMQ é›†ç¾¤ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ— æ³•æŠ•é€’çš„æ¶ˆæ¯è¯¥å¦‚ä½•å¤„ç†å‘¢: å‘å¸ƒç¡®è®¤ springboot ç‰ˆæœ¬ç¡®è®¤æœºåˆ¶æ–¹æ¡ˆ ä»£ç æ¶æ„å›¾ é…ç½®æ–‡ä»¶12# åœ¨é…ç½®æ–‡ä»¶å½“ä¸­éœ€è¦æ·»åŠ spring.rabbitmq.publisher-confirm-type=correlated NONEï¼šç¦ç”¨å‘å¸ƒç¡®è®¤æ¨¡å¼ï¼Œæ˜¯é»˜è®¤å€¼ CORRELATEDï¼šå‘å¸ƒæ¶ˆæ¯æˆåŠŸåˆ°äº¤æ¢å™¨åä¼šè§¦å‘å›è°ƒæ–¹æ³• SIMPLEï¼šç»æµ‹è¯•æœ‰ä¸¤ç§æ•ˆæœï¼Œå…¶ä¸€æ•ˆæœå’Œ CORRELATED å€¼ä¸€æ ·ä¼šè§¦å‘å›è°ƒæ–¹æ³•ï¼Œå…¶äºŒåœ¨å‘å¸ƒæ¶ˆæ¯æˆåŠŸåä½¿ç”¨ rabbitTemplate è°ƒç”¨ waitForConfirms æˆ– waitForConfirmsOrDie æ–¹æ³•ç­‰å¾… broker èŠ‚ç‚¹è¿”å›å‘é€ç»“æœï¼Œæ ¹æ®è¿”å›ç»“æœæ¥åˆ¤å®šä¸‹ä¸€æ­¥çš„é€»è¾‘ï¼Œè¦æ³¨æ„çš„ç‚¹æ˜¯ waitForConfirmsOrDie æ–¹æ³•å¦‚æœè¿”å› false åˆ™ä¼šå…³é—­ channelï¼Œåˆ™æ¥ä¸‹æ¥æ— æ³•å‘é€æ¶ˆæ¯åˆ° brokerï¼Œæ³¨ï¼šæ­¤é…ç½®åŒæ­¥ç¡®è®¤æ¶ˆæ¯ï¼Œç”Ÿäº§ä¸å»ºè®®ä½¿ç”¨ äº¤æ¢æœºå‘å¸ƒç¡®è®¤ä»£ç 1234567891011121314151617181920212223242526272829public class MessageConfirmCallBack&lt;T&gt; implements RabbitTemplate.ConfirmCallback &#123; @Resource private RabbitTemplate rabbitTemplate; @PostConstruct public void init() &#123; rabbitTemplate.setConfirmCallback(this); &#125; /** * äº¤æ¢æœºç¡®è®¤å›è°ƒæ–¹æ³• (å‘å¸ƒè€…å‘é€æ¶ˆæ¯æ˜¯å¦åˆ°äº¤æ¢æœºè§¦å‘å›è°ƒ) * 1. å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶åˆ°æ¶ˆæ¯ï¼Œå›è°ƒ * 1.1 correlationData ä¿å­˜æ¯æ‰æ¶ˆæ¯çš„idåŠç›¸å…³ä¿¡æ¯ * 1.2 äº¤æ¢æœºæ¥æ”¶åˆ°æ¶ˆæ¯ true * 1.3 å¤±è´¥åŸå› -null * 2. å‘æ¶ˆæ¯ äº¤æ¢æœºæ¥æ”¶å¤±è´¥ å›è°ƒ * 2.1 correlationData ä¿å­˜æ¯æ‰æ¶ˆæ¯çš„idåŠç›¸å…³ä¿¡æ¯ * 2.2 false * 2.3 å¤±è´¥åŸå›  */ @Override public void confirm(CorrelationData correlationData, boolean ack, String cause) &#123; if (ack) &#123; log.info(&quot;å‘å¸ƒç¡®è®¤:äº¤æ¢æœºæ”¶åˆ°æ¶ˆæ¯idï¼š&#123;&#125;&quot;, correlationData.getId()); &#125; else &#123; log.info(&quot;å‘å¸ƒç¡®è®¤:äº¤æ¢æœºæœªæ”¶åˆ°æ¶ˆæ¯ï¼Œidä¸ºï¼š&#123;&#125;,åŸå› ï¼š&#123;&#125;&quot;, correlationData.getId(), cause); // TODO ä¿å­˜æ•°æ®åº“é‡æ–°å‘é€ç­‰é€»è¾‘ä¿è¯æ¶ˆæ¯é‡æ–°å‘é€ç»™äº¤æ¢æœº &#125; &#125;&#125; å›é€€æ¶ˆæ¯åœ¨ä»…å¼€å¯äº†ç”Ÿäº§è€…ç¡®è®¤æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºæ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œä¼šç›´æ¥ç»™æ¶ˆæ¯ç”Ÿäº§è€…å‘é€ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœå‘ç°è¯¥æ¶ˆæ¯ä¸å¯è·¯ç”±ï¼Œé‚£ä¹ˆæ¶ˆæ¯ä¼šè¢«ç›´æ¥ä¸¢å¼ƒï¼Œæ­¤æ—¶ç”Ÿäº§è€…æ˜¯ä¸çŸ¥é“æ¶ˆæ¯è¢«ä¸¢å¼ƒè¿™ä¸ªäº‹ä»¶çš„ã€‚é‚£ä¹ˆå¦‚ä½•è®©æ— æ³•è¢«è·¯ç”±çš„æ¶ˆæ¯å¸®æˆ‘æƒ³åŠæ³•å¤„ç†ä¸€ä¸‹ï¼Ÿæœ€èµ·ç é€šçŸ¥æˆ‘ä¸€å£°ï¼Œæˆ‘å¥½è‡ªå·±å¤„ç†å•Šã€‚é€šè¿‡è®¾ç½® mandatory å‚æ•°å¯ä»¥åœ¨å½“æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­ä¸å¯è¾¾ç›®çš„åœ°æ—¶å°†æ¶ˆæ¯è¿”å›ç»™ç”Ÿäº§è€…ã€‚ æ·»åŠ é…ç½®12# æ¶ˆæ¯å›é€€é…ç½®ï¼Œå¦‚æœæ¶ˆæ¯æ— æ³•è·¯ç”±ï¼Œåˆ™å›é€€ç»™ç”Ÿäº§è€…spring.rabbitmq.publisher-returns=true å›é€€ä»£ç æ¼”ç¤º1234567891011121314151617181920212223public class MessageReturnCallBack&lt;T&gt; implements RabbitTemplate.ReturnCallback &#123; @Resource private RabbitTemplate rabbitTemplate; @PostConstruct public void init() &#123; rabbitTemplate.setReturnCallback(this); &#125; /** * å¯ä»¥å°†æ¶ˆæ¯ä¼ é€’è¿‡ç¨‹ä¸­ä¸å¯è¾¾åˆ°ç›®çš„åœ°(é˜Ÿåˆ—)çš„æ¶ˆæ¯è¿”å›ç»™ç”Ÿäº§è€… * åªæœ‰ä¸å¯è¾¾ æ‰ä¼šå›é€€æ¶ˆæ¯ * è¯·æ³¨æ„!!!å¦‚æœä½ ä½¿ç”¨äº†å»¶è¿Ÿé˜Ÿåˆ—æ’ä»¶ï¼Œé‚£ä¹ˆä¸€å®šä¼šè°ƒç”¨è¯¥callbackæ–¹æ³•ï¼Œå› ä¸ºæ•°æ®å¹¶æ²¡æœ‰æäº¤ä¸Šå»ï¼Œ * è€Œæ˜¯æäº¤åœ¨äº¤æ¢å™¨ä¸­ï¼Œè¿‡æœŸæ—¶é—´åˆ°äº†æ‰æäº¤ä¸Šå»ï¼Œå¹¶éæ˜¯bugï¼ä½ å¯ä»¥ç”¨ifè¿›è¡Œåˆ¤æ–­äº¤æ¢æœºåç§°æ¥æ•æ‰è¯¥æŠ¥é”™ */ @Override public void returnedMessage(Message message, int replyCode, String replyText, String exchange, String routingKey) &#123; if(exchange.equals(delayedQueueProperties.getDelayedExchangeName()))&#123; return; &#125; log.info(&quot;æ¶ˆæ¯&#123;&#125;ï¼Œè¢«äº¤æ¢æœº&#123;&#125;é€€å›ï¼Œé€€å›åŸå› ï¼š&#123;&#125;ï¼Œè·¯ç”±Keyï¼š&#123;&#125;&quot;, new String(message.getBody()), exchange, replyText, routingKey); &#125;&#125; å¤‡ä»½äº¤æ¢æœºæœ‰äº† mandatory å‚æ•°å’Œå›é€€æ¶ˆæ¯ï¼Œæˆ‘ä»¬è·å¾—äº†å¯¹æ— æ³•æŠ•é€’æ¶ˆæ¯çš„æ„ŸçŸ¥èƒ½åŠ›ï¼Œæœ‰æœºä¼šåœ¨ç”Ÿäº§è€…çš„æ¶ˆæ¯æ— æ³•è¢«æŠ•é€’æ—¶å‘ç°å¹¶å¤„ç†ã€‚ä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“è¯¥å¦‚ä½•å¤„ç†è¿™äº›æ— æ³•è·¯ç”±çš„æ¶ˆæ¯ï¼Œæœ€å¤šæ‰“ä¸ªæ—¥å¿—ï¼Œç„¶åè§¦å‘æŠ¥è­¦ï¼Œå†æ¥æ‰‹åŠ¨å¤„ç†ã€‚è€Œé€šè¿‡æ—¥å¿—æ¥å¤„ç†è¿™äº›æ— æ³•è·¯ç”±çš„æ¶ˆæ¯æ˜¯å¾ˆä¸ä¼˜é›…çš„åšæ³•ï¼Œç‰¹åˆ«æ˜¯å½“ç”Ÿäº§è€…æ‰€åœ¨çš„æœåŠ¡æœ‰å¤šå°æœºå™¨çš„æ—¶å€™ï¼Œæ‰‹åŠ¨å¤åˆ¶æ—¥å¿—ä¼šæ›´åŠ éº»çƒ¦è€Œä¸”å®¹æ˜“å‡ºé”™ã€‚è€Œä¸”è®¾ç½® mandatory å‚æ•°ä¼šå¢åŠ ç”Ÿäº§è€…çš„å¤æ‚æ€§ï¼Œéœ€è¦æ·»åŠ å¤„ç†è¿™äº›è¢«é€€å›çš„æ¶ˆæ¯çš„é€»è¾‘ã€‚å¦‚æœæ—¢ä¸æƒ³ä¸¢å¤±æ¶ˆæ¯ï¼Œåˆä¸æƒ³å¢åŠ ç”Ÿäº§è€…çš„å¤æ‚æ€§ï¼Œè¯¥æ€ä¹ˆåšå‘¢ï¼Ÿå‰é¢åœ¨è®¾ç½®æ­»ä¿¡é˜Ÿåˆ—çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°ï¼Œå¯ä»¥ä¸ºé˜Ÿåˆ—è®¾ç½®æ­»ä¿¡äº¤æ¢æœºæ¥å­˜å‚¨é‚£äº›å¤„ç†å¤±è´¥çš„æ¶ˆæ¯ï¼Œå¯æ˜¯è¿™äº›ä¸å¯è·¯ç”±æ¶ˆæ¯æ ¹æœ¬æ²¡æœ‰æœºä¼šè¿›å…¥åˆ°é˜Ÿåˆ—ï¼Œå› æ­¤æ— æ³•ä½¿ç”¨æ­»ä¿¡é˜Ÿåˆ—æ¥ä¿å­˜æ¶ˆæ¯ã€‚åœ¨ RabbitMQ ä¸­ï¼Œæœ‰ä¸€ç§å¤‡ä»½äº¤æ¢æœºçš„æœºåˆ¶å­˜åœ¨ï¼Œå¯ä»¥å¾ˆå¥½çš„åº”å¯¹è¿™ä¸ªé—®é¢˜ã€‚ä»€ä¹ˆæ˜¯å¤‡ä»½äº¤æ¢æœºå‘¢ï¼Ÿå¤‡ä»½äº¤æ¢æœºå¯ä»¥ç†è§£ä¸º RabbitMQ ä¸­äº¤æ¢æœºçš„â€œå¤‡èƒâ€ï¼Œå½“æˆ‘ä»¬ä¸ºæŸä¸€ä¸ªäº¤æ¢æœºå£°æ˜ä¸€ä¸ªå¯¹åº”çš„å¤‡ä»½äº¤æ¢æœºæ—¶ï¼Œå°±æ˜¯ä¸ºå®ƒåˆ›å»ºä¸€ä¸ªå¤‡èƒï¼Œå½“äº¤æ¢æœºæ¥æ”¶åˆ°ä¸€æ¡ä¸å¯è·¯ç”±æ¶ˆæ¯æ—¶ï¼Œå°†ä¼šæŠŠè¿™æ¡æ¶ˆæ¯è½¬å‘åˆ°å¤‡ä»½äº¤æ¢æœºä¸­ï¼Œç”±å¤‡ä»½äº¤æ¢æœºæ¥è¿›è¡Œè½¬å‘å’Œå¤„ç†ï¼Œé€šå¸¸å¤‡ä»½äº¤æ¢æœºçš„ç±»å‹ä¸º Fanout ï¼Œè¿™æ ·å°±èƒ½æŠŠæ‰€æœ‰æ¶ˆæ¯éƒ½æŠ•é€’åˆ°ä¸å…¶ç»‘å®šçš„é˜Ÿåˆ—ä¸­ï¼Œç„¶åæˆ‘ä»¬åœ¨å¤‡ä»½äº¤æ¢æœºä¸‹ç»‘å®šä¸€ä¸ªé˜Ÿåˆ—ï¼Œè¿™æ ·æ‰€æœ‰é‚£äº›åŸäº¤æ¢æœºæ— æ³•è¢«è·¯ç”±çš„æ¶ˆæ¯ï¼Œå°±ä¼šéƒ½è¿›å…¥è¿™ä¸ªé˜Ÿåˆ—äº†ã€‚å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å»ºç«‹ä¸€ä¸ªæŠ¥è­¦é˜Ÿåˆ—ï¼Œç”¨ç‹¬ç«‹çš„æ¶ˆè´¹è€…æ¥è¿›è¡Œç›‘æµ‹å’ŒæŠ¥è­¦ã€‚ å¤‡ä»½äº¤æ¢æœºä»£ç å£°æ˜åœ¨åŸæ¥çš„ä»£ç ä¸Šé¢å¤šå£°æ˜ä¸€ä¸ªäº¤æ¢æœºå’Œä¸¤ä¸ªé˜Ÿåˆ—ï¼Œè¿˜æœ‰ä¸€ä¸ªæŠ¥è­¦æ¶ˆè´¹è€… 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657// @Configurationpublic class ConfirmConfig &#123; public static final String CONFIRM_EXCHANGE_NAME = &quot;confirm.exchange&quot;; public static final String CONFIRM_QUEUE_NAME = &quot;confirm.queue&quot;; public static final String BACKUP_EXCHANGE_NAME = &quot;backup.exchange&quot;; public static final String BACKUP_QUEUE_NAME = &quot;backup.queue&quot;; public static final String WARNING_QUEUE_NAME = &quot;warning.queue&quot;; // å£°æ˜ç¡®è®¤é˜Ÿåˆ— @Bean(&quot;confirmQueue&quot;) public Queue confirmQueue() &#123; return QueueBuilder.durable(CONFIRM_QUEUE_NAME).build(); &#125; // å£°æ˜ç¡®è®¤é˜Ÿåˆ—ç»‘å®šå…³ç³» @Bean public Binding queueBinding(@Qualifier(&quot;confirmQueue&quot;) Queue queue, @Qualifier(&quot;confirmExchange&quot;) DirectExchange exchange) &#123; return BindingBuilder.bind(queue).to(exchange).with(&quot;key1&quot;); &#125; // å£°æ˜å¤‡ä»½ Exchange @Bean(&quot;backupExchange&quot;) public FanoutExchange backupExchange() &#123; return new FanoutExchange(BACKUP_EXCHANGE_NAME); &#125; // å£°æ˜ç¡®è®¤ Exchange äº¤æ¢æœºçš„å¤‡ä»½äº¤æ¢æœº @Bean(&quot;confirmExchange&quot;) public DirectExchange confirmExchange() &#123; ExchangeBuilder exchangeBuilder = ExchangeBuilder.directExchange(CONFIRM_EXCHANGE_NAME) .durable(true) // è®¾ç½®è¯¥äº¤æ¢æœºçš„å¤‡ä»½äº¤æ¢æœº .withArgument(&quot;alternate-exchange&quot;, BACKUP_EXCHANGE_NAME); return (DirectExchange) exchangeBuilder.build(); &#125; // å£°æ˜è­¦å‘Šé˜Ÿåˆ— @Bean(&quot;warningQueue&quot;) public Queue warningQueue() &#123; return QueueBuilder.durable(WARNING_QUEUE_NAME).build(); &#125; // å£°æ˜æŠ¥è­¦é˜Ÿåˆ—ç»‘å®šå…³ç³» @Bean public Binding warningBinding(@Qualifier(&quot;warningQueue&quot;) Queue queue, @Qualifier(&quot;backupExchange&quot;) FanoutExchange backupExchange) &#123; return BindingBuilder.bind(queue).to(backupExchange); &#125; // å£°æ˜å¤‡ä»½é˜Ÿåˆ— @Bean(&quot;backQueue&quot;) public Queue backQueue() &#123; return QueueBuilder.durable(BACKUP_QUEUE_NAME).build(); &#125; // å£°æ˜å¤‡ä»½é˜Ÿåˆ—ç»‘å®šå…³ç³» @Bean public Binding backupBinding(@Qualifier(&quot;backQueue&quot;) Queue queue, @Qualifier(&quot;backupExchange&quot;) FanoutExchange backupExchange) &#123; return BindingBuilder.bind(queue).to(backupExchange); &#125;&#125; æŠ¥è­¦æ¶ˆè´¹è€…1234567891011@Component@Slf4jpublic class WarningConsumer &#123; public static final String WARNING_QUEUE_NAME = &quot;warning.queue&quot;; @RabbitListener(queues = WARNING_QUEUE_NAME) public void receiveWarningMsg(Message message) &#123; String msg = new String(message.getBody()); log.error(&quot; æŠ¥è­¦å‘ç°ä¸å¯è·¯ç”±æ¶ˆæ¯ï¼š&#123;&#125;&quot;, msg); &#125;&#125; æµ‹è¯•æ³¨æ„äº‹é¡¹ é‡æ–°å¯åŠ¨é¡¹ç›®çš„æ—¶å€™éœ€è¦æŠŠåŸæ¥çš„ confirm.exchange åˆ é™¤å› ä¸ºæˆ‘ä»¬ä¿®æ”¹äº†å…¶ç»‘å®šå±æ€§ï¼Œä¸ç„¶æŠ¥é”™ã€‚ å¤‡ä»½äº¤æ¢æœºå’Œå›é€€ä¼˜å…ˆçº§mandatory å‚æ•°ä¸å¤‡ä»½äº¤æ¢æœºå¯ä»¥ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œå¦‚æœä¸¤è€…åŒæ—¶å¼€å¯ï¼Œæ¶ˆæ¯ç©¶ç«Ÿä½•å»ä½•ä»ï¼Ÿè°ä¼˜å…ˆçº§é«˜ï¼Œç»è¿‡ä¸Šé¢ç»“æœæ˜¾ç¤ºç­”æ¡ˆæ˜¯å¤‡ä»½äº¤æ¢æœºä¼˜å…ˆçº§é«˜ã€‚ RabbitMQå…¶ä»–çŸ¥è¯†ç‚¹å¹‚ç­‰æ€§ç”¨æˆ·å¯¹äºåŒä¸€æ“ä½œå‘èµ·çš„ä¸€æ¬¡è¯·æ±‚æˆ–è€…å¤šæ¬¡è¯·æ±‚çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå› ä¸ºå¤šæ¬¡ç‚¹å‡»è€Œäº§ç”Ÿäº†å‰¯ä½œç”¨ã€‚ä¸¾ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œé‚£å°±æ˜¯æ”¯ä»˜ï¼Œç”¨æˆ·è´­ä¹°å•†å“åæ”¯ä»˜ï¼Œæ”¯ä»˜æ‰£æ¬¾æˆåŠŸï¼Œä½†æ˜¯è¿”å›ç»“æœçš„æ—¶å€™ç½‘ç»œå¼‚å¸¸ï¼Œæ­¤æ—¶é’±å·²ç»æ‰£äº†ï¼Œç”¨æˆ·å†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œæ­¤æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡æ‰£æ¬¾ï¼Œè¿”å›ç»“æœæˆåŠŸï¼Œç”¨æˆ·æŸ¥è¯¢ä½™é¢å‘ç°å¤šæ‰£é’±äº†ï¼Œæµæ°´è®°å½•ä¹Ÿå˜æˆäº†ä¸¤æ¡ã€‚åœ¨ä»¥å‰çš„å•åº”ç”¨ç³»ç»Ÿä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠæ•°æ®æ“ä½œæ”¾å…¥äº‹åŠ¡ä¸­å³å¯ï¼Œå‘ç”Ÿé”™è¯¯ç«‹å³å›æ»šï¼Œä½†æ˜¯å†å“åº”å®¢æˆ·ç«¯çš„æ—¶å€™ä¹Ÿæœ‰å¯èƒ½å‡ºç°ç½‘ç»œä¸­æ–­æˆ–è€…å¼‚å¸¸ç­‰ç­‰ æ¶ˆæ¯é‡å¤æ¶ˆè´¹æ¶ˆè´¹è€…åœ¨æ¶ˆè´¹ MQ ä¸­çš„æ¶ˆæ¯æ—¶ï¼ŒMQ å·²æŠŠæ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨ç»™ MQ è¿”å› ack æ—¶ç½‘ç»œä¸­æ–­ï¼Œæ•… MQ æœªæ”¶åˆ°ç¡®è®¤ä¿¡æ¯ï¼Œè¯¥æ¡æ¶ˆæ¯ä¼šé‡æ–°å‘ç»™å…¶ä»–çš„æ¶ˆè´¹è€…ï¼Œæˆ–è€…åœ¨ç½‘ç»œé‡è¿åå†æ¬¡å‘é€ç»™è¯¥æ¶ˆè´¹è€…ï¼Œä½†å®é™…ä¸Šè¯¥æ¶ˆè´¹è€…å·²æˆåŠŸæ¶ˆè´¹äº†è¯¥æ¡æ¶ˆæ¯ï¼Œé€ æˆæ¶ˆè´¹è€…æ¶ˆè´¹äº†é‡å¤çš„æ¶ˆæ¯ã€‚ è§£å†³æ€è·¯MQ æ¶ˆè´¹è€…çš„å¹‚ç­‰æ€§çš„è§£å†³ä¸€èˆ¬ä½¿ç”¨å…¨å±€ ID æˆ–è€…å†™ä¸ªå”¯ä¸€æ ‡è¯†æ¯”å¦‚æ—¶é—´æˆ³ æˆ–è€… UUID æˆ–è€…è®¢å•æ¶ˆè´¹è€…æ¶ˆè´¹ MQ ä¸­çš„æ¶ˆæ¯ä¹Ÿå¯åˆ©ç”¨ MQ çš„è¯¥ id æ¥åˆ¤æ–­ï¼Œæˆ–è€…å¯æŒ‰è‡ªå·±çš„è§„åˆ™ç”Ÿæˆä¸€ä¸ªå…¨å±€å”¯ä¸€ idï¼Œæ¯æ¬¡æ¶ˆè´¹æ¶ˆæ¯æ—¶ç”¨è¯¥ id å…ˆåˆ¤æ–­è¯¥æ¶ˆæ¯æ˜¯å¦å·²æ¶ˆè´¹è¿‡ã€‚ æ¶ˆè´¹ç«¯çš„å¹‚ç­‰æ€§ä¿éšœåœ¨æµ·é‡è®¢å•ç”Ÿæˆçš„ä¸šåŠ¡é«˜å³°æœŸï¼Œç”Ÿäº§ç«¯æœ‰å¯èƒ½å°±ä¼šé‡å¤å‘ç”Ÿäº†æ¶ˆæ¯ï¼Œè¿™æ—¶å€™æ¶ˆè´¹ç«¯å°±è¦å®ç°å¹‚ç­‰æ€§ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬çš„æ¶ˆæ¯æ°¸è¿œä¸ä¼šè¢«æ¶ˆè´¹å¤šæ¬¡ï¼Œå³ä½¿æˆ‘ä»¬æ”¶åˆ°äº†ä¸€æ ·çš„æ¶ˆæ¯ã€‚ä¸šç•Œä¸»æµçš„å¹‚ç­‰æ€§æœ‰ä¸¤ç§æ“ä½œ:a.å”¯ä¸€ ID+æŒ‡çº¹ç æœºåˆ¶,åˆ©ç”¨æ•°æ®åº“ä¸»é”®å»é‡, b.åˆ©ç”¨ redis çš„åŸå­æ€§å»å®ç° å”¯ä¸€ID+ æŒ‡çº¹ç æœºåˆ¶æŒ‡çº¹ç :æˆ‘ä»¬çš„ä¸€äº›è§„åˆ™æˆ–è€…æ—¶é—´æˆ³åŠ åˆ«çš„æœåŠ¡ç»™åˆ°çš„å”¯ä¸€ä¿¡æ¯ç ,å®ƒå¹¶ä¸ä¸€å®šæ˜¯æˆ‘ä»¬ç³»ç»Ÿç”Ÿæˆçš„ï¼ŒåŸºæœ¬éƒ½æ˜¯ç”±æˆ‘ä»¬çš„ä¸šåŠ¡è§„åˆ™æ‹¼æ¥è€Œæ¥ï¼Œä½†æ˜¯ä¸€å®šè¦ä¿è¯å”¯ä¸€æ€§ï¼Œç„¶åå°±åˆ©ç”¨æŸ¥è¯¢è¯­å¥è¿›è¡Œåˆ¤æ–­è¿™ä¸ª id æ˜¯å¦å­˜åœ¨æ•°æ®åº“ä¸­,ä¼˜åŠ¿å°±æ˜¯å®ç°ç®€å•å°±ä¸€ä¸ªæ‹¼æ¥ï¼Œç„¶åæŸ¥è¯¢åˆ¤æ–­æ˜¯å¦é‡å¤ï¼›åŠ£åŠ¿å°±æ˜¯åœ¨é«˜å¹¶å‘æ—¶ï¼Œå¦‚æœæ˜¯å•ä¸ªæ•°æ®åº“å°±ä¼šæœ‰å†™å…¥æ€§èƒ½ç“¶é¢ˆå½“ç„¶ä¹Ÿå¯ä»¥é‡‡ç”¨åˆ†åº“åˆ†è¡¨æå‡æ€§èƒ½ï¼Œä½†ä¹Ÿä¸æ˜¯æˆ‘ä»¬æœ€æ¨èçš„æ–¹å¼ã€‚ RedisåŸå­æ€§åˆ©ç”¨ redis æ‰§è¡Œ setnx å‘½ä»¤ï¼Œå¤©ç„¶å…·æœ‰å¹‚ç­‰æ€§ã€‚ä»è€Œå®ç°ä¸é‡å¤æ¶ˆè´¹ï¼Œæ­¤æ–¹å¼ä¸ºç›®å‰ç”¨çš„æœ€å¤šçš„æ–¹æ¡ˆã€‚ ä¼˜å…ˆçº§é˜Ÿåˆ—ä½¿ç”¨åœºæ™¯åœ¨æˆ‘ä»¬ç³»ç»Ÿä¸­æœ‰ä¸€ä¸ªè®¢å•å‚¬ä»˜çš„åœºæ™¯ï¼Œæˆ‘ä»¬çš„å®¢æˆ·åœ¨å¤©çŒ«ä¸‹çš„è®¢å•,æ·˜å®ä¼šåŠæ—¶å°†è®¢å•æ¨é€ç»™æˆ‘ä»¬ï¼Œå¦‚æœåœ¨ç”¨æˆ·è®¾å®šçš„æ—¶é—´å†…æœªä»˜æ¬¾é‚£ä¹ˆå°±ä¼šç»™ç”¨æˆ·æ¨é€ä¸€æ¡çŸ­ä¿¡æé†’ï¼Œå¾ˆç®€å•çš„ä¸€ä¸ªåŠŸèƒ½å¯¹å§ï¼Œä½†æ˜¯ï¼Œtmallå•†å®¶å¯¹æˆ‘ä»¬æ¥è¯´ï¼Œè‚¯å®šæ˜¯è¦åˆ†å¤§å®¢æˆ·å’Œå°å®¢æˆ·çš„å¯¹å§ï¼Œæ¯”å¦‚åƒè‹¹æœï¼Œå°ç±³è¿™æ ·å¤§å•†å®¶ä¸€å¹´èµ·ç èƒ½ç»™æˆ‘ä»¬åˆ›é€ å¾ˆå¤§çš„åˆ©æ¶¦ï¼Œæ‰€ä»¥ç†åº”å½“ç„¶ï¼Œä»–ä»¬çš„è®¢å•å¿…é¡»å¾—åˆ°ä¼˜å…ˆå¤„ç†ï¼Œè€Œæ›¾ç»æˆ‘ä»¬çš„åç«¯ç³»ç»Ÿæ˜¯ä½¿ç”¨ redis æ¥å­˜æ”¾çš„å®šæ—¶è½®è¯¢ï¼Œå¤§å®¶éƒ½çŸ¥é“ redis åªèƒ½ç”¨ List åšä¸€ä¸ªç®€ç®€å•å•çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œå¹¶ä¸èƒ½å®ç°ä¸€ä¸ªä¼˜å…ˆçº§çš„åœºæ™¯ï¼Œæ‰€ä»¥è®¢å•é‡å¤§äº†åé‡‡ç”¨ RabbitMQ è¿›è¡Œæ”¹é€ å’Œä¼˜åŒ–,å¦‚æœå‘ç°æ˜¯å¤§å®¢æˆ·çš„è®¢å•ç»™ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒé«˜çš„ä¼˜å…ˆçº§ï¼Œå¦åˆ™å°±æ˜¯é»˜è®¤ä¼˜å…ˆçº§ã€‚ å¦‚ä½•æ·»åŠ a.æ§åˆ¶å°é¡µé¢æ·»åŠ  b.é˜Ÿåˆ—ä¸­ä»£ç æ·»åŠ ä¼˜å…ˆçº§ 123Map&lt;String, Object&gt; params = new HashMap();params.put(&quot;x-max-priority&quot;, 10);channel.queueDeclare(&quot;hello&quot;, true, false, false, params); c.æ¶ˆæ¯ä¸­ä»£ç æ·»åŠ ä¼˜å…ˆçº§ 1AMQP.BasicProperties properties = new AMQP.BasicProperties().builder().priority(5).build(); d.æ³¨æ„äº‹é¡¹ è¦è®©é˜Ÿåˆ—å®ç°ä¼˜å…ˆçº§éœ€è¦åšçš„äº‹æƒ…æœ‰å¦‚ä¸‹äº‹æƒ…:é˜Ÿåˆ—éœ€è¦è®¾ç½®ä¸ºä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œæ¶ˆæ¯éœ€è¦è®¾ç½®æ¶ˆæ¯çš„ä¼˜å…ˆçº§ï¼Œæ¶ˆè´¹è€…éœ€è¦ç­‰å¾…æ¶ˆæ¯å·²ç»å‘é€åˆ°é˜Ÿåˆ—ä¸­æ‰å»æ¶ˆè´¹å› ä¸ºï¼Œè¿™æ ·æ‰æœ‰æœºä¼šå¯¹æ¶ˆæ¯è¿›è¡Œæ’åº å®æˆ˜ç”Ÿäº§è€…1234567891011121314151617181920public class Producer &#123; private static final String QUEUE_NAME = &quot;hello&quot;; public static void main(String[] args) throws Exception &#123; try (Channel channel = RabbitMqUtils.getChannel();) &#123; // ç»™æ¶ˆæ¯èµ‹äºˆä¸€ä¸ª priority å±æ€§ AMQP.BasicProperties properties = new AMQP.BasicProperties().builder().priority(5).build(); for (int i = 1; i &lt; 11; i++) &#123; String message = &quot;info&quot; + i; if (i == 5) &#123; channel.basicPublish(&quot;&quot;, QUEUE_NAME, properties, message.getBytes()); &#125; else &#123; channel.basicPublish(&quot;&quot;, QUEUE_NAME, null, message.getBytes()); &#125; System.out.println(&quot; å‘é€æ¶ˆæ¯å®Œæˆ:&quot; + message); &#125; &#125; &#125;&#125; æ¶ˆè´¹è€…12345678910111213141516171819public class Consumer &#123; private static final String QUEUE_NAME = &quot;hello&quot;; public static void main(String[] args) throws Exception &#123; Channel channel = RabbitMqUtils.getChannel(); // è®¾ç½®é˜Ÿåˆ—çš„æœ€å¤§ä¼˜å…ˆçº§ æœ€å¤§å¯ä»¥è®¾ç½®åˆ° 255 å®˜ç½‘æ¨è 1-10 å¦‚æœè®¾ç½®å¤ªé«˜æ¯”è¾ƒåƒå†…å­˜å’Œ CPU Map&lt;String, Object&gt; params = new HashMap(); params.put(&quot;x-max-priority&quot;, 10); channel.queueDeclare(QUEUE_NAME, true, false, false, params); System.out.println(&quot; æ¶ˆè´¹è€…å¯åŠ¨ç­‰å¾…æ¶ˆè´¹......&quot;); DeliverCallback deliverCallback = (consumerTag, delivery) -&gt; &#123; String receivedMessage = new String(delivery.getBody()); System.out.println(&quot; æ¥æ”¶åˆ°æ¶ˆæ¯:&quot; + receivedMessage); &#125;; channel.basicConsume(QUEUE_NAME, true, deliverCallback, (consumerTag) -&gt; &#123; System.out.println(&quot; æ¶ˆè´¹è€…æ— æ³•æ¶ˆè´¹ æ¶ˆæ¯æ—¶è°ƒç”¨ï¼Œå¦‚é˜Ÿåˆ—è¢«åˆ é™¤&quot;); &#125;); &#125;&#125; æƒ°æ€§é˜Ÿåˆ—RabbitMQ ä» 3.6.0 ç‰ˆæœ¬å¼€å§‹å¼•å…¥äº†æƒ°æ€§é˜Ÿåˆ—çš„æ¦‚å¿µã€‚æƒ°æ€§é˜Ÿåˆ—ä¼šå°½å¯èƒ½çš„å°†æ¶ˆæ¯å­˜å…¥ç£ç›˜ä¸­ï¼Œè€Œåœ¨æ¶ˆè´¹è€…æ¶ˆè´¹åˆ°ç›¸åº”çš„æ¶ˆæ¯æ—¶æ‰ä¼šè¢«åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå®ƒçš„ä¸€ä¸ªé‡è¦çš„è®¾è®¡ç›®æ ‡æ˜¯èƒ½å¤Ÿæ”¯æŒæ›´é•¿çš„é˜Ÿåˆ—ï¼Œå³æ”¯æŒæ›´å¤šçš„æ¶ˆæ¯å­˜å‚¨ã€‚å½“æ¶ˆè´¹è€…ç”±äºå„ç§å„æ ·çš„åŸå› (æ¯”å¦‚æ¶ˆè´¹è€…ä¸‹çº¿ã€å®•æœºäº¦æˆ–è€…æ˜¯ç”±äºç»´æŠ¤è€Œå…³é—­ç­‰)è€Œè‡´ä½¿é•¿æ—¶é—´å†…ä¸èƒ½æ¶ˆè´¹æ¶ˆæ¯é€ æˆå †ç§¯æ—¶ï¼Œæƒ°æ€§é˜Ÿåˆ—å°±å¾ˆæœ‰å¿…è¦äº†ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€åˆ° RabbitMQ çš„æ—¶å€™ï¼Œé˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ä¼šå°½å¯èƒ½çš„å­˜å‚¨åœ¨å†…å­˜ä¹‹ä¸­ï¼Œè¿™æ ·å¯ä»¥æ›´åŠ å¿«é€Ÿçš„å°†æ¶ˆæ¯å‘é€ç»™æ¶ˆè´¹è€…ã€‚å³ä½¿æ˜¯æŒä¹…åŒ–çš„æ¶ˆæ¯ï¼Œåœ¨è¢«å†™å…¥ç£ç›˜çš„åŒæ—¶ä¹Ÿä¼šåœ¨å†…å­˜ä¸­é©»ç•™ä¸€ä»½å¤‡ä»½ã€‚å½“ RabbitMQ éœ€è¦é‡Šæ”¾å†…å­˜çš„æ—¶å€™ï¼Œä¼šå°†å†…å­˜ä¸­çš„æ¶ˆæ¯æ¢é¡µè‡³ç£ç›˜ä¸­ï¼Œè¿™ä¸ªæ“ä½œä¼šè€—è´¹è¾ƒé•¿çš„æ—¶é—´ï¼Œä¹Ÿä¼šé˜»å¡é˜Ÿåˆ—çš„æ“ä½œï¼Œè¿›è€Œæ— æ³•æ¥æ”¶æ–°çš„æ¶ˆæ¯ã€‚è™½ç„¶ RabbitMQ çš„å¼€å‘è€…ä»¬ä¸€ç›´åœ¨å‡çº§ç›¸å…³çš„ç®—æ³•ï¼Œä½†æ˜¯æ•ˆæœå§‹ç»ˆä¸å¤ªç†æƒ³ï¼Œå°¤å…¶æ˜¯åœ¨æ¶ˆæ¯é‡ç‰¹åˆ«å¤§çš„æ—¶å€™ã€‚ ä¸¤ç§æ¨¡å¼é˜Ÿåˆ—å…·å¤‡ä¸¤ç§æ¨¡å¼ï¼šdefault å’Œ lazyã€‚é»˜è®¤çš„ä¸º default æ¨¡å¼ï¼Œåœ¨ 3.6.0 ä¹‹å‰çš„ç‰ˆæœ¬æ— éœ€åšä»»ä½•å˜æ›´ã€‚lazyæ¨¡å¼å³ä¸ºæƒ°æ€§é˜Ÿåˆ—çš„æ¨¡å¼ï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ channel.queueDeclare æ–¹æ³•çš„æ—¶å€™åœ¨å‚æ•°ä¸­è®¾ç½®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡Policy çš„æ–¹å¼è®¾ç½®ï¼Œå¦‚æœä¸€ä¸ªé˜Ÿåˆ—åŒæ—¶ä½¿ç”¨è¿™ä¸¤ç§æ–¹å¼è®¾ç½®çš„è¯ï¼Œé‚£ä¹ˆ Policy çš„æ–¹å¼å…·å¤‡æ›´é«˜çš„ä¼˜å…ˆçº§ã€‚å¦‚æœè¦é€šè¿‡å£°æ˜çš„æ–¹å¼æ”¹å˜å·²æœ‰é˜Ÿåˆ—çš„æ¨¡å¼çš„è¯ï¼Œé‚£ä¹ˆåªèƒ½å…ˆåˆ é™¤é˜Ÿåˆ—ï¼Œç„¶åå†é‡æ–°å£°æ˜ä¸€ä¸ªæ–°çš„ã€‚åœ¨é˜Ÿåˆ—å£°æ˜çš„æ—¶å€™å¯ä»¥é€šè¿‡â€œx-queue-modeâ€å‚æ•°æ¥è®¾ç½®é˜Ÿåˆ—çš„æ¨¡å¼ï¼Œå–å€¼ä¸ºâ€œdefaultâ€å’Œâ€œlazyâ€ã€‚ä¸‹é¢ç¤ºä¾‹ä¸­æ¼”ç¤ºäº†ä¸€ä¸ªæƒ°æ€§é˜Ÿåˆ—çš„å£°æ˜ç»†èŠ‚ï¼š 123Map&lt;String, Object&gt; args = new HashMap&lt;String, Object&gt;();args.put(&quot;x-queue-mode&quot;, &quot;lazy&quot;);channel.queueDeclare(&quot;myqueue&quot;, false, false, false, args); å†…å­˜å¼€é”€å¯¹æ¯” åœ¨å‘é€ 1 ç™¾ä¸‡æ¡æ¶ˆæ¯ï¼Œæ¯æ¡æ¶ˆæ¯å¤§æ¦‚å  1KB çš„æƒ…å†µä¸‹ï¼Œæ™®é€šé˜Ÿåˆ—å ç”¨å†…å­˜æ˜¯ 1.2GBï¼Œè€Œæƒ°æ€§é˜Ÿåˆ—ä»…ä»…å ç”¨ 1.5MB RabbitMQ é›†ç¾¤clusteringé›†ç¾¤æ¨¡å¼ä½¿ç”¨é›†ç¾¤çš„åŸå› æœ€å¼€å§‹æˆ‘ä»¬ä»‹ç»äº†å¦‚ä½•å®‰è£…åŠè¿è¡Œ RabbitMQ æœåŠ¡ï¼Œä¸è¿‡è¿™äº›æ˜¯å•æœºç‰ˆçš„ï¼Œæ— æ³•æ»¡è¶³ç›®å‰çœŸå®åº”ç”¨çš„è¦æ±‚ã€‚å¦‚æœ RabbitMQ æœåŠ¡å™¨é‡åˆ°å†…å­˜å´©æºƒã€æœºå™¨æ‰ç”µæˆ–è€…ä¸»æ¿æ•…éšœç­‰æƒ…å†µï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿå•å° RabbitMQæœåŠ¡å™¨å¯ä»¥æ»¡è¶³æ¯ç§’ 1000 æ¡æ¶ˆæ¯çš„ååé‡ï¼Œé‚£ä¹ˆå¦‚æœåº”ç”¨éœ€è¦ RabbitMQ æœåŠ¡æ»¡è¶³æ¯ç§’ 10 ä¸‡æ¡æ¶ˆæ¯çš„ååé‡å‘¢ï¼Ÿè´­ä¹°æ˜‚è´µçš„æœåŠ¡å™¨æ¥å¢å¼ºå•æœº RabbitMQ åŠ¡çš„æ€§èƒ½æ˜¾å¾—æ‰è¥Ÿè§è‚˜ï¼Œæ­å»ºä¸€ä¸ª RabbitMQ é›†ç¾¤æ‰æ˜¯è§£å†³å®é™…é—®é¢˜çš„å…³é”®ã€‚ æ­å»ºæ­¥éª¤1.ä¿®æ”¹ 3 å°æœºå™¨çš„ä¸»æœºåç§° vim /etc/hostname 2.é…ç½®å„ä¸ªèŠ‚ç‚¹çš„ hosts æ–‡ä»¶ï¼Œè®©å„ä¸ªèŠ‚ç‚¹éƒ½èƒ½äº’ç›¸è¯†åˆ«å¯¹æ–¹ vim /etc/hosts10.211.55.74 node110.211.55.75 node210.211.55.76 node3 3.ä»¥ç¡®ä¿å„ä¸ªèŠ‚ç‚¹çš„ cookie æ–‡ä»¶ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªå€¼ åœ¨ node1 ä¸Šæ‰§è¡Œè¿œç¨‹æ“ä½œå‘½ä»¤scp /var/lib/rabbitmq/.erlang.cookie root@node2:/var/lib/rabbitmq/.erlang.cookiescp /var/lib/rabbitmq/.erlang.cookie root@node3:/var/lib/rabbitmq/.erlang.cookie 4.å¯åŠ¨ RabbitMQ æœåŠ¡,é¡ºå¸¦å¯åŠ¨ Erlang è™šæ‹Ÿæœºå’Œ RbbitMQ åº”ç”¨æœåŠ¡(åœ¨ä¸‰å°èŠ‚ç‚¹ä¸Šåˆ†åˆ«æ‰§è¡Œä»¥ä¸‹å‘½ä»¤) rabbitmq-server -detached 5.åœ¨èŠ‚ç‚¹ 2 æ‰§è¡Œ 1234rabbitmqctl stop_app (rabbitmqctl stop ä¼šå°† Erlang è™šæ‹Ÿæœºå…³é—­ï¼Œrabbitmqctl stop_app åªå…³é—­ RabbitMQ æœåŠ¡)rabbitmqctl resetrabbitmqctl join_cluster rabbit@node1rabbitmqctl start_app(åªå¯åŠ¨åº”ç”¨æœåŠ¡) 6.åœ¨èŠ‚ç‚¹ 3 æ‰§è¡Œ 1234rabbitmqctl stop_apprabbitmqctl resetrabbitmqctl join_cluster rabbit@node2rabbitmqctl start_app 7.é›†ç¾¤çŠ¶æ€ rabbitmqctl cluster_status 8.éœ€è¦é‡æ–°è®¾ç½®ç”¨æˆ· åˆ›å»ºè´¦å·rabbitmqctl add_user admin 123è®¾ç½®ç”¨æˆ·è§’è‰²rabbitmqctl set_user_tags admin administratorè®¾ç½®ç”¨æˆ·æƒé™rabbitmqctl set_permissions -p &quot;/&quot; admin &quot;.*&quot; &quot;.*&quot; &quot;.*&quot; 9.è§£é™¤é›†ç¾¤èŠ‚ç‚¹(node2 å’Œ node3 æœºå™¨åˆ†åˆ«æ‰§è¡Œ) 12345rabbitmqctl stop_apprabbitmqctl resetrabbitmqctl start_apprabbitmqctl cluster_statusrabbitmqctl forget_cluster_node rabbit@node2(node1 æœºå™¨ä¸Šæ‰§è¡Œ) é•œåƒé˜Ÿåˆ—ä½¿ç”¨é•œåƒçš„åŸå› å¦‚æœ RabbitMQ é›†ç¾¤ä¸­åªæœ‰ä¸€ä¸ª Broker èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹çš„å¤±æ•ˆå°†å¯¼è‡´æ•´ä½“æœåŠ¡çš„ä¸´æ—¶æ€§ä¸å¯ç”¨ï¼Œå¹¶ä¸”ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´æ¶ˆæ¯çš„ä¸¢å¤±ã€‚å¯ä»¥å°†æ‰€æœ‰æ¶ˆæ¯éƒ½è®¾ç½®ä¸ºæŒä¹…åŒ–ï¼Œå¹¶ä¸”å¯¹åº”é˜Ÿåˆ—çš„durableå±æ€§ä¹Ÿè®¾ç½®ä¸ºtrueï¼Œä½†æ˜¯è¿™æ ·ä»ç„¶æ— æ³•é¿å…ç”±äºç¼“å­˜å¯¼è‡´çš„é—®é¢˜ï¼šå› ä¸ºæ¶ˆæ¯åœ¨å‘é€ä¹‹åå’Œè¢«å†™å…¥ç£ç›˜äº•æ‰§è¡Œåˆ·ç›˜åŠ¨ä½œä¹‹é—´å­˜åœ¨ä¸€ä¸ªçŸ­æš‚å´ä¼šäº§ç”Ÿé—®é¢˜çš„æ—¶é—´çª—ã€‚é€šè¿‡ publisherconfirm æœºåˆ¶èƒ½å¤Ÿç¡®ä¿å®¢æˆ·ç«¯çŸ¥é“å“ªäº›æ¶ˆæ¯å·±ç»å­˜å…¥ç£ç›˜ï¼Œå°½ç®¡å¦‚æ­¤ï¼Œä¸€èˆ¬ä¸å¸Œæœ›é‡åˆ°å› å•ç‚¹æ•…éšœå¯¼è‡´çš„æœåŠ¡ä¸å¯ç”¨ã€‚å¼•å…¥é•œåƒé˜Ÿåˆ—(Mirror Queue)çš„æœºåˆ¶ï¼Œå¯ä»¥å°†é˜Ÿåˆ—é•œåƒåˆ°é›†ç¾¤ä¸­çš„å…¶ä»– Broker èŠ‚ç‚¹ä¹‹ä¸Šï¼Œå¦‚æœé›†ç¾¤ä¸­çš„ä¸€ä¸ªèŠ‚ç‚¹å¤±æ•ˆäº†ï¼Œé˜Ÿåˆ—èƒ½è‡ªåŠ¨åœ°åˆ‡æ¢åˆ°é•œåƒä¸­çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šä»¥ä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ã€‚ æ­å»ºæ­¥éª¤1.å¯åŠ¨ä¸‰å°é›†ç¾¤èŠ‚ç‚¹ 2.éšä¾¿æ‰¾ä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ  policy 3.åœ¨ node1 ä¸Šåˆ›å»ºä¸€ä¸ªé˜Ÿåˆ—å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œé˜Ÿåˆ—å­˜åœ¨é•œåƒé˜Ÿåˆ— 4.åœæ‰ node1 ä¹‹åå‘ç° node2 æˆä¸ºé•œåƒé˜Ÿåˆ— 5.å°±ç®—æ•´ä¸ªé›†ç¾¤åªå‰©ä¸‹ä¸€å°æœºå™¨äº† ä¾ç„¶èƒ½æ¶ˆè´¹é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯ è¯´æ˜é˜Ÿåˆ—é‡Œé¢çš„æ¶ˆæ¯è¢«é•œåƒé˜Ÿåˆ—ä¼ é€’åˆ°ç›¸åº”æœºå™¨é‡Œé¢äº† å®ç°é«˜å¯ç”¨è´Ÿè½½å‡è¡¡æ•´ä½“æ¶æ„å›¾ Haproxy å®ç°è´Ÿè½½å‡è¡¡HAProxy æä¾›é«˜å¯ç”¨æ€§ã€è´Ÿè½½å‡è¡¡åŠåŸºäº TCPHTTP åº”ç”¨çš„ä»£ç†ï¼Œæ”¯æŒè™šæ‹Ÿä¸»æœºï¼Œå®ƒæ˜¯å…è´¹ã€å¿«é€Ÿå¹¶ä¸”å¯é çš„ä¸€ç§è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ Twitter,Reddit,StackOverflow,GitHub åœ¨å†…çš„å¤šå®¶çŸ¥åäº’è”ç½‘å…¬å¸åœ¨ä½¿ç”¨ã€‚HAProxy å®ç°äº†ä¸€ç§äº‹ä»¶é©±åŠ¨ã€å•ä¸€è¿›ç¨‹æ¨¡å‹ï¼Œæ­¤æ¨¡å‹æ”¯æŒéå¸¸å¤§çš„äº•å‘è¿æ¥æ•°ã€‚ æ‰©å±• nginx,lvs,haproxy ä¹‹é—´çš„åŒºåˆ«: http://www.ha97.com/5646.html Keepalivedå®ç°åŒæœºè¯•æƒ³å¦‚æœå‰é¢é…ç½®çš„ HAProxy ä¸»æœºçªç„¶å®•æœºæˆ–è€…ç½‘å¡å¤±æ•ˆï¼Œé‚£ä¹ˆè™½ç„¶ RbbitMQ é›†ç¾¤æ²¡æœ‰ä»»ä½•æ•…éšœä½†æ˜¯å¯¹äºå¤–ç•Œçš„å®¢æˆ·ç«¯æ¥è¯´æ‰€æœ‰çš„è¿æ¥éƒ½ä¼šè¢«æ–­å¼€ç»“æœå°†æ˜¯ç¾éš¾æ€§çš„ä¸ºäº†ç¡®ä¿è´Ÿè½½å‡è¡¡æœåŠ¡çš„å¯é æ€§åŒæ ·æ˜¾å¾—ååˆ†é‡è¦ï¼Œè¿™é‡Œå°±è¦å¼•å…¥ Keepalived å®ƒèƒ½å¤Ÿé€šè¿‡è‡ªèº«å¥åº·æ£€æŸ¥ã€èµ„æºæ¥ç®¡åŠŸèƒ½åšé«˜å¯ç”¨(åŒæœºçƒ­å¤‡)ï¼Œå®ç°æ•…éšœè½¬ç§»ã€‚ Federation Exchangeâ€‹ (broker åŒ—äº¬)ï¼Œ(broker æ·±åœ³)å½¼æ­¤ä¹‹é—´ç›¸è·ç”šè¿œï¼Œç½‘ç»œå»¶è¿Ÿæ˜¯ä¸€ä¸ªä¸å¾—ä¸é¢å¯¹çš„é—®é¢˜ã€‚æœ‰ä¸€ä¸ªåœ¨åŒ—äº¬çš„ä¸šåŠ¡(Client åŒ—äº¬) éœ€è¦è¿æ¥(broker åŒ—äº¬)ï¼Œå‘å…¶ä¸­çš„äº¤æ¢å™¨ exchangeA å‘é€æ¶ˆæ¯ï¼Œæ­¤æ—¶çš„ç½‘ç»œå»¶è¿Ÿå¾ˆå°ï¼Œ(Client åŒ—äº¬)å¯ä»¥è¿…é€Ÿå°†æ¶ˆæ¯å‘é€è‡³ exchangeA ä¸­ï¼Œå°±ç®—åœ¨å¼€å¯äº† publisherconfirm æœºåˆ¶æˆ–è€…äº‹åŠ¡æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œä¹Ÿå¯ä»¥è¿…é€Ÿæ”¶åˆ°ç¡®è®¤ä¿¡æ¯ã€‚æ­¤æ—¶åˆæœ‰ä¸ªåœ¨æ·±åœ³çš„ä¸šåŠ¡(Client æ·±åœ³)éœ€è¦å‘ exchangeA å‘é€æ¶ˆæ¯ï¼Œé‚£ä¹ˆ(Client æ·±åœ³) (broker åŒ—äº¬)ä¹‹é—´æœ‰å¾ˆå¤§çš„ç½‘ç»œå»¶è¿Ÿï¼Œ(Client æ·±åœ³) å°†å‘é€æ¶ˆæ¯è‡³ exchangeA ä¼šç»å†ä¸€å®šçš„å»¶è¿Ÿï¼Œå°¤å…¶æ˜¯åœ¨å¼€å¯äº† publisherconfirm æœºåˆ¶æˆ–è€…äº‹åŠ¡æœºåˆ¶çš„æƒ…å†µä¸‹ï¼Œ(Client æ·±åœ³) ä¼šç­‰å¾…å¾ˆé•¿çš„å»¶è¿Ÿæ—¶é—´æ¥æ¥æ”¶(broker åŒ—äº¬)çš„ç¡®è®¤ä¿¡æ¯ï¼Œè¿›è€Œå¿…ç„¶é€ æˆè¿™æ¡å‘é€çº¿ç¨‹çš„æ€§èƒ½é™ä½ï¼Œç”šè‡³é€ æˆä¸€å®šç¨‹åº¦ä¸Šçš„é˜»å¡ã€‚â€‹ å°†ä¸šåŠ¡(Client æ·±åœ³)éƒ¨ç½²åˆ°åŒ—äº¬çš„æœºæˆ¿å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœ(Client æ·±åœ³)è°ƒç”¨çš„å¦äº›æœåŠ¡éƒ½éƒ¨ç½²åœ¨æ·±åœ³ï¼Œé‚£ä¹ˆåˆä¼šå¼•å‘æ–°çš„æ—¶å»¶é—®é¢˜ï¼Œæ€»ä¸è§å¾—å°†æ‰€æœ‰ä¸šåŠ¡å…¨éƒ¨éƒ¨ç½²åœ¨ä¸€ä¸ªæœºæˆ¿ï¼Œé‚£ä¹ˆå®¹ç¾åˆä½•ä»¥å®ç°ï¼Ÿè¿™é‡Œä½¿ç”¨ Federation æ’ä»¶å°±å¯ä»¥å¾ˆå¥½åœ°è§£å†³è¿™ä¸ªé—®é¢˜. æ­å»ºæ­¥éª¤1.éœ€è¦ä¿è¯æ¯å°èŠ‚ç‚¹å•ç‹¬è¿è¡Œ 2.åœ¨æ¯å°æœºå™¨ä¸Šå¼€å¯ federation ç›¸å…³æ’ä»¶ 12rabbitmq-plugins enable rabbitmq_federationrabbitmq-plugins enable rabbitmq_federation_management 3.åŸç†å›¾(å…ˆè¿è¡Œ consumer åœ¨ node2 åˆ›å»º fed_exchange) 4.åœ¨ downstream(node2)é…ç½® upstream(node1) 5.æ·»åŠ  policy 6.æˆåŠŸçš„å‰æ Federation Queueè”é‚¦é˜Ÿåˆ—å¯ä»¥åœ¨å¤šä¸ª Broker èŠ‚ç‚¹(æˆ–è€…é›†ç¾¤)ä¹‹é—´ä¸ºå•ä¸ªé˜Ÿåˆ—æä¾›å‡è¡¡è´Ÿè½½çš„åŠŸèƒ½ã€‚ä¸€ä¸ªè”é‚¦é˜Ÿåˆ—å¯ä»¥è¿æ¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªä¸Šæ¸¸é˜Ÿåˆ—(upstream queue)ï¼Œå¹¶ä»è¿™äº›ä¸Šæ¸¸é˜Ÿåˆ—ä¸­è·å–æ¶ˆæ¯ä»¥æ»¡è¶³æœ¬åœ°æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯çš„éœ€æ±‚ã€‚ æ­å»ºæ­¥éª¤1.åŸç†å›¾ 2.æ·»åŠ  upstream(åŒä¸Š) 3.æ·»åŠ  policy ShovelFederation å…·å¤‡çš„æ•°æ®è½¬å‘åŠŸèƒ½ç±»ä¼¼ï¼ŒShovel å¤Ÿå¯é ã€æŒç»­åœ°ä»ä¸€ä¸ª Broker ä¸­çš„é˜Ÿåˆ—(ä½œä¸ºæºç«¯ï¼Œå³source)æ‹‰å–æ•°æ®å¹¶è½¬å‘è‡³å¦ä¸€ä¸ª Broker ä¸­çš„äº¤æ¢å™¨(ä½œä¸ºç›®çš„ç«¯ï¼Œå³ destination)ã€‚ä½œä¸ºæºç«¯çš„é˜Ÿåˆ—å’Œä½œä¸ºç›®çš„ç«¯çš„äº¤æ¢å™¨å¯ä»¥åŒæ—¶ä½äºåŒä¸€ä¸ª Brokerï¼Œä¹Ÿå¯ä»¥ä½äºä¸åŒçš„ Broker ä¸Šã€‚Shovel å¯ä»¥ç¿»è¯‘ä¸ºâ€é“²å­â€ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒå½¢è±¡çš„æ¯”å–»ï¼Œè¿™ä¸ªâ€é“²å­â€å¯ä»¥å°†æ¶ˆæ¯ä»ä¸€æ–¹â€é“²å­â€å¦ä¸€æ–¹ã€‚Shovel è¡Œä¸ºå°±åƒä¼˜ç§€çš„å®¢æˆ·ç«¯åº”ç”¨ç¨‹åºèƒ½å¤Ÿè´Ÿè´£è¿æ¥æºå’Œç›®çš„åœ°ã€è´Ÿè´£æ¶ˆæ¯çš„è¯»å†™åŠè´Ÿè´£è¿æ¥å¤±è´¥é—®é¢˜çš„å¤„ç†ã€‚ æ­å»ºæ­¥éª¤1.å¼€å¯æ’ä»¶(éœ€è¦çš„æœºå™¨éƒ½å¼€å¯) 12rabbitmq-plugins enable rabbitmq_shovelrabbitmq-plugins enable rabbitmq_shovel_management 2.åŸç†å›¾åœ¨æºå¤´å‘é€çš„æ¶ˆæ¯ç›´æ¥å›è¿›å…¥åˆ°ç›®çš„åœ°é˜Ÿåˆ— 3.æ·»åŠ  shovel æºå’Œç›®çš„åœ° RabbitMQå·¥å…·ç±»åœ¨ä¼ä¸šå¼€å‘è¿‡ç¨‹ä¸­ï¼Œç›´æ¥ä½¿ç”¨SpringBootæä¾›çš„RabbitTemplateè¿˜æ˜¯ç•¥æ˜¾å¤æ‚ï¼Œé€šå¸¸æˆ‘ä»¬ä¸€ä¸ªç³»ç»Ÿå‘é€æ¶ˆæ¯åŸºæœ¬ä¸Šä¹Ÿæ˜¯åªä¾èµ–äºä¸€ä¸ªäº¤æ¢æœºå’Œä¸€ä¸ªé˜Ÿåˆ—ï¼ˆå»¶è¿Ÿæ¶ˆæ¯éœ€å•ç‹¬ä¾èµ–äºå»¶è¿Ÿäº¤æ¢æœºï¼‰ï¼ŒåŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠäº¤æ¢æœºã€é˜Ÿåˆ—ä»¥åŠè·¯ç”±keyç­‰å£°æ˜ç›´æ¥æ”¾åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç„¶åå°è£…å‘é€æ™®é€šæ¶ˆæ¯çš„å·¥å…·ç±»ï¼Œå’Œå‘é€å»¶è¿Ÿæ¶ˆæ¯çš„å·¥å…·ç±»ï¼Œå‘é€çš„æ¶ˆæ¯ä½“å†…å®¹æˆ‘ä»¬å¯ä»¥å¢åŠ äº¤æ˜“ç è¿™ä¸ªæ¦‚å¿µï¼Œæ¶ˆè´¹è€…é€šè¿‡ä¸åŒäº¤æ˜“ç ï¼Œå¤„ç†ä¸åŒçš„ä¸šåŠ¡ã€‚æ¶ˆæ¯ä½“é€šè¿‡æ³›å‹ï¼Œåœ¨å‘æ¶ˆæ¯æ—¶å£°æ˜æ¶ˆæ¯ä½“ç±»å‹ï¼Œé€šè¿‡jsonåºåˆ—åŒ–ä¼ è¾“ã€‚ å·¥å…·ç±»ä½¿ç”¨å»¶è¿Ÿæ¶ˆæ¯å‘é€é¡¹ç›®å¯åŠ¨æ—¶ï¼Œç›´æ¥å£°æ˜å¥½å»¶è¿Ÿäº¤æ¢æœºï¼Œå»¶è¿Ÿé˜Ÿåˆ—ä»¥åŠè·¯ç”±keyï¼Œå‘é€å»¶è¿Ÿæ¶ˆæ¯åªéœ€è¦ä¸€å¥ä»£ç  12345public void sendDelayMsg(@PathVariable String message, @PathVariable Integer delayTime) &#123; log.info(&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡æ—¶é•¿&#123;&#125;æ¯«ç§’TTLä¿¡æ¯ç»™é˜Ÿåˆ—QC:&#123;&#125;&quot;, new Date(), delayTime, message); MsgData&lt;String&gt; msgData = new MsgData&lt;&gt;(&quot;0001&quot;, message, &quot;è¿™æ˜¯æˆ‘çš„æµ‹è¯•å»¶è¿Ÿæ¶ˆæ¯ï¼&quot;); EventDispatcherUtil.eventDispatch(msgData, delayTime);&#125; æ™®é€šæ¶ˆæ¯å‘é€æ™®é€šæ¶ˆæ¯é€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼å®ç°ï¼Œå…¶ä»–ç³»ç»Ÿè‹¥è¦æ¥æ”¶æ¬¡æ¶ˆæ¯ï¼Œåªéœ€è¦å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—ç„¶åæ·»åŠ ç›‘å¬ï¼Œç»‘å®šåˆ°æ­¤äº¤æ¢æœºä¸Šå³å¯ï¼Œå‘é€æ™®é€šæ¶ˆæ¯ä¹Ÿåªéœ€è¦ä¸€å¥ä»£ç å®ç° 12345public void sendFanoutMsg(@PathVariable String message) &#123; log.info(&quot;å½“å‰æ—¶é—´ï¼š&#123;&#125;,å‘é€ä¸€æ¡ä¿¡æ¯ç»™é˜Ÿåˆ—QC:&#123;&#125;&quot;, new Date(), message); MsgData&lt;String&gt; msgData = new MsgData&lt;&gt;(&quot;0001&quot;, message, &quot;è¿™æ˜¯æˆ‘çš„æµ‹è®¢é˜…æ¶ˆæ¯ï¼&quot;); EventDispatcherUtil.eventDispatch(msgData);&#125; RabbitMQç›¸å…³é¢è¯•é¢˜å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿ é˜Ÿåˆ—å’Œæ¶ˆæ¯æŒä¹…åŒ–ï¼šä¿è¯MQå®•æœºäº†æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Œå¿…é¡»ä¿è¯åœ¨ç£ç›˜ä¸Šæ‰èƒ½ï¼ˆ3.4.2ã€3.4.3ï¼‰ æ¶ˆæ¯å‘å¸ƒç¡®è®¤ï¼šå¼€å¯æ¶ˆæ¯å‘å¸ƒç¡®è®¤ï¼ŒMQå°†æ¶ˆæ¯å‘é€åˆ°äº¤æ¢æœºå¹¶ä¸”ä¿å­˜åœ¨ç£ç›˜ä¸Šä¹‹åè¿”å›ä¸€ä¸ªç¡®è®¤ï¼Œæ­¤æ—¶å¯ä»¥ä¿è¯ç”Ÿäº§è€…å‘é€çš„æ¶ˆæ¯ç»å¯¹ä¸ä¸¢å¤±ã€‚è§ï¼š9.1 æ¶ˆæ¯å›é€€å¤„ç†ï¼šå½“æ¶ˆæ¯åˆ°è¾¾äº¤æ¢æœºæ— æ³•è·¯ç”±åˆ°é˜Ÿåˆ—æ—¶ï¼Œäº¤æ¢æœºæŠŠæ¶ˆæ¯å›é€€ç»™ç”Ÿäº§è€…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¤‡ä»½äº¤æ¢æœºå®ç°ã€‚è§ï¼š9.2 æ¶ˆæ¯åº”ç­”æœºåˆ¶ï¼šè®¾ç½®ä¸ºæ‰‹åŠ¨åº”ç­”ï¼Œä¿è¯æ¶ˆè´¹è€…æ­£ç¡®å¤„ç†å®Œæ¶ˆæ¯ï¼Œå¦‚æœå¤„ç†å¤±è´¥ï¼Œæ¶ˆæ¯é‡æ–°å…¥é˜Ÿ é›†ç¾¤ç¯å¢ƒä¸‹ï¼Œæ·»åŠ é•œåƒé˜Ÿåˆ—ã€‚è§ï¼š11.2 æ¶ˆæ¯çš„ç±»å‹ä¸»è¦æ˜¯äº¤æ¢æœºçš„ç±»å‹ï¼ŒåŒ…æ‹¬ï¼š ç›´æ¥(direct)ï¼šè·¯ç”±ç±»å‹ ä¸»é¢˜(topic) æ ‡é¢˜(headers) ï¼šå·²ç»ä¸ç”¨äº† æ‰‡å‡º(fanout)ï¼šå‘å¸ƒè®¢é˜…ç±»å‹","categories":[{"name":"ä¸­é—´ä»¶","slug":"ä¸­é—´ä»¶","permalink":"https://zhangyong3214.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"}],"tags":[{"name":"åç«¯æŠ€æœ¯","slug":"åç«¯æŠ€æœ¯","permalink":"https://zhangyong3214.github.io/tags/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/"}]}],"categories":[{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zhangyong3214.github.io/categories/%E9%9D%A2%E8%AF%95/"},{"name":"æ•™ç¨‹","slug":"æ•™ç¨‹","permalink":"https://zhangyong3214.github.io/categories/%E6%95%99%E7%A8%8B/"},{"name":"ç¬”è®°","slug":"ç¬”è®°","permalink":"https://zhangyong3214.github.io/categories/%E7%AC%94%E8%AE%B0/"},{"name":"è½¯ä»¶åˆ†äº«","slug":"è½¯ä»¶åˆ†äº«","permalink":"https://zhangyong3214.github.io/categories/%E8%BD%AF%E4%BB%B6%E5%88%86%E4%BA%AB/"},{"name":"æ¡†æ¶","slug":"æ¡†æ¶","permalink":"https://zhangyong3214.github.io/categories/%E6%A1%86%E6%9E%B6/"},{"name":"ä¸­é—´ä»¶","slug":"ä¸­é—´ä»¶","permalink":"https://zhangyong3214.github.io/categories/%E4%B8%AD%E9%97%B4%E4%BB%B6/"}],"tags":[{"name":"åç«¯æŠ€æœ¯","slug":"åç«¯æŠ€æœ¯","permalink":"https://zhangyong3214.github.io/tags/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/"},{"name":"è½¯ä»¶å·¥å…·","slug":"è½¯ä»¶å·¥å…·","permalink":"https://zhangyong3214.github.io/tags/%E8%BD%AF%E4%BB%B6%E5%B7%A5%E5%85%B7/"},{"name":"é¢è¯•","slug":"é¢è¯•","permalink":"https://zhangyong3214.github.io/tags/%E9%9D%A2%E8%AF%95/"},{"name":"å¼€å‘","slug":"å¼€å‘","permalink":"https://zhangyong3214.github.io/tags/%E5%BC%80%E5%8F%91/"}]}